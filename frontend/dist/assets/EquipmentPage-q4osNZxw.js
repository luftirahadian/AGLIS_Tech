var ae=Object.defineProperty,le=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var L=(t,a,l)=>a in t?ae(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,u=(t,a)=>{for(var l in a||(a={}))re.call(a,l)&&L(t,l,a[l]);if(Q)for(var l of Q(a))ne.call(a,l)&&L(t,l,a[l]);return t},q=(t,a)=>le(t,ie(a));import{j as e}from"./notifications-C0yZ9C-Z.js";import{r as d}from"./react-vendor-BQ7pSkNi.js";import{u as z,a as ce,b as O}from"./react-query-B7OIdD7u.js";import{a as k,L as de,K as A}from"./customers-E1YlbjQu.js";import{u as oe}from"./forms-Dmkgx8TD.js";import{X as me,z as M,P as U,q as S,S as xe,a5 as ue,T as he,Q as pe,V as ge,W as be,Y as je,Z as ve}from"./ui-vendor-gTLpeMoy.js";import"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";const ye=({equipment:t,onClose:a,onSuccess:l})=>{const g=!!t,{register:n,handleSubmit:K,formState:{errors:h,isSubmitting:p},reset:C}=oe({defaultValues:t||{equipment_code:"",equipment_name:"",category:"",description:"",unit:"pcs",is_active:!0}});d.useEffect(()=>{t&&C(t)},[t,C]);const v=z(c=>g?k.update(t.id,c):k.create(c),{onSuccess:()=>{M.success(g?"Equipment berhasil diupdate":"Equipment berhasil ditambahkan"),l()},onError:c=>{var o,y;M.error(((y=(o=c.response)==null?void 0:o.data)==null?void 0:y.message)||"Terjadi kesalahan")}}),b=c=>{const o=q(u({},c),{is_active:c.is_active==="true"||c.is_active===!0});v.mutate(o)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:g?"Edit Equipment":"Tambah Equipment Baru"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(me,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:K(b),className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informasi Dasar"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kode Equipment ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",u({type:"text",className:"input-field",placeholder:"EQ-001"},n("equipment_code",{required:"Kode equipment wajib diisi",minLength:{value:3,message:"Kode minimal 3 karakter"}}))),h.equipment_code&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.equipment_code.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nama Equipment ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",u({type:"text",className:"input-field",placeholder:"Optical Fiber Cable"},n("equipment_name",{required:"Nama equipment wajib diisi"}))),h.equipment_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.equipment_name.message})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Detail Produk"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Kategori ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",q(u({className:"input-field"},n("category",{required:"Kategori wajib dipilih"})),{children:[e.jsx("option",{value:"",children:"Pilih Kategori"}),e.jsx("option",{value:"devices",children:"Devices"}),e.jsx("option",{value:"cables",children:"Cables"}),e.jsx("option",{value:"connectors",children:"Connectors"}),e.jsx("option",{value:"tools",children:"Tools"}),e.jsx("option",{value:"accessories",children:"Accessories"})]})),h.category&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:h.category.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unit"}),e.jsx("input",u({type:"text",className:"input-field",placeholder:"pcs, meter, roll"},n("unit")))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi"}),e.jsx("textarea",u({className:"input-field",rows:"2",placeholder:"Deskripsi singkat equipment"},n("description")))]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",q(u({type:"radio",value:"true"},n("is_active")),{className:"mr-2"})),"Active"]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",q(u({type:"radio",value:"false"},n("is_active")),{className:"mr-2"})),"Inactive"]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-secondary",disabled:p,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Menyimpan...":g?"Update Equipment":"Tambah Equipment"})]})]})]})})},Ae=()=>{const[t,a]=d.useState(""),[l,g]=d.useState("all"),[n,K]=d.useState("all"),[h,p]=d.useState(!1),[C,v]=d.useState(null),[b,c]=d.useState("equipment_name"),[o,y]=d.useState("asc"),[i,m]=d.useState(1),[f,B]=d.useState(10),E=ce(),{data:R,isLoading:W}=O(["equipment-list",l,n,t,b,o,i,f],()=>k.getAll({category:l!=="all"?l:void 0,status:n!=="all"?n:void 0,search:t||void 0,page:i,limit:f,sort_by:b,sort_order:o}),{refetchOnWindowFocus:!1,keepPreviousData:!0}),P=R||[],x={},{data:$}=O("all-equipment-stats",()=>k.getAll({page:1,limit:1e3}),{refetchOnWindowFocus:!1}),_=$||[],V=_.length,G=_.filter(s=>s.is_active).length,X=_.filter(s=>!s.is_active).length,T=[...new Set(_.map(s=>s.category).filter(Boolean))],Y=T.length,Z=z(s=>k.delete(s),{onSuccess:()=>{M.success("Equipment berhasil dihapus"),E.invalidateQueries(["equipment-list"]),E.invalidateQueries("all-equipment-stats")},onError:s=>{var r,j;M.error(((j=(r=s.response)==null?void 0:r.data)==null?void 0:j.message)||"Gagal menghapus equipment")}}),D=()=>{v(null),p(!0)},H=s=>{v(s),p(!0)},J=(s,r)=>{window.confirm(`Apakah Anda yakin ingin menghapus equipment "${r}"?`)&&Z.mutate(s)},I=()=>{p(!1),v(null)},ee=()=>{E.invalidateQueries(["equipment-list"]),E.invalidateQueries("all-equipment-stats"),I()},N=s=>{b===s?y(o==="asc"?"desc":"asc"):(c(s),y("asc")),m(1)},w=s=>b!==s?e.jsx(be,{className:"h-4 w-4 text-gray-400"}):o==="asc"?e.jsx(je,{className:"h-4 w-4"}):e.jsx(ve,{className:"h-4 w-4"}),se=s=>{a(s.target.value),m(1)},F=(s,r)=>{s==="category"?g(r):s==="status"&&K(r),m(1)},te=s=>({devices:"bg-blue-100 text-blue-800",cables:"bg-green-100 text-green-800",accessories:"bg-yellow-100 text-yellow-800",tools:"bg-purple-100 text-purple-800"})[s]||"bg-gray-100 text-gray-800";return W&&i===1?e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(de,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Equipment Management"}),e.jsx("p",{className:"text-gray-600",children:"Kelola data Equipment"})]}),e.jsxs("button",{onClick:D,className:"btn-primary",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Tambah Equipment"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(A,{icon:S,title:"Total Equipment",value:V,color:"blue"}),e.jsx(A,{icon:S,title:"Active",value:G,color:"green"}),e.jsx(A,{icon:S,title:"Inactive",value:X,color:"red"}),e.jsx(A,{icon:S,title:"Categories",value:Y,color:"purple"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari equipment...",value:t,onChange:se})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategori"}),e.jsxs("select",{className:"form-input",value:l,onChange:s=>F("category",s.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kategori"}),T.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"form-input",value:n,onChange:s=>F("status",s.target.value),children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Type"}),e.jsx("select",{className:"form-input",value:"all",onChange:s=>{},children:e.jsx("option",{value:"all",children:"Semua Unit"})})]})]})}),P.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(S,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada equipment"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Mulai dengan menambahkan equipment pertama"}),e.jsxs("button",{onClick:D,className:"btn-primary",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Tambah Equipment"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Equipment",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",x.total||0," total)"]})]})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",style:{tableLayout:"fixed",minWidth:"900px"},children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>N("equipment_code"),style:{width:"140px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Kode"}),w("equipment_code")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>N("equipment_name"),style:{width:"280px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Nama Equipment"}),w("equipment_name")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>N("category"),style:{width:"130px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Kategori"}),w("category")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>N("unit"),style:{width:"80px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Unit"}),w("unit")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>N("is_active"),style:{width:"100px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Status"}),w("is_active")]})}),e.jsx("th",{className:"table-header-cell text-center",style:{width:"100px"},children:"Actions"})]})}),e.jsx("tbody",{className:"table-body",children:P.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm font-mono text-gray-900 truncate",children:s.equipment_code})}),e.jsxs("td",{className:"table-cell",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:s.equipment_name}),s.description&&e.jsx("div",{className:"text-xs text-gray-500 truncate",title:s.description,children:s.description})]}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${te(s.category)}`,children:s.category||"-"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.unit||"pcs"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"table-cell text-center",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>H(s),className:"inline-flex items-center justify-center w-8 h-8 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"Edit Equipment",children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>J(s.id,s.equipment_name),className:"inline-flex items-center justify-center w-8 h-8 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete Equipment",children:e.jsx(he,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>m(Math.max(1,i-1)),disabled:i===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>m(Math.min(x.pages||1,i+1)),disabled:i===(x.pages||1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show"}),e.jsxs("select",{value:f,onChange:s=>{B(parseInt(s.target.value)),m(1)},className:"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"rows"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(i-1)*f+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(i*f,x.total||0)})," ","of ",e.jsx("span",{className:"font-medium",children:x.total||0})," results"]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>m(Math.max(1,i-1)),disabled:i===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(pe,{className:"h-5 w-5"})}),Array.from({length:Math.min(x.pages||1,10)},(s,r)=>{const j=x.pages||1;return j<=10||i<=5?r+1:i>=j-4?j-9+r:i-5+r}).map(s=>e.jsx("button",{onClick:()=>m(s),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${i===s?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:s},s)),e.jsx("button",{onClick:()=>m(Math.min(x.pages||1,i+1)),disabled:i===(x.pages||1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ge,{className:"h-5 w-5"})})]})})]})]})})]}),h&&e.jsx(ye,{equipment:C,onClose:I,onSuccess:ee})]})};export{Ae as default};
//# sourceMappingURL=EquipmentPage-q4osNZxw.js.map
