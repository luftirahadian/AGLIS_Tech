import{j as e,a as c}from"./notifications-CL6phtOA.js";import{r as w}from"./react-vendor-BQ7pSkNi.js";import{b as x}from"./react-query-B7OIdD7u.js";import{K as C,C as _,e as R,N as A,aT as F,aU as $}from"./ui-vendor-ng1X_mIA.js";import{R as g,P as B,d as P,e as k,T as u,B as I,C as v,X as N,Y as f,c as D,L as K,a as S,b as j}from"./charts-CREYXqqm.js";const m=({icon:i,title:p,value:a,subtitle:o,trend:r,color:l="blue"})=>{const s={blue:"bg-blue-500 text-blue-600 bg-blue-50",green:"bg-green-500 text-green-600 bg-green-50",yellow:"bg-yellow-500 text-yellow-600 bg-yellow-50",red:"bg-red-500 text-red-600 bg-red-50",purple:"bg-purple-500 text-purple-600 bg-purple-50",indigo:"bg-indigo-500 text-indigo-600 bg-indigo-50"},[h,y,d]=(s[l]||s.blue).split(" ");return e.jsx("div",{className:`${d} rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:p}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mb-2",children:a}),o&&e.jsx("p",{className:"text-sm text-gray-600",children:o}),r&&e.jsxs("div",{className:`flex items-center mt-2 text-sm ${r>0?"text-green-600":"text-red-600"}`,children:[r>0?e.jsx(F,{className:"h-4 w-4 mr-1"}):e.jsx($,{className:"h-4 w-4 mr-1"}),e.jsxs("span",{children:[Math.abs(r),"% vs last period"]})]})]}),e.jsx("div",{className:`${h} p-3 rounded-lg`,children:e.jsx(i,{className:"h-6 w-6 text-white"})})]})})},W=()=>{const[i,p]=w.useState(30),{data:a}=x(["registration-analytics-overview",i],()=>c.get(`/registration-analytics/overview?timeframe=${i}`),{select:t=>t.data}),{data:o}=x(["registration-trends",i],()=>c.get(`/registration-analytics/trends?days=${i}`),{select:t=>t.data}),{data:r}=x("registration-package-popularity",()=>c.get("/registration-analytics/package-popularity"),{select:t=>t.data}),{data:l}=x("registration-funnel",()=>c.get("/registration-analytics/funnel"),{select:t=>t.data}),s=(a==null?void 0:a.funnel)||{},h=(a==null?void 0:a.time_metrics)||{},y=(l==null?void 0:l.map(t=>({stage:t.stage,count:parseInt(t.count),percentage:parseFloat(t.percentage)||0})))||[],d=[{name:"Pending",value:parseInt(s.pending)||0,color:"#EAB308"},{name:"Verified",value:parseInt(s.verified)||0,color:"#3B82F6"},{name:"Survey Scheduled",value:parseInt(s.survey_scheduled)||0,color:"#6366F1"},{name:"Survey Done",value:parseInt(s.survey_completed)||0,color:"#8B5CF6"},{name:"Approved",value:parseInt(s.approved)||0,color:"#10B981"},{name:"Rejected",value:parseInt(s.rejected)||0,color:"#EF4444"}].filter(t=>t.value>0);return e.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Registration Analytics"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Analisis pendaftaran customer baru"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Periode:"}),[7,30,60,90].map(t=>e.jsxs("button",{onClick:()=>p(t),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${i===t?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[t," Hari"]},t))]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx(m,{icon:C,title:"Total Registrations",value:s.total_registrations||0,color:"blue"}),e.jsx(m,{icon:_,title:"Approved",value:s.approved||0,subtitle:`${s.approval_rate||0}% approval rate`,color:"green"}),e.jsx(m,{icon:R,title:"Conversion Rate",value:`${s.conversion_rate||0}%`,subtitle:`${s.converted_to_customer||0} customers`,color:"purple"}),e.jsx(m,{icon:A,title:"Avg Approval Time",value:`${h.avg_approval_time_hours||0}h`,subtitle:"From registration",color:"indigo"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status Distribution"}),e.jsx(g,{width:"100%",height:300,children:e.jsxs(B,{children:[e.jsx(P,{data:d,cx:"50%",cy:"50%",labelLine:!1,label:({name:t,percent:n})=>`${t}: ${(n*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:d.map((t,n)=>e.jsx(k,{fill:t.color},`cell-${n}`))}),e.jsx(u,{})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Conversion Funnel"}),e.jsx(g,{width:"100%",height:300,children:e.jsxs(I,{data:y,children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(N,{dataKey:"stage",angle:-45,textAnchor:"end",height:100}),e.jsx(f,{}),e.jsx(u,{}),e.jsx(D,{dataKey:"count",fill:"#3B82F6"})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Registration Trends"}),e.jsx(g,{width:"100%",height:300,children:e.jsxs(K,{data:o||[],children:[e.jsx(v,{strokeDasharray:"3 3"}),e.jsx(N,{dataKey:"date",tickFormatter:t=>new Date(t).toLocaleDateString("id-ID",{day:"2-digit",month:"short"})}),e.jsx(f,{}),e.jsx(u,{labelFormatter:t=>new Date(t).toLocaleDateString("id-ID")}),e.jsx(S,{}),e.jsx(j,{type:"monotone",dataKey:"total",stroke:"#3B82F6",strokeWidth:2,name:"Total"}),e.jsx(j,{type:"monotone",dataKey:"approved",stroke:"#10B981",strokeWidth:2,name:"Approved"}),e.jsx(j,{type:"monotone",dataKey:"rejected",stroke:"#EF4444",strokeWidth:2,name:"Rejected"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Package Popularity"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Package"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Speed"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Price"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Registrations"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Approved"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Rate"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r==null?void 0:r.map((t,n)=>{var b;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.package_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[t.bandwidth_down," Mbps"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:["Rp ",(b=t.monthly_price)==null?void 0:b.toLocaleString("id-ID")]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm font-semibold text-blue-600",children:t.registration_count||0})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm font-semibold text-green-600",children:t.approved_count||0})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[t.approval_rate||0,"%"]})})]},n)})})]})})]})]})})};export{W as default};
//# sourceMappingURL=RegistrationAnalyticsPage-CmCEeGp9.js.map
