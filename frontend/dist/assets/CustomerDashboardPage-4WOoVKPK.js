var o=(r,x,l)=>new Promise((m,c)=>{var h=a=>{try{n(l.next(a))}catch(t){c(t)}},i=a=>{try{n(l.throw(a))}catch(t){c(t)}},n=a=>a.done?m(a.value):Promise.resolve(a.value).then(h,i);n((l=l.apply(r,x)).next())});import{j as e,a as p}from"./notifications-ZCsIKyPs.js";import{u as T}from"./react-vendor-BQ7pSkNi.js";import{b as u}from"./react-query-B7OIdD7u.js";import{al as I,av as _,N as w,C as S,F as k,$ as D,U as j,p as P,m as $,q as A,r as B,af as L,g as z,z as M}from"./ui-vendor-DY8BSMik.js";import"./charts-CREYXqqm.js";const W=()=>{var b,N,y,f,v;const r=T(),x=JSON.parse(localStorage.getItem("customerData")||"{}"),{data:l,isLoading:m}=u("customer-dashboard-stats",()=>o(void 0,null,function*(){const s=localStorage.getItem("customerToken");return(yield p.get("/customer-portal/dashboard/stats",{headers:{Authorization:`Bearer ${s}`}})).data}),{refetchInterval:3e4}),{data:c,isLoading:h}=u("customer-profile",()=>o(void 0,null,function*(){const s=localStorage.getItem("customerToken");return(yield p.get("/customer-portal/profile",{headers:{Authorization:`Bearer ${s}`}})).data})),{data:i,isLoading:n}=u("customer-recent-tickets",()=>o(void 0,null,function*(){const s=localStorage.getItem("customerToken");return(yield p.get("/customer-portal/tickets?limit=5",{headers:{Authorization:`Bearer ${s}`}})).data})),a=(l==null?void 0:l.data)||{},t=(c==null?void 0:c.data)||{},g=((b=i==null?void 0:i.data)==null?void 0:b.tickets)||[],C=()=>{localStorage.removeItem("customerToken"),localStorage.removeItem("customerData"),M.success("Logout berhasil"),r("/customer/login")};return m||h?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-green-600 rounded-lg flex items-center justify-center",children:e.jsx(I,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Customer Portal"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome, ",x.name||t.name,"!"]})]})]}),e.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-4 py-2 text-gray-700 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("span",{children:"Logout"})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tiket Aktif"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:((N=a.tickets)==null?void 0:N.active_tickets)||0})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(w,{className:"h-8 w-8 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tiket Selesai"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:((y=a.tickets)==null?void 0:y.completed_tickets)||0})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(S,{className:"h-8 w-8 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Invoice Pending"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:((f=a.invoices)==null?void 0:f.pending_invoices)||0})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-lg",children:e.jsx(k,{className:"h-8 w-8 text-yellow-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Tagihan"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["Rp ",(((v=a.invoices)==null?void 0:v.outstanding_amount)||0).toLocaleString("id-ID")]})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(D,{className:"h-8 w-8 text-red-600"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(j,{className:"h-5 w-5 mr-2 text-blue-600"}),"Informasi Pelanggan"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Customer ID"}),e.jsx("p",{className:"font-semibold text-gray-900",children:t.customer_id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nama"}),e.jsx("p",{className:"font-semibold text-gray-900",children:t.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"WhatsApp"}),e.jsxs("p",{className:"font-semibold text-gray-900 flex items-center",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),t.phone]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsxs("p",{className:"font-semibold text-gray-900 flex items-center",children:[e.jsx($,{className:"h-4 w-4 mr-1"}),t.email||"-"]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Alamat"}),e.jsxs("p",{className:"font-semibold text-gray-900 flex items-start",children:[e.jsx(A,{className:"h-4 w-4 mr-1 mt-1"}),e.jsx("span",{children:t.address})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Paket"}),e.jsxs("p",{className:"font-semibold text-gray-900 flex items-center",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),t.package_name||"-"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Bandwidth"}),e.jsx("p",{className:"font-semibold text-gray-900",children:t.bandwidth_down?`${t.bandwidth_down} Mbps`:"-"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>r("/customer/tickets/new"),className:"w-full flex items-center space-x-3 px-4 py-3 bg-blue-50 text-blue-700 rounded-lg hover:bg-blue-100 transition-colors",children:[e.jsx(L,{className:"h-5 w-5"}),e.jsx("span",{children:"Buat Tiket Baru"})]}),e.jsxs("button",{onClick:()=>r("/customer/invoices"),className:"w-full flex items-center space-x-3 px-4 py-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(k,{className:"h-5 w-5"}),e.jsx("span",{children:"Lihat Invoice"})]}),e.jsxs("button",{onClick:()=>r("/customer/tickets"),className:"w-full flex items-center space-x-3 px-4 py-3 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsx("span",{children:"Track Tiket"})]}),e.jsxs("button",{onClick:()=>r("/customer/profile"),className:"w-full flex items-center space-x-3 px-4 py-3 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Update Profil"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(L,{className:"h-5 w-5 mr-2 text-blue-600"}),"Tiket Terbaru"]}),n?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Loading..."}):g.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Belum ada tiket"}):e.jsx("div",{className:"space-y-3",children:g.map(s=>{var d;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-900",children:["#",s.ticket_number]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.status==="completed"?"bg-green-100 text-green-700":s.status==="in_progress"?"bg-blue-100 text-blue-700":s.status==="cancelled"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:s.status}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.priority==="high"?"bg-red-100 text-red-700":s.priority==="normal"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.priority})]}),e.jsx("p",{className:"text-sm text-gray-900 font-medium mb-1",children:s.title}),e.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[(d=s.description)==null?void 0:d.substring(0,100),"..."]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(z,{className:"h-3 w-3 mr-1"}),new Date(s.created_at).toLocaleDateString("id-ID")]}),s.technician_name&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),s.technician_name]})]})]}),e.jsx("button",{onClick:()=>r(`/customer/tickets/${s.id}`),className:"ml-4 px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:"Detail"})]})},s.id)})}),g.length>0&&e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:()=>r("/customer/tickets"),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Lihat Semua Tiket â†’"})})]})]})]})};export{W as default};
//# sourceMappingURL=CustomerDashboardPage-4WOoVKPK.js.map
