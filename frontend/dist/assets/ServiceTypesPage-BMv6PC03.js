var J=Object.defineProperty,R=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var L=(a,l,i)=>l in a?J(a,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[l]=i,h=(a,l)=>{for(var i in l||(l={}))se.call(l,i)&&L(a,i,l[i]);if(E)for(var i of E(l))ae.call(l,i)&&L(a,i,l[i]);return a},z=(a,l)=>R(a,ee(l));import{j as e}from"./notifications-C-A1jlty.js";import{r as o}from"./react-vendor-BQ7pSkNi.js";import{u as F,a as te,b as Q}from"./react-query-B7OIdD7u.js";import{c as k,L as le,K as T}from"./customers-Bkp7alR1.js";import{u as ie}from"./forms-Dmkgx8TD.js";import{X as re,z as A,P as q,t as M,a as ne,S as ce,a6 as de,T as oe,V as me,W as xe,Y as he,Z as ue,_ as pe}from"./ui-vendor-ng1X_mIA.js";import"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";const be=({serviceType:a,onClose:l,onSuccess:i})=>{const u=!!a,{register:c,handleSubmit:f,formState:{errors:m,isSubmitting:p},reset:t}=ie({defaultValues:a||{type_code:"",type_name:"",description:"",icon:"",default_duration:120,is_active:!0,display_order:0}});o.useEffect(()=>{a&&t(a)},[a,t]);const r=F(x=>u?k.update(a.id,x):k.create(x),{onSuccess:()=>{A.success(u?"Service type berhasil diupdate":"Service type berhasil ditambahkan"),i()},onError:x=>{var b,N;A.error(((N=(b=x.response)==null?void 0:b.data)==null?void 0:N.message)||"Terjadi kesalahan")}}),j=x=>{r.mutate(x)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:u?"Edit Service Type":"Tambah Service Type Baru"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(re,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:f(j),className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Informasi Dasar"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",z(h({type:"text",className:"input-field",placeholder:"e.g., installation, repair"},c("type_code",{required:"Type code wajib diisi",pattern:{value:/^[a-z_]+$/,message:"Gunakan lowercase dan underscore"}})),{disabled:u})),m.type_code&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.type_code.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",h({type:"text",className:"input-field",placeholder:"e.g., Installation, Repair"},c("type_name",{required:"Type name wajib diisi",minLength:{value:3,message:"Minimal 3 karakter"}}))),m.type_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.type_name.message})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx("textarea",h({className:"input-field",rows:"3",placeholder:"Deskripsi service type"},c("description")))]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-4",children:"Konfigurasi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Icon"}),e.jsx("input",h({type:"text",className:"input-field",placeholder:"e.g., wrench, tool"},c("icon"))),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Lucide icon name"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Default Duration (minutes) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",h({type:"number",className:"input-field",min:"1"},c("default_duration",{required:"Duration wajib diisi",min:{value:1,message:"Minimal 1 menit"},valueAsNumber:!0}))),m.default_duration&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:m.default_duration.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",h({type:"number",className:"input-field",min:"0"},c("display_order",{min:{value:0,message:"Minimal 0"},valueAsNumber:!0})))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",h({type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},c("is_active"))),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Service type aktif dan dapat digunakan"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:l,className:"btn-secondary",disabled:p,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:p,children:p?"Menyimpan...":u?"Update Service Type":"Tambah Service Type"})]})]})]})})},ke=()=>{const[a,l]=o.useState(""),[i,u]=o.useState("all"),[c,f]=o.useState(!1),[m,p]=o.useState(null),[t,r]=o.useState(1),[j,x]=o.useState("display_order"),[b,N]=o.useState("asc"),[w,B]=o.useState(10),C=te(),{data:g,isLoading:K}=Q(["service-types",t,w,j,b,a,i],()=>k.getAll({page:t,limit:w,sort_by:j,sort_order:b,search:a||void 0,active_only:i==="active"?"true":i==="inactive"?"false":void 0}),{refetchOnWindowFocus:!1,keepPreviousData:!0}),I=(g==null?void 0:g.data)||[],d=(g==null?void 0:g.pagination)||{},{data:D}=Q("all-service-types-stats",()=>k.getAll({page:1,limit:1e3}),{refetchOnWindowFocus:!1}),y=(D==null?void 0:D.data)||[],$=y.length,U=y.filter(s=>s.is_active).length,W=y.filter(s=>!s.is_active).length,G=F(s=>k.delete(s),{onSuccess:()=>{A.success("Service type berhasil dihapus"),C.invalidateQueries("service-types"),C.invalidateQueries("all-service-types-stats")},onError:s=>{var n,v;A.error(((v=(n=s.response)==null?void 0:n.data)==null?void 0:v.message)||"Gagal menghapus service type")}}),O=()=>{p(null),f(!0)},V=s=>{p(s),f(!0)},X=(s,n)=>{window.confirm(`Apakah Anda yakin ingin menghapus service type "${n}"?`)&&G.mutate(s)},P=()=>{f(!1),p(null)},Y=()=>{C.invalidateQueries("service-types"),C.invalidateQueries("all-service-types-stats"),P()},S=s=>{j===s?N(b==="asc"?"desc":"asc"):(x(s),N("asc")),r(1)},_=s=>j!==s?e.jsx(he,{className:"h-4 w-4"}):b==="asc"?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(pe,{className:"h-4 w-4"}),Z=s=>{l(s.target.value),r(1)},H=s=>{u(s),r(1)};return K&&t===1?e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(le,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Service Types Management"}),e.jsx("p",{className:"text-gray-600",children:"Kelola jenis layanan yang tersedia"})]}),e.jsxs("button",{onClick:O,className:"btn-primary",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Tambah Service Type"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(T,{icon:M,title:"Total Types",value:$,color:"blue"}),e.jsx(T,{icon:M,title:"Active",value:U,color:"green"}),e.jsx(T,{icon:ne,title:"Inactive",value:W,color:"red"}),e.jsx(T,{icon:M,title:"Avg Duration",value:y.length>0?Math.round(y.reduce((s,n)=>s+n.default_duration,0)/y.length):0,color:"purple",suffix:" min"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari service type...",value:a,onChange:Z})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"form-input",value:i,onChange:s=>H(s.target.value),children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),e.jsx("select",{className:"form-input",value:"all",onChange:s=>{},children:e.jsx("option",{value:"all",children:"Semua Duration"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Display Order"}),e.jsx("select",{className:"form-input",value:"all",onChange:s=>{},children:e.jsx("option",{value:"all",children:"Semua Order"})})]})]})}),I.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(M,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada service type"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Mulai dengan menambahkan service type pertama"}),e.jsxs("button",{onClick:O,className:"btn-primary",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Tambah Service Type"]})]}):e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Service Types",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",d.total||0," total)"]})]})}),e.jsxs("div",{className:"card-body p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("display_order"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Order"}),_("display_order")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("type_code"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Type Code"}),_("type_code")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("type_name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Type Name"}),_("type_name")]})}),e.jsx("th",{className:"table-header-cell",children:"Description"}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("default_duration"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Duration"}),_("default_duration")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("is_active"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Status"}),_("is_active")]})}),e.jsx("th",{className:"table-header-cell text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"table-body",children:I.map(s=>e.jsxs("tr",{children:[e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.display_order})}),e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm font-mono text-gray-900",children:s.type_code})}),e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.type_name})}),e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm text-gray-900",children:s.description||"-"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[s.default_duration," min"]})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"table-cell text-center",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>V(s),className:"inline-flex items-center justify-center w-8 h-8 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"Edit Service Type",children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>X(s.id,s.type_name),className:"inline-flex items-center justify-center w-8 h-8 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete Service Type",children:e.jsx(oe,{className:"h-4 w-4"})})]})})]},s.id))})]})}),e.jsxs("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>r(Math.max(1,t-1)),disabled:t===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>r(Math.min(d.pages||1,t+1)),disabled:t===(d.pages||1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show"}),e.jsxs("select",{value:w,onChange:s=>{B(parseInt(s.target.value)),r(1)},className:"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"rows"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(t-1)*w+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(t*w,d.total||0)})," ","of ",e.jsx("span",{className:"font-medium",children:d.total||0})," results"]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>r(Math.max(1,t-1)),disabled:t===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(me,{className:"h-5 w-5"})}),Array.from({length:Math.min(d.pages||1,10)},(s,n)=>{const v=d.pages||1;return v<=10||t<=5?n+1:t>=v-4?v-9+n:t-5+n}).map(s=>e.jsx("button",{onClick:()=>r(s),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${t===s?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:s},s)),e.jsx("button",{onClick:()=>r(Math.min(d.pages||1,t+1)),disabled:t===(d.pages||1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(xe,{className:"h-5 w-5"})})]})})]})]})]})]}),c&&e.jsx(be,{serviceType:m,onClose:P,onSuccess:Y})]})};export{ke as default};
//# sourceMappingURL=ServiceTypesPage-BMv6PC03.js.map
