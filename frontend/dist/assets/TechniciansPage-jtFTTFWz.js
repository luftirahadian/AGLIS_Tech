var ne=Object.defineProperty,oe=Object.defineProperties;var ce=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var K=(x,n,s)=>n in x?ne(x,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):x[n]=s,f=(x,n)=>{for(var s in n||(n={}))de.call(n,s)&&K(x,s,n[s]);if(Q)for(var s of Q(n))me.call(n,s)&&K(x,s,n[s]);return x},y=(x,n)=>oe(x,ce(n));var V=(x,n,s)=>new Promise((w,r)=>{var u=d=>{try{g(s.next(d))}catch(j){r(j)}},l=d=>{try{g(s.throw(d))}catch(j){r(j)}},g=d=>d.done?w(d.value):Promise.resolve(d.value).then(u,l);g((s=s.apply(x,n)).next())});import{j as e}from"./notifications-C0yZ9C-Z.js";import{r as h,u as ue}from"./react-vendor-BQ7pSkNi.js";import{a as xe,b as R,u as he}from"./react-query-B7OIdD7u.js";import{t as F}from"./tickets-CA9deb-l.js";import{L as be,K as J}from"./customers-E1YlbjQu.js";import{X as pe,U as se,g as ge,ad as ae,p as le,a as C,t as fe,z as T,P as H,J as X,C as G,K as Y,b as ee,S as ye,o as je,m as ve,a7 as Ne,E as _e,T as we,Q as ke,V as Se,W as Ce,Y as Te,Z as ze,ak as Ee}from"./ui-vendor-gTLpeMoy.js";import"./charts-CREYXqqm.js";import"./forms-Dmkgx8TD.js";import"./socket-BFcXWKeu.js";const Ae=({isOpen:x,onClose:n,technician:s=null,onSuccess:w,mode:r="create"})=>{const u=r==="view",[l,g]=h.useState({employee_id:"",full_name:"",phone:"",phone_alt:"",email:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",hire_date:new Date().toISOString().split("T")[0],employment_status:"active",position:"technician",department:"field_operations",supervisor_id:"",skill_level:"junior",specializations:[],certifications:[],work_zone:"",max_daily_tickets:8,preferred_shift:"day",current_latitude:"",current_longitude:"",is_available:!0,availability_status:"available"}),[d,j]=h.useState("basic"),[P,k]=h.useState(!1),[m,S]=h.useState({}),L=["fiber_optic","wireless","networking","installation","troubleshooting","enterprise","residential","maintenance"],O=["Jakarta Pusat","Jakarta Selatan","Jakarta Utara","Jakarta Timur","Jakarta Barat","Bogor","Depok","Tangerang","Bekasi"];h.useEffect(()=>{s&&g({employee_id:s.employee_id||"",full_name:s.full_name||"",phone:s.phone||"",phone_alt:s.phone_alt||"",email:s.email||"",address:s.address||"",emergency_contact_name:s.emergency_contact_name||"",emergency_contact_phone:s.emergency_contact_phone||"",hire_date:s.hire_date?s.hire_date.split("T")[0]:new Date().toISOString().split("T")[0],employment_status:s.employment_status||"active",position:s.position||"technician",department:s.department||"field_operations",supervisor_id:s.supervisor_id||"",skill_level:s.skill_level||"junior",specializations:s.specializations||[],certifications:s.certifications||[],work_zone:s.work_zone||"",max_daily_tickets:s.max_daily_tickets||8,preferred_shift:s.preferred_shift||"day",current_latitude:s.current_latitude||"",current_longitude:s.current_longitude||"",is_available:s.is_available!==void 0?s.is_available:!0,availability_status:s.availability_status||"available"})},[s]);const i=t=>{const{name:o,value:N,type:_,checked:M}=t.target;g(A=>y(f({},A),{[o]:_==="checkbox"?M:N})),m[o]&&S(A=>y(f({},A),{[o]:""}))},I=t=>{g(o=>y(f({},o),{specializations:o.specializations.includes(t)?o.specializations.filter(N=>N!==t):[...o.specializations,t]}))},v=()=>{const t={};return l.employee_id.trim()||(t.employee_id="Employee ID is required"),l.full_name.trim()||(t.full_name="Full name is required"),l.phone.trim()||(t.phone="Phone number is required"),l.email.trim()||(t.email="Email is required"),l.work_zone||(t.work_zone="Work zone is required"),l.email&&!/\S+@\S+\.\S+/.test(l.email)&&(t.email="Please enter a valid email address"),l.phone&&!/^[0-9+\-\s()]+$/.test(l.phone)&&(t.phone="Please enter a valid phone number"),S(t),Object.keys(t).length===0},B=t=>V(void 0,null,function*(){var o,N;if(t.preventDefault(),!v()){T.error("Please fix the validation errors");return}k(!0);try{const _=y(f({},l),{max_daily_tickets:parseInt(l.max_daily_tickets),current_latitude:l.current_latitude?parseFloat(l.current_latitude):null,current_longitude:l.current_longitude?parseFloat(l.current_longitude):null,supervisor_id:l.supervisor_id||null,user_id:(s==null?void 0:s.user_id)||1});s?(yield F.updateTechnician(s.id,_),T.success("Technician updated successfully!")):(yield F.createTechnician(_),T.success("Technician created successfully!")),w(),n()}catch(_){console.error("Submit error:",_),T.error(((N=(o=_.response)==null?void 0:o.data)==null?void 0:N.message)||"Failed to save technician")}finally{k(!1)}}),z=()=>{g({employee_id:"",full_name:"",phone:"",phone_alt:"",email:"",address:"",emergency_contact_name:"",emergency_contact_phone:"",hire_date:new Date().toISOString().split("T")[0],employment_status:"active",position:"technician",department:"field_operations",supervisor_id:"",skill_level:"junior",specializations:[],certifications:[],work_zone:"",max_daily_tickets:8,preferred_shift:"day",current_latitude:"",current_longitude:"",is_available:!0,availability_status:"available"}),S({}),j("basic"),n()};if(!x)return null;const E=[{id:"basic",label:"Basic Info",icon:se},{id:"employment",label:"Employment",icon:ge},{id:"skills",label:"Skills & Zone",icon:ae},{id:"location",label:"Location",icon:le}];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r==="view"?"View Technician Details":r==="edit"?"Edit Technician":"Add New Technician"}),e.jsx("button",{onClick:z,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(pe,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-8 px-6",children:E.map(t=>{const o=t.icon;return e.jsxs("button",{onClick:()=>j(t.id),className:`py-4 px-1 border-b-2 font-medium text-sm transition-colors ${d===t.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(o,{className:"h-4 w-4 inline mr-2"}),t.label]},t.id)})})}),e.jsxs("form",{onSubmit:B,className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[d==="basic"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee ID *"}),e.jsx("input",{type:"text",name:"employee_id",value:l.employee_id,onChange:i,readOnly:r==="view",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${m.employee_id?"border-red-300":"border-gray-300"} ${r==="view"?"bg-gray-50 text-gray-600":""}`,placeholder:"TECH001"}),m.employee_id&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),m.employee_id]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",name:"full_name",value:l.full_name,onChange:i,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${m.full_name?"border-red-300":"border-gray-300"}`,placeholder:"John Doe"}),m.full_name&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),m.full_name]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),e.jsx("input",{type:"tel",name:"phone",value:l.phone,onChange:i,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${m.phone?"border-red-300":"border-gray-300"}`,placeholder:"081234567890"}),m.phone&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),m.phone]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alternative Phone"}),e.jsx("input",{type:"tel",name:"phone_alt",value:l.phone_alt,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"082345678901"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:i,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${m.email?"border-red-300":"border-gray-300"}`,placeholder:"john.doe@company.com"}),m.email&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),m.email]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{name:"address",value:l.address,onChange:i,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Full address..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Contact Name"}),e.jsx("input",{type:"text",name:"emergency_contact_name",value:l.emergency_contact_name,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Jane Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emergency Contact Phone"}),e.jsx("input",{type:"tel",name:"emergency_contact_phone",value:l.emergency_contact_phone,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"081234567890"})]})]})]}),d==="employment"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date"}),e.jsx("input",{type:"date",name:"hire_date",value:l.hire_date,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employment Status"}),e.jsxs("select",{name:"employment_status",value:l.employment_status,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"terminated",children:"Terminated"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position"}),e.jsx("input",{type:"text",name:"position",value:l.position,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Technician"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department"}),e.jsx("input",{type:"text",name:"department",value:l.department,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Field Operations"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Shift"}),e.jsxs("select",{name:"preferred_shift",value:l.preferred_shift,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"day",children:"Day Shift"}),e.jsx("option",{value:"night",children:"Night Shift"}),e.jsx("option",{value:"flexible",children:"Flexible"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Daily Tickets"}),e.jsx("input",{type:"number",name:"max_daily_tickets",value:l.max_daily_tickets,onChange:i,min:"1",max:"20",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]})}),d==="skills"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skill Level"}),e.jsxs("select",{name:"skill_level",value:l.skill_level,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"junior",children:"Junior"}),e.jsx("option",{value:"senior",children:"Senior"}),e.jsx("option",{value:"expert",children:"Expert"}),e.jsx("option",{value:"specialist",children:"Specialist"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Zone *"}),e.jsxs("select",{name:"work_zone",value:l.work_zone,onChange:i,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${m.work_zone?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Select Work Zone"}),O.map(t=>e.jsx("option",{value:t,children:t},t))]}),m.work_zone&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),m.work_zone]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specializations"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:L.map(t=>e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:l.specializations.includes(t),onChange:()=>I(t),className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 capitalize",children:t.replace("_"," ")})]},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Availability Status"}),e.jsxs("select",{name:"availability_status",value:l.availability_status,onChange:i,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"busy",children:"Busy"}),e.jsx("option",{value:"break",children:"On Break"}),e.jsx("option",{value:"offline",children:"Offline"})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_available",checked:l.is_available,onChange:i,className:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Available for assignments"})]})})]})]}),d==="location"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Latitude"}),e.jsx("input",{type:"number",name:"current_latitude",value:l.current_latitude,onChange:i,step:"any",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"-6.2088"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Longitude"}),e.jsx("input",{type:"number",name:"current_longitude",value:l.current_longitude,onChange:i,step:"any",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"106.8456"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(C,{className:"h-5 w-5 text-blue-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Location Information"}),e.jsx("div",{className:"mt-2 text-sm text-blue-700",children:e.jsx("p",{children:"Current location coordinates will be used for smart assignment and tracking purposes. Leave empty if location is not available."})})]})]})})]})]}),e.jsxs("div",{className:"flex items-center justify-end px-6 py-4 bg-gray-50 border-t border-gray-200 space-x-3",children:[e.jsx("button",{type:"button",onClick:z,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:u?"Close":"Cancel"}),!u&&e.jsx("button",{type:"submit",disabled:P,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),r==="edit"?"Update":"Create"," Technician"]})})]})]})]})})},Ue=()=>{var q,W;const x=ue(),n=xe(),[s,w]=h.useState({search:"",employment_status:"",availability_status:"",skill_level:"",work_zone:"",specialization:""}),[r,u]=h.useState(1),[l,g]=h.useState("created_at"),[d,j]=h.useState("DESC"),[P,k]=h.useState(!1),[m,S]=h.useState(null),[L,O]=h.useState("create"),[i,I]=h.useState(10),{data:v,isLoading:B,refetch:z}=R(["technicians",s,r,i,l,d],()=>F.getTechnicians(y(f({},s),{page:r,limit:i,sort_by:l,sort_order:d})),{keepPreviousData:!0}),{data:E}=R("technician-stats",()=>F.getTechnicianStats()),t=he(a=>F.deleteTechnician(a),{onSuccess:()=>{T.success("Technician deleted successfully"),z()},onError:a=>{var c,p;T.error(((p=(c=a.response)==null?void 0:c.data)==null?void 0:p.message)||"Failed to delete technician")}}),o=(a,c)=>{w(p=>y(f({},p),{[a]:c})),u(1)},N=()=>{S(null),O("create"),k(!0)},_=(a,c)=>{window.confirm(`Are you sure you want to delete technician "${c}"? This action cannot be undone.`)&&t.mutate(a)},M=()=>{z(),k(!1),S(null)},A=a=>{x(`/technicians/${a.id}`)},$=a=>{l===a?j(d==="ASC"?"DESC":"ASC"):(g(a),j("DESC")),u(1)},U=a=>l!==a?e.jsx(Ce,{className:"h-4 w-4 text-gray-400"}):d==="ASC"?e.jsx(Te,{className:"h-4 w-4 text-blue-600"}):e.jsx(ze,{className:"h-4 w-4 text-blue-600"}),te=a=>{const c={available:{color:"bg-green-100 text-green-800",icon:G,label:"Available"},busy:{color:"bg-yellow-100 text-yellow-800",icon:Y,label:"Busy"},break:{color:"bg-blue-100 text-blue-800",icon:Ee,label:"On Break"},offline:{color:"bg-gray-100 text-gray-800",icon:ee,label:"Offline"}},p=c[a]||c.offline,ie=p.icon;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p.color}`,children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),p.label]})},re=a=>{const c={junior:{color:"bg-blue-100 text-blue-800",label:"Junior"},senior:{color:"bg-purple-100 text-purple-800",label:"Senior"},expert:{color:"bg-orange-100 text-orange-800",label:"Expert"},specialist:{color:"bg-red-100 text-red-800",label:"Specialist"}},p=c[a]||c.junior;return e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p.color}`,children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),p.label]})},Z=((q=v==null?void 0:v.data)==null?void 0:q.technicians)||[],b=((W=v==null?void 0:v.data)==null?void 0:W.pagination)||{},D=(E==null?void 0:E.data)||{};return h.useEffect(()=>{const a=()=>{n.invalidateQueries(["technicians"]),n.invalidateQueries("technician-stats"),console.log("🔄 Technician list & stats refreshed")};return window.addEventListener("technician-created",a),window.addEventListener("technician-updated",a),window.addEventListener("technician-status-changed",a),()=>{window.removeEventListener("technician-created",a),window.removeEventListener("technician-updated",a),window.removeEventListener("technician-status-changed",a)}},[n]),B&&!v?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(be,{size:"lg"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Technician Management"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Kelola teknisi lapangan dan monitor performa"})]}),e.jsxs("button",{onClick:N,className:"mt-4 sm:mt-0 btn-primary",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Tambah Teknisi"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(J,{icon:X,title:"Total Teknisi",value:D.total_technicians||0,color:"blue"}),e.jsx(J,{icon:G,title:"Available",value:D.available_technicians||0,color:"green",onClick:()=>{w(y(f({},s),{availability_status:s.availability_status==="available"?"":"available"})),u(1)}}),e.jsx(J,{icon:Y,title:"Busy",value:D.busy_technicians||0,color:"yellow",onClick:()=>{w(y(f({},s),{availability_status:s.availability_status==="busy"?"":"busy"})),u(1)}}),e.jsx(J,{icon:ee,title:"Offline",value:D.offline_technicians||0,color:"red",onClick:()=>{w(y(f({},s),{availability_status:s.availability_status==="offline"?"":"offline"})),u(1)}})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ye,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari teknisi...",value:s.search,onChange:a=>o("search",a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"form-input",value:s.availability_status,onChange:a=>o("availability_status",a.target.value),children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"available",children:"Available"}),e.jsx("option",{value:"busy",children:"Busy"}),e.jsx("option",{value:"break",children:"On Break"}),e.jsx("option",{value:"offline",children:"Offline"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Skill Level"}),e.jsxs("select",{className:"form-input",value:s.skill_level,onChange:a=>o("skill_level",a.target.value),children:[e.jsx("option",{value:"",children:"Semua Level"}),e.jsx("option",{value:"junior",children:"Junior"}),e.jsx("option",{value:"senior",children:"Senior"}),e.jsx("option",{value:"expert",children:"Expert"}),e.jsx("option",{value:"specialist",children:"Specialist"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Zone"}),e.jsxs("select",{className:"form-input",value:s.work_zone,onChange:a=>o("work_zone",a.target.value),children:[e.jsx("option",{value:"",children:"Semua Zone"}),e.jsx("option",{value:"Jakarta_Pusat",children:"Jakarta Pusat"}),e.jsx("option",{value:"Jakarta_Selatan",children:"Jakarta Selatan"}),e.jsx("option",{value:"Jakarta_Utara",children:"Jakarta Utara"}),e.jsx("option",{value:"Jakarta_Timur",children:"Jakarta Timur"}),e.jsx("option",{value:"Jakarta_Barat",children:"Jakarta Barat"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specialization"}),e.jsxs("select",{className:"form-input",value:s.specialization,onChange:a=>o("specialization",a.target.value),children:[e.jsx("option",{value:"",children:"Semua Spesialisasi"}),e.jsx("option",{value:"fiber_optic",children:"Fiber Optic"}),e.jsx("option",{value:"wireless",children:"Wireless"}),e.jsx("option",{value:"networking",children:"Networking"}),e.jsx("option",{value:"installation",children:"Installation"}),e.jsx("option",{value:"troubleshooting",children:"Troubleshooting"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employment"}),e.jsxs("select",{className:"form-input",value:s.employment_status,onChange:a=>o("employment_status",a.target.value),children:[e.jsx("option",{value:"",children:"Semua"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Technicians",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",b.total||0," total)"]})]})}),e.jsx("div",{className:"card-body p-0",children:Z.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(X,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900",children:"No technicians found"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Get started by adding your first technician."}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{onClick:N,className:"btn-primary",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Add First Technician"]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>$("full_name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Technician"}),U("full_name")]})}),e.jsx("th",{className:"table-header-cell",children:"Contact"}),e.jsx("th",{className:"table-header-cell",children:"Skills & Zone"}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>$("availability_status"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Status"}),U("availability_status")]})}),e.jsx("th",{className:"table-header-cell",children:"Performance"}),e.jsx("th",{className:"table-header-cell text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"table-body",children:Z.map(a=>{var c;return e.jsxs("tr",{children:[e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:e.jsx(se,{className:"h-5 w-5 text-gray-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.full_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",a.employee_id]})]})]})}),e.jsxs("td",{className:"table-cell",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(je,{className:"h-3 w-3 mr-1 text-gray-400"}),a.phone]}),a.email&&e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(ve,{className:"h-3 w-3 mr-1 text-gray-400"}),a.email]})]}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"space-y-2",children:[re(a.skill_level),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),(c=a.work_zone)==null?void 0:c.replace("_"," ")]})]})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"space-y-2",children:[te(a.availability_status),e.jsxs("div",{className:"text-xs text-gray-500",children:["Active Tickets: ",a.active_tickets||0,"/",a.max_daily_tickets||8]})]})}),e.jsxs("td",{className:"table-cell",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx(Ne,{className:"h-4 w-4 mr-1 text-yellow-400"}),a.avg_customer_rating?parseFloat(a.avg_customer_rating).toFixed(1):"N/A"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Completed: ",a.total_tickets_completed||0]})]}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>A(a),className:"inline-flex items-center justify-center w-8 h-8 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"View Details",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>_(a.id,a.full_name),className:"inline-flex items-center justify-center w-8 h-8 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete Technician",children:e.jsx(we,{className:"h-4 w-4"})})]})})]},a.id)})})]})}),b&&e.jsx("div",{className:"bg-white border-t border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>u(Math.max(1,r-1)),disabled:r===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>u(Math.min(b.pages,r+1)),disabled:r===b.pages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show"}),e.jsxs("select",{value:i,onChange:a=>{I(parseInt(a.target.value)),u(1)},className:"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"rows"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(r-1)*i+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(r*i,b.total)})," ","of ",e.jsx("span",{className:"font-medium",children:b.total})," results"]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>u(Math.max(1,r-1)),disabled:r===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ke,{className:"h-5 w-5"})}),Array.from({length:Math.min(b.pages,10)},(a,c)=>b.pages<=10||r<=5?c+1:r>=b.pages-4?b.pages-9+c:r-5+c).map(a=>e.jsx("button",{onClick:()=>u(a),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${r===a?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:a},a)),e.jsx("button",{onClick:()=>u(Math.min(b.pages,r+1)),disabled:r===b.pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Se,{className:"h-5 w-5"})})]})})]})]})})]})})]}),e.jsx(Ae,{isOpen:P,onClose:()=>k(!1),technician:m,onSuccess:M,mode:L})]})};export{Ue as default};
//# sourceMappingURL=TechniciansPage-jtFTTFWz.js.map
