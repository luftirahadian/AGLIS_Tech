var m=(r,n,o)=>new Promise((h,j)=>{var u=a=>{try{s(o.next(a))}catch(i){j(i)}},v=a=>{try{s(o.throw(a))}catch(i){j(i)}},s=a=>a.done?h(a.value):Promise.resolve(a.value).then(u,v);s((o=o.apply(r,n)).next())});import{a as y,j as e}from"./notifications-TOkqypMs.js";import{r as d}from"./react-vendor-BQ7pSkNi.js";import{a as W,b as A}from"./react-query-B7OIdD7u.js";import{L as z,K as k}from"./customers-CPmtKPP6.js";import{r as F,$ as R,A as M,e as Y,S as Z,V as G,W as H,Y as J,Z as X,_ as ee}from"./ui-vendor-DNUUwVb4.js";import"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";import"./forms-Dmkgx8TD.js";const I={getAll:(...n)=>m(void 0,[...n],function*(r={}){return yield y.get("/inventory-stock",{params:r})}),getById:r=>m(void 0,null,function*(){return yield y.get(`/inventory-stock/${r}`)}),update:(r,n)=>m(void 0,null,function*(){return yield y.put(`/inventory-stock/${r}`,n)}),getLowStockAlerts:()=>m(void 0,null,function*(){return yield y.get("/inventory-stock/alerts/low-stock")}),getValueByCategory:()=>m(void 0,null,function*(){return yield y.get("/inventory-stock/reports/value-by-category")}),getStats:()=>m(void 0,null,function*(){return yield y.get("/inventory-stock/stats")})},de=()=>{const r=W(),[n,o]=d.useState(""),[h,j]=d.useState("all"),[u,v]=d.useState(!1),[s,a]=d.useState(1),[i,O]=d.useState("equipment_name"),[f,L]=d.useState("asc"),[b,E]=d.useState(10),{data:x,isLoading:K}=A(["inventory-stock",h,u,s,b,i,f,n],()=>I.getAll({category:h!=="all"?h:void 0,low_stock:u?"true":void 0,search:n||void 0,page:s,limit:b,sort_by:i,sort_order:f}),{refetchOnWindowFocus:!1,keepPreviousData:!0}),{data:w}=A("low-stock-alerts",I.getLowStockAlerts,{refetchOnWindowFocus:!1}),{data:S}=A("inventory-stats",I.getStats,{refetchOnWindowFocus:!0,refetchOnMount:"always"}),P=Array.isArray(x==null?void 0:x.data)?x.data:[],_=Array.isArray(w==null?void 0:w.data)?w.data:[],l=(x==null?void 0:x.pagination)||{},N=(S==null?void 0:S.data)||{},T=parseInt(N.total_items)||0,Q=parseFloat(N.total_value)||0,U=parseInt(N.low_stock_count)||0,$=parseInt(N.total_categories)||0;d.useEffect(()=>{const t=()=>{r.invalidateQueries(["inventory-stock"]),r.invalidateQueries("inventory-stats"),r.invalidateQueries("low-stock-alerts"),console.log("ðŸ”„ Inventory list & stats refreshed")};return window.addEventListener("inventory-updated",t),window.addEventListener("stock-changed",t),()=>{window.removeEventListener("inventory-updated",t),window.removeEventListener("stock-changed",t)}},[r]);const q=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t),B=t=>({devices:"bg-blue-100 text-blue-800",cables:"bg-green-100 text-green-800",accessories:"bg-yellow-100 text-yellow-800",tools:"bg-purple-100 text-purple-800"})[t]||"bg-gray-100 text-gray-800",g=t=>{i===t?L(f==="asc"?"desc":"asc"):(O(t),L("asc")),a(1)},p=t=>i!==t?e.jsx(J,{className:"h-4 w-4"}):f==="asc"?e.jsx(X,{className:"h-4 w-4"}):e.jsx(ee,{className:"h-4 w-4"}),V=t=>{o(t.target.value),a(1)},D=(t,c)=>{t==="category"?j(c):t==="lowStock"&&v(c),a(1)};return K&&s===1?e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(z,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Stock"}),e.jsx("p",{className:"text-gray-600",children:"Kelola stok equipment dan tools"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(k,{title:"Total Items",value:T,icon:F,color:"blue"}),e.jsx(k,{title:"Total Nilai",value:Q,icon:R,color:"green",format:"currency"}),e.jsx(k,{title:"Low Stock",value:U,icon:M,color:"red",onClick:()=>{v(!u),a(1)}}),e.jsx(k,{title:"Kategori",value:$,icon:Y,color:"purple"})]}),_.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(M,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("h3",{className:"font-semibold text-yellow-800",children:["Peringatan Stock Menipis (",_.length," item)"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:_.map(t=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border border-yellow-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.equipment_name}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Stock: ",t.current_stock," ",t.unit," (Min: ",t.minimum_stock,")"]})]}),e.jsxs("span",{className:"text-xs text-red-600 font-semibold",children:["-",t.shortage]})]},t.id))})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari equipment...",value:n,onChange:V})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Kategori"}),e.jsxs("select",{className:"form-input",value:h,onChange:t=>D("category",t.target.value),children:[e.jsx("option",{value:"all",children:"Semua Kategori"}),e.jsx("option",{value:"devices",children:"Devices"}),e.jsx("option",{value:"cables",children:"Cables"}),e.jsx("option",{value:"accessories",children:"Accessories"}),e.jsx("option",{value:"tools",children:"Tools"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier"}),e.jsx("select",{className:"form-input",value:"all",onChange:t=>{},children:e.jsx("option",{value:"all",children:"Semua Supplier"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Stock"}),e.jsxs("select",{className:"form-input",value:u?"low":"all",onChange:t=>D("lowStock",t.target.value==="low"),children:[e.jsx("option",{value:"all",children:"Semua Stock"}),e.jsx("option",{value:"low",children:"Low Stock Only"})]})]})]})}),P.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(F,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada inventory stock"}),e.jsx("p",{className:"text-gray-500",children:"Data inventory stock tidak ditemukan"})]}):e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Inventory",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",l.totalRecords||0," total)"]})]})}),e.jsxs("div",{className:"card-body p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>g("equipment_name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Equipment"}),p("equipment_name")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>g("category"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Kategori"}),p("category")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>g("current_stock"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Stock"}),p("current_stock")]})}),e.jsx("th",{className:"table-header-cell text-right cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>g("unit_cost"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Unit Cost"}),p("unit_cost")]})}),e.jsx("th",{className:"table-header-cell text-right cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>g("total_value"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Total Value"}),p("total_value")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>g("supplier_name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Supplier"}),p("supplier_name")]})}),e.jsx("th",{className:"table-header-cell text-center",children:"Status"})]})}),e.jsx("tbody",{className:"table-body",children:P.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"table-cell",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.equipment_name}),e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:t.equipment_code})]}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${B(t.category)}`,children:t.category})}),e.jsxs("td",{className:"table-cell whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[t.current_stock," ",t.unit]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Min: ",t.minimum_stock]})]}),e.jsx("td",{className:"table-cell whitespace-nowrap text-sm text-gray-900 text-right",children:q(t.unit_cost)}),e.jsx("td",{className:"table-cell whitespace-nowrap text-right",children:e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:q(t.total_value)})}),e.jsxs("td",{className:"table-cell",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.supplier_name}),e.jsx("div",{className:"text-xs text-gray-500",children:t.supplier_contact})]}),e.jsx("td",{className:"table-cell whitespace-nowrap text-center",children:t.is_low_stock?e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:"Low Stock"}):e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Stock OK"})})]},t.id))})]})}),e.jsxs("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>a(Math.max(1,s-1)),disabled:s===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>a(Math.min(l.totalPages||1,s+1)),disabled:s===(l.totalPages||1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show"}),e.jsxs("select",{value:b,onChange:t=>{E(parseInt(t.target.value)),a(1)},className:"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"rows"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(s-1)*b+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(s*b,l.totalRecords||0)})," ","of ",e.jsx("span",{className:"font-medium",children:l.totalRecords||0})," results"]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>a(Math.max(1,s-1)),disabled:s===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(G,{className:"h-5 w-5"})}),Array.from({length:Math.min(l.totalPages||1,10)},(t,c)=>{const C=l.totalPages||1;return C<=10||s<=5?c+1:s>=C-4?C-9+c:s-5+c}).map(t=>e.jsx("button",{onClick:()=>a(t),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${s===t?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:t},t)),e.jsx("button",{onClick:()=>a(Math.min(l.totalPages||1,s+1)),disabled:s===(l.totalPages||1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(H,{className:"h-5 w-5"})})]})})]})]})]})]})]})};export{de as default};
//# sourceMappingURL=InventoryStockPage-Bu_DoJiG.js.map
