var ae=Object.defineProperty,se=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var q=(l,s,t)=>s in l?ae(l,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[s]=t,g=(l,s)=>{for(var t in s||(s={}))le.call(s,t)&&q(l,t,s[t]);if(I)for(var t of I(s))re.call(s,t)&&q(l,t,s[t]);return l},j=(l,s)=>se(l,te(s));var B=(l,s,t)=>new Promise((n,o)=>{var N=d=>{try{m(t.next(d))}catch(r){o(r)}},c=d=>{try{m(t.throw(d))}catch(r){o(r)}},m=d=>d.done?n(d.value):Promise.resolve(d.value).then(N,c);m((t=t.apply(l,s)).next())});import{j as e}from"./notifications-BKoDXu8u.js";import{r as u}from"./react-vendor-BQ7pSkNi.js";import{a as Q,u as H,b as K}from"./react-query-B7OIdD7u.js";import{X as ie,ap as D,P as O,a4 as w,S as ne,a5 as ce,T as de,Q as oe,V as me,W as xe,Y as he,Z as pe}from"./ui-vendor-DLnrzDYx.js";import{p as k,L as ue,K as T}from"./customers-DUMtI0-E.js";import{u as be}from"./forms-Dmkgx8TD.js";import"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";const ge=({package:l,onClose:s})=>{const t=Q(),n=!!l,{register:o,handleSubmit:N,formState:{errors:c}}=be({defaultValues:l||{name:"",type:"broadband",speed_mbps:"",price:"",description:""}}),m=H(r=>n?k.update(l.id,r):k.create(r),{onSuccess:()=>{t.invalidateQueries("packages"),D.success(`Paket berhasil ${n?"diupdate":"ditambahkan"}`),s()},onError:r=>{var P,b;D.error(((b=(P=r.response)==null?void 0:P.data)==null?void 0:b.message)||`Gagal ${n?"mengupdate":"menambahkan"} paket`)}}),d=r=>{m.mutate(j(g({},r),{speed_mbps:parseInt(r.speed_mbps),price:parseFloat(r.price)}))};return e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n?"Edit Paket":"Tambah Paket Baru"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ie,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:N(d),className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nama Paket *"}),e.jsx("input",j(g({type:"text"},o("name",{required:"Nama paket wajib diisi"})),{className:"input",placeholder:"Contoh: Paket Home 10 Mbps"})),c.name&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipe Paket *"}),e.jsxs("select",j(g({},o("type",{required:"Tipe paket wajib dipilih"})),{className:"input",children:[e.jsx("option",{value:"broadband",children:"Broadband"}),e.jsx("option",{value:"dedicated",children:"Dedicated"}),e.jsx("option",{value:"corporate",children:"Corporate"})]})),c.type&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.type.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kecepatan (Mbps) *"}),e.jsx("input",j(g({type:"number"},o("speed_mbps",{required:"Kecepatan wajib diisi",min:{value:1,message:"Minimal 1 Mbps"}})),{className:"input",placeholder:"10"})),c.speed_mbps&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.speed_mbps.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Harga (Rp) *"}),e.jsx("input",j(g({type:"number"},o("price",{required:"Harga wajib diisi",min:{value:0,message:"Harga tidak boleh negatif"}})),{className:"input",placeholder:"250000"})),c.price&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:c.price.message})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi"}),e.jsx("textarea",j(g({},o("description")),{rows:3,className:"input",placeholder:"Deskripsi paket (opsional)"}))]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 btn-outline",disabled:m.isLoading,children:"Batal"}),e.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:m.isLoading,children:m.isLoading?"Menyimpan...":n?"Update":"Simpan"})]})]})]})})},Se=()=>{const l=Q(),[s,t]=u.useState(""),[n,o]=u.useState("all"),[N,c]=u.useState(!1),[m,d]=u.useState(null),[r,P]=u.useState("type"),[b,A]=u.useState("asc"),[i,h]=u.useState(1),[v,U]=u.useState(10),{data:y,isLoading:W}=K(["packages",n,s,r,b,i,v],()=>k.getAll({type:n!=="all"?n:void 0,search:s||void 0,page:i,limit:v,sort_by:r,sort_order:b}),{refetchOnWindowFocus:!1,keepPreviousData:!0}),L=(y==null?void 0:y.data)||[],p=(y==null?void 0:y.pagination)||{},{data:_}=K("all-packages-stats",()=>k.getAll({page:1,limit:100}),{refetchOnWindowFocus:!1}),C=(_==null?void 0:_.data)||[],$=C.length,z=C.filter(a=>a.type==="broadband").length,G=C.filter(a=>a.type==="dedicated").length,R=C.filter(a=>a.type==="corporate").length,F=H(k.delete,{onSuccess:()=>{l.invalidateQueries("packages"),l.invalidateQueries("all-packages-stats"),D.success("Paket berhasil dihapus")},onError:a=>{var x,f;D.error(((f=(x=a.response)==null?void 0:x.data)==null?void 0:f.message)||"Gagal menghapus paket")}}),E=()=>{d(null),c(!0)},V=a=>{d(a),c(!0)},X=(a,x)=>B(void 0,null,function*(){window.confirm(`Apakah Anda yakin ingin menghapus paket "${x}"?`)&&F.mutate(a)}),S=a=>{r===a?A(b==="asc"?"desc":"asc"):(P(a),A("asc")),h(1)},M=a=>r!==a?e.jsx(xe,{className:"h-4 w-4 text-gray-400"}):b==="asc"?e.jsx(he,{className:"h-4 w-4"}):e.jsx(pe,{className:"h-4 w-4"}),Y=a=>{t(a.target.value),h(1)},Z=a=>{o(a),h(1)},J=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),ee=a=>({broadband:"bg-green-100 text-green-800",dedicated:"bg-purple-100 text-purple-800",corporate:"bg-orange-100 text-orange-800"})[a]||"bg-gray-100 text-gray-800";return W&&i===1?e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(ue,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Paket Langganan"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Kelola paket internet untuk pelanggan"})]}),e.jsxs("button",{onClick:E,className:"btn-primary",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Tambah Paket"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(T,{icon:w,title:"Total Paket",value:$,color:"blue"}),e.jsx(T,{icon:w,title:"Broadband",value:z,color:"green"}),e.jsx(T,{icon:w,title:"Dedicated",value:G,color:"purple"}),e.jsx(T,{icon:w,title:"Corporate",value:R,color:"orange"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari paket...",value:s,onChange:Y})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipe Paket"}),e.jsxs("select",{className:"form-input",value:n,onChange:a=>Z(a.target.value),children:[e.jsx("option",{value:"all",children:"Semua Tipe"}),e.jsx("option",{value:"broadband",children:"Broadband"}),e.jsx("option",{value:"dedicated",children:"Dedicated"}),e.jsx("option",{value:"corporate",children:"Corporate"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Speed Range"}),e.jsx("select",{className:"form-input",value:"all",onChange:a=>{},children:e.jsx("option",{value:"all",children:"Semua Kecepatan"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price Range"}),e.jsx("select",{className:"form-input",value:"all",onChange:a=>{},children:e.jsx("option",{value:"all",children:"Semua Harga"})})]})]})}),L.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(w,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada paket"}),e.jsx("p",{className:"text-gray-500 mb-4",children:s||n!=="all"?"Tidak ada paket yang sesuai dengan filter":"Mulai dengan menambahkan paket langganan pertama"}),!s&&n==="all"&&e.jsxs("button",{onClick:E,className:"btn-primary",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Tambah Paket"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Packages",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",p.total||0," total)"]})]})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Package Name"}),M("name")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("type"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Type"}),M("type")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>S("speed_mbps"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Speed"}),M("speed_mbps")]})}),e.jsx("th",{className:"table-header-cell",children:"Description"}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors text-right",onClick:()=>S("price"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Monthly Price"}),M("price")]})}),e.jsx("th",{className:"table-header-cell text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"table-body",children:L.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${ee(a.type)}`,children:a.type?a.type.charAt(0).toUpperCase()+a.type.slice(1):"Unknown"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-semibold text-blue-600",children:[a.speed_mbps," Mbps"]})}),e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm text-gray-900 truncate",title:a.description,style:{maxWidth:"300px"},children:a.description||"-"})}),e.jsxs("td",{className:"table-cell whitespace-nowrap text-right",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:J(a.price)}),e.jsx("div",{className:"text-xs text-gray-500",children:"/bulan"})]}),e.jsx("td",{className:"table-cell text-center",children:e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>V(a),className:"inline-flex items-center justify-center w-8 h-8 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"Edit Package",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>X(a.id,a.name),className:"inline-flex items-center justify-center w-8 h-8 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete Package",disabled:F.isLoading,children:e.jsx(de,{className:"h-4 w-4"})})]})})]},a.id))})]})})})]}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>h(Math.max(1,i-1)),disabled:i===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>h(Math.min(p.pages||1,i+1)),disabled:i===(p.pages||1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show"}),e.jsxs("select",{value:v,onChange:a=>{U(parseInt(a.target.value)),h(1)},className:"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"rows"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(i-1)*v+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(i*v,p.total||0)})," ","of ",e.jsx("span",{className:"font-medium",children:p.total||0})," results"]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>h(Math.max(1,i-1)),disabled:i===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(oe,{className:"h-5 w-5"})}),Array.from({length:Math.min(p.pages||1,10)},(a,x)=>{const f=p.pages||1;return f<=10||i<=5?x+1:i>=f-4?f-9+x:i-5+x}).map(a=>e.jsx("button",{onClick:()=>h(a),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${i===a?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:a},a)),e.jsx("button",{onClick:()=>h(Math.min(p.pages||1,i+1)),disabled:i===(p.pages||1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(me,{className:"h-5 w-5"})})]})})]})]})})]}),N&&e.jsx(ge,{package:m,onClose:()=>{c(!1),d(null)}})]})};export{Se as default};
//# sourceMappingURL=PackagesPage-B7QIxyXM.js.map
