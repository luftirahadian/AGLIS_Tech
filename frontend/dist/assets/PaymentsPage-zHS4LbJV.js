import{a,j as e}from"./notifications-C0yZ9C-Z.js";import{u as Q,r as h}from"./react-vendor-BQ7pSkNi.js";import{a as z,b as k,u as L}from"./react-query-B7OIdD7u.js";import{a1 as S,_ as P,K as $,R as D,S as T,C as b,E as q,b as K,z as F}from"./ui-vendor-gTLpeMoy.js";import"./charts-CREYXqqm.js";const j={getAll:s=>a.get("/payments",{params:s}),getById:s=>a.get(`/payments/${s}`),create:s=>a.post("/payments",s),update:(s,n)=>a.put(`/payments/${s}`,n),delete:s=>a.delete(`/payments/${s}`),verify:s=>a.post(`/payments/${s}/verify`),refund:(s,n)=>a.post(`/payments/${s}/refund`,n),getStatistics:s=>a.get("/payments/statistics",{params:s})},J=()=>{var _,C;const s=Q(),n=z(),[l,i]=h.useState(1),[m,f]=h.useState(""),[p,N]=h.useState(""),[g,v]=h.useState(""),{data:c,isLoading:A}=k(["payments",l,m,p,g],()=>j.getAll({page:l,limit:20,search:m,status:p,payment_method:g}),{keepPreviousData:!0}),{data:y}=k(["payment-statistics"],()=>j.getStatistics()),w=((_=c==null?void 0:c.data)==null?void 0:_.payments)||[],x=((C=c==null?void 0:c.data)==null?void 0:C.pagination)||{},d=(y==null?void 0:y.data)||{},I=L(t=>j.verify(t),{onSuccess:()=>{n.invalidateQueries("payments"),n.invalidateQueries("payment-statistics"),F.success("Payment verified successfully")},onError:t=>{var r,o;F.error(((o=(r=t.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to verify payment")}}),R=t=>{const r={pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:$},completed:{bg:"bg-green-100",text:"text-green-800",icon:b},verified:{bg:"bg-blue-100",text:"text-blue-800",icon:b},failed:{bg:"bg-red-100",text:"text-red-800",icon:K},refunded:{bg:"bg-gray-100",text:"text-gray-600",icon:D}},o=r[t]||r.pending,B=o.icon;return e.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium ${o.bg} ${o.text}`,children:[e.jsx(B,{className:"h-3 w-3"}),e.jsx("span",{className:"capitalize",children:t})]})},E=t=>{const r={cash:"bg-green-100 text-green-800",bank_transfer:"bg-blue-100 text-blue-800",credit_card:"bg-purple-100 text-purple-800",e_wallet:"bg-orange-100 text-orange-800",virtual_account:"bg-indigo-100 text-indigo-800"};return e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${r[t]||"bg-gray-100 text-gray-800"}`,children:t==null?void 0:t.replace("_"," ").toUpperCase()})},u=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),M=t=>t?new Date(t).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric"}):"-",V=t=>{window.confirm(`Verify payment ${t.payment_number}?`)&&I.mutate(t.id)};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center space-x-2",children:[e.jsx(S,{className:"h-7 w-7 text-green-600"}),e.jsx("span",{children:"Payments"})]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage payment transactions"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Total Collected"}),e.jsx(P,{className:"h-5 w-5 text-green-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u(d.total_collected||0)}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[d.completed_count||0," payments"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx($,{className:"h-5 w-5 text-yellow-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.pending_count||0}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Needs verification"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Refunded"}),e.jsx(D,{className:"h-5 w-5 text-gray-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u(d.total_refunded||0)}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[d.refunded_count||0," transactions"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Average Payment"}),e.jsx(P,{className:"h-5 w-5 text-blue-600"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u(d.average_payment||0)}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Per transaction"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search payments...",value:m,onChange:t=>{f(t.target.value),i(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("select",{value:p,onChange:t=>{N(t.target.value),i(1)},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"refunded",children:"Refunded"})]}),e.jsxs("select",{value:g,onChange:t=>{v(t.target.value),i(1)},className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"All Methods"}),e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"credit_card",children:"Credit Card"}),e.jsx("option",{value:"e_wallet",children:"E-Wallet"}),e.jsx("option",{value:"virtual_account",children:"Virtual Account"})]}),(m||p||g)&&e.jsx("button",{onClick:()=>{f(""),N(""),v(""),i(1)},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Clear Filters"})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[A?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading payments..."})]}):w.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No payments found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Payment #"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Invoice"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Method"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:w.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.payment_number}),t.reference_number&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Ref: ",t.reference_number]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.invoice_number?e.jsx("button",{onClick:()=>s(`/invoices/${t.invoice_id}`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:t.invoice_number}):e.jsx("span",{className:"text-sm text-gray-500",children:"-"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.customer_name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:M(t.payment_date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-semibold text-gray-900",children:u(t.amount)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:[E(t.payment_method),t.payment_channel&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.payment_channel})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:R(t.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[t.status==="pending"&&e.jsx("button",{onClick:()=>V(t),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"Verify",children:e.jsx(b,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>s(`/payments/${t.id}`),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"View Details",children:e.jsx(q,{className:"h-4 w-4"})})]})})]},t.id))})]})}),x.total_pages>1&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing page ",x.page," of ",x.total_pages,e.jsxs("span",{className:"ml-2 text-gray-500",children:["(",x.total," total payments)"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>i(l-1),disabled:l===1,className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>i(l+1),disabled:l===x.total_pages,className:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})})]})]})};export{J as default};
//# sourceMappingURL=PaymentsPage-zHS4LbJV.js.map
