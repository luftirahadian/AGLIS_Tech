{"version":3,"file":"CustomerTicketDetailPage-DZ-R2dsq.js","sources":["../../src/pages/customer-portal/CustomerTicketDetailPage.jsx"],"sourcesContent":["import React from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useQuery } from 'react-query';\nimport { \n  Ticket, Calendar, User, Clock, CheckCircle, AlertCircle,\n  ArrowLeft, MessageCircle\n} from 'lucide-react';\nimport api from '../../services/api';\nimport CustomerPortalLayout from '../../components/CustomerPortalLayout';\n\nconst CustomerTicketDetailPage = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n\n  const { data: ticketData, isLoading } = useQuery(\n    ['customer-ticket-detail', id],\n    async () => {\n      const token = localStorage.getItem('customerToken');\n      const response = await api.get(`/customer-portal/tickets`, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      // Find the specific ticket\n      const tickets = response?.data?.tickets || response?.tickets || [];\n      return tickets.find(t => t.id === parseInt(id));\n    }\n  );\n\n  const ticket = ticketData;\n\n  const getStatusBadge = (status) => {\n    const badges = {\n      open: 'bg-blue-100 text-blue-700',\n      assigned: 'bg-purple-100 text-purple-700',\n      in_progress: 'bg-yellow-100 text-yellow-700',\n      completed: 'bg-green-100 text-green-700',\n      cancelled: 'bg-red-100 text-red-700',\n      on_hold: 'bg-gray-100 text-gray-700'\n    };\n    return badges[status] || 'bg-gray-100 text-gray-700';\n  };\n\n  const getStatusIcon = (status) => {\n    const icons = {\n      open: <Clock className=\"h-5 w-5\" />,\n      assigned: <User className=\"h-5 w-5\" />,\n      in_progress: <AlertCircle className=\"h-5 w-5\" />,\n      completed: <CheckCircle className=\"h-5 w-5\" />\n    };\n    return icons[status] || <Ticket className=\"h-5 w-5\" />;\n  };\n\n  if (isLoading) {\n    return (\n      <CustomerPortalLayout>\n        <div className=\"flex justify-center py-12\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent\"></div>\n        </div>\n      </CustomerPortalLayout>\n    );\n  }\n\n  if (!ticket) {\n    return (\n      <CustomerPortalLayout>\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"bg-white rounded-lg shadow-sm p-12 text-center\">\n            <Ticket className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\n            <p className=\"text-gray-500 mb-4\">Tiket tidak ditemukan</p>\n            <button\n              onClick={() => navigate('/customer/tickets')}\n              className=\"text-blue-600 hover:text-blue-700 font-medium\"\n            >\n              ‚Üê Kembali ke Tiket Saya\n            </button>\n          </div>\n        </div>\n      </CustomerPortalLayout>\n    );\n  }\n\n  return (\n    <CustomerPortalLayout>\n      <div className=\"max-w-4xl mx-auto\">\n        {/* Back Button */}\n        <button\n          onClick={() => navigate('/customer/tickets')}\n          className=\"flex items-center space-x-2 text-gray-600 hover:text-gray-900 mb-6\"\n        >\n          <ArrowLeft className=\"h-4 w-4\" />\n          <span>Kembali ke Tiket Saya</span>\n        </button>\n\n        {/* Ticket Header */}\n        <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\n          <div className=\"flex items-start justify-between mb-4\">\n            <div>\n              <div className=\"flex items-center space-x-2 mb-2\">\n                <h1 className=\"text-2xl font-bold text-gray-900\">#{ticket.ticket_number}</h1>\n                <span className={`px-3 py-1 text-sm rounded-full flex items-center space-x-1 ${getStatusBadge(ticket.status)}`}>\n                  {getStatusIcon(ticket.status)}\n                  <span>{ticket.status}</span>\n                </span>\n                <span className={`px-2 py-1 text-xs rounded-full ${\n                  ticket.priority === 'high' ? 'bg-red-100 text-red-700' :\n                  ticket.priority === 'normal' ? 'bg-blue-100 text-blue-700' :\n                  'bg-gray-100 text-gray-700'\n                }`}>\n                  {ticket.priority}\n                </span>\n              </div>\n              <h2 className=\"text-lg font-medium text-gray-900 mb-2\">{ticket.title}</h2>\n              <div className=\"flex items-center space-x-4 text-sm text-gray-600\">\n                <span className=\"flex items-center\">\n                  <Calendar className=\"h-4 w-4 mr-1\" />\n                  Dibuat: {new Date(ticket.created_at).toLocaleDateString('id-ID', { \n                    day: 'numeric', \n                    month: 'long', \n                    year: 'numeric' \n                  })}\n                </span>\n                {ticket.technician_name && (\n                  <span className=\"flex items-center\">\n                    <User className=\"h-4 w-4 mr-1\" />\n                    Teknisi: {ticket.technician_name}\n                  </span>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Ticket Details */}\n        <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Detail Tiket</h3>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <p className=\"text-sm text-gray-600 mb-1\">Jenis Tiket</p>\n              <p className=\"font-medium text-gray-900\">{ticket.type}</p>\n            </div>\n\n            <div>\n              <p className=\"text-sm text-gray-600 mb-1\">Kategori</p>\n              <p className=\"font-medium text-gray-900\">{ticket.category || '-'}</p>\n            </div>\n\n            <div>\n              <p className=\"text-sm text-gray-600 mb-1\">Deskripsi Masalah</p>\n              <p className=\"text-gray-900 whitespace-pre-line\">{ticket.description}</p>\n            </div>\n\n            {ticket.resolution_notes && (\n              <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n                <p className=\"text-sm font-semibold text-green-900 mb-2\">‚úÖ Solusi</p>\n                <p className=\"text-sm text-green-800 whitespace-pre-line\">{ticket.resolution_notes}</p>\n              </div>\n            )}\n\n            {ticket.work_notes && (\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                <p className=\"text-sm font-semibold text-blue-900 mb-2\">üìù Catatan Teknisi</p>\n                <p className=\"text-sm text-blue-800 whitespace-pre-line\">{ticket.work_notes}</p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Timeline */}\n        <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\n          <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Timeline</h3>\n          \n          <div className=\"space-y-3\">\n            <div className=\"flex items-start space-x-3\">\n              <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2\"></div>\n              <div>\n                <p className=\"text-sm font-medium text-gray-900\">Tiket Dibuat</p>\n                <p className=\"text-xs text-gray-600\">\n                  {new Date(ticket.created_at).toLocaleString('id-ID')}\n                </p>\n              </div>\n            </div>\n\n            {ticket.started_at && (\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-2 h-2 bg-yellow-500 rounded-full mt-2\"></div>\n                <div>\n                  <p className=\"text-sm font-medium text-gray-900\">Pekerjaan Dimulai</p>\n                  <p className=\"text-xs text-gray-600\">\n                    {new Date(ticket.started_at).toLocaleString('id-ID')}\n                  </p>\n                </div>\n              </div>\n            )}\n\n            {ticket.completed_at && (\n              <div className=\"flex items-start space-x-3\">\n                <div className=\"w-2 h-2 bg-green-500 rounded-full mt-2\"></div>\n                <div>\n                  <p className=\"text-sm font-medium text-gray-900\">Tiket Selesai</p>\n                  <p className=\"text-xs text-gray-600\">\n                    {new Date(ticket.completed_at).toLocaleString('id-ID')}\n                  </p>\n                  {ticket.actual_duration && (\n                    <p className=\"text-xs text-gray-500\">\n                      Durasi: {Math.floor(ticket.actual_duration / 60)} jam {ticket.actual_duration % 60} menit\n                    </p>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Technician Info */}\n        {ticket.technician_name && (\n          <div className=\"bg-white rounded-xl shadow-sm p-6 mb-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Informasi Teknisi</h3>\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center\">\n                <User className=\"h-6 w-6 text-blue-600\" />\n              </div>\n              <div>\n                <p className=\"font-semibold text-gray-900\">{ticket.technician_name}</p>\n                {ticket.technician_phone && (\n                  <a \n                    href={`https://wa.me/${ticket.technician_phone.replace(/^0/, '62')}`}\n                    className=\"text-sm text-green-600 hover:text-green-700 flex items-center\"\n                  >\n                    <MessageCircle className=\"h-3 w-3 mr-1\" />\n                    {ticket.technician_phone}\n                  </a>\n                )}\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Customer Feedback */}\n        {ticket.customer_rating && (\n          <div className=\"bg-white rounded-xl shadow-sm p-6\">\n            <h3 className=\"text-lg font-semibold text-gray-900 mb-4\">Rating Anda</h3>\n            <div className=\"flex items-center space-x-1 mb-2\">\n              {[1, 2, 3, 4, 5].map((star) => (\n                <span key={star} className={`text-2xl ${star <= ticket.customer_rating ? 'text-yellow-400' : 'text-gray-300'}`}>\n                  ‚≠ê\n                </span>\n              ))}\n            </div>\n            {ticket.customer_feedback && (\n              <p className=\"text-sm text-gray-600 mt-2\">{ticket.customer_feedback}</p>\n            )}\n          </div>\n        )}\n      </div>\n    </CustomerPortalLayout>\n  );\n};\n\nexport default CustomerTicketDetailPage;\n\n"],"names":["CustomerTicketDetailPage","id","useParams","navigate","useNavigate","ticketData","isLoading","useQuery","__async","token","response","api","_a","t","ticket","getStatusBadge","status","getStatusIcon","jsx","Clock","User","AlertCircle","CheckCircle","Ticket","CustomerPortalLayout","jsxs","ArrowLeft","Calendar","MessageCircle","star"],"mappings":"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"}