var b=(p,g,r)=>new Promise((n,u)=>{var o=t=>{try{s(r.next(t))}catch(c){u(c)}},i=t=>{try{s(r.throw(t))}catch(c){u(c)}},s=t=>t.done?n(t.value):Promise.resolve(t.value).then(o,i);s((r=r.apply(p,g)).next())});import{j as e,a as f}from"./notifications-Dggueh-l.js";import{u as N,r as x}from"./react-vendor-BQ7pSkNi.js";import{n as j,p as v,aI as w,aU as k,z as h}from"./ui-vendor-CO1ReX4_.js";import"./react-query-B7OIdD7u.js";import"./charts-CREYXqqm.js";const K=()=>{const p=N(),[g,r]=x.useState("phone"),[n,u]=x.useState(""),[o,i]=x.useState(""),[s,t]=x.useState(!1),c=l=>b(void 0,null,function*(){var d,m;l.preventDefault(),t(!0);try{(yield f.post("/customer-portal/request-otp",{phone:n})).data.success&&(h.success("Kode OTP telah dikirim ke WhatsApp Anda!"),r("otp"))}catch(a){h.error(((m=(d=a.response)==null?void 0:d.data)==null?void 0:m.message)||"Gagal mengirim OTP")}finally{t(!1)}}),y=l=>b(void 0,null,function*(){var d,m;l.preventDefault(),t(!0);try{const a=yield f.post("/customer-portal/verify-otp",{phone:n,otp:o});a.data.success&&(localStorage.setItem("customerToken",a.data.data.token),localStorage.setItem("customerData",JSON.stringify(a.data.data.customer)),h.success("Login berhasil!"),p("/customer/dashboard"))}catch(a){h.error(((m=(d=a.response)==null?void 0:d.data)==null?void 0:m.message)||"Kode OTP salah atau expired"),i("")}finally{t(!1)}});return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-600 to-green-600 rounded-2xl mb-4",children:e.jsx(j,{className:"h-10 w-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"AGLIS Customer Portal"}),e.jsx("p",{className:"text-gray-600",children:"Login dengan nomor WhatsApp Anda"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[g==="phone"?e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nomor WhatsApp"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"tel",value:n,onChange:l=>u(l.target.value),placeholder:"08123456789",className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Gunakan nomor WhatsApp yang terdaftar sebagai customer"})]}),e.jsx("button",{type:"submit",disabled:s||!n,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),e.jsx("span",{children:"Mengirim OTP..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-5 w-5"}),e.jsx("span",{children:"Kirim Kode OTP"})]})})]}):e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-3",children:e.jsx(w,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Masukkan Kode OTP"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Kode telah dikirim ke WhatsApp ",n.replace(/(\d{4})\d+(\d{3})/,"$1****$2")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kode OTP (6 digit)"}),e.jsx("input",{type:"text",value:o,onChange:l=>i(l.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",className:"w-full px-4 py-3 text-center text-2xl tracking-widest border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",maxLength:6,autoFocus:!0,required:!0})]}),e.jsx("button",{type:"submit",disabled:s||o.length!==6,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),e.jsx("span",{children:"Memverifikasi..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-5 w-5"}),e.jsx("span",{children:"Login"})]})}),e.jsx("button",{type:"button",onClick:()=>{r("phone"),i("")},className:"w-full text-sm text-gray-600 hover:text-gray-900",children:"← Kembali ke input nomor"})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Butuh bantuan?"," ",e.jsx("a",{href:"https://wa.me/628179380800",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Hubungi Customer Service"})]})})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-600",children:e.jsx("p",{children:"© 2025 AGLIS Net. All rights reserved."})})]})})};export{K as default};
//# sourceMappingURL=CustomerLoginPage-DKn7NSgH.js.map
