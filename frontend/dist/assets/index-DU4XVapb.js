const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AnalyticsDashboard-DfdWFgIt.js","assets/notifications-DGuCqj8i.js","assets/react-vendor-BQ7pSkNi.js","assets/react-query-B7OIdD7u.js","assets/ui-vendor-DFmaqm_b.js","assets/charts-CREYXqqm.js","assets/customers-IXR_7pB8.js","assets/socket-BFcXWKeu.js","assets/forms-Dmkgx8TD.js","assets/PerformanceDashboard-DR01maUM.js","assets/tickets-D86rcXeL.js","assets/TechniciansPage-BRhxSNjR.js","assets/TechnicianDetailPage-CuCEllFR.js","assets/InventoryPage-B5Xvnboe.js","assets/InventoryStockPage-Cxu6iFqH.js","assets/PackagesPage-BzFazpMm.js","assets/PriceListPage-C9oqBTeB.js","assets/EquipmentPage-D9wChxBc.js","assets/ODPPage-C4N6-UnU.js","assets/ServiceTypesPage-10a8JJwP.js","assets/ServiceCategoriesPage-DfxVO9Y9.js","assets/UsersPage-Ne-1TIaS.js","assets/PermissionsPage-Deia1t4w.js","assets/ProfilePage-CHRMbnA5.js","assets/RegisterPage-C6uImjb1.js","assets/registrationService-BImTFU-v.js","assets/TrackingPage-CwmS1vdf.js","assets/RegistrationsPage-DYbj8YAY.js","assets/RegistrationDetailPage-BuQcU2nE.js","assets/RegistrationAnalyticsPage-CQ29nEH2.js","assets/InvoicesPage-Dk5cVMKS.js","assets/InvoiceDetailPage-DPNKpJTj.js","assets/InvoiceCreatePage-N7FkdzSS.js","assets/PaymentsPage-q3A2wxsT.js"])))=>i.map(i=>d[i]);
var nt=Object.defineProperty,it=Object.defineProperties;var ot=Object.getOwnPropertyDescriptors;var _e=Object.getOwnPropertySymbols;var ct=Object.prototype.hasOwnProperty,lt=Object.prototype.propertyIsEnumerable;var ke=(t,a,r)=>a in t?nt(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r,T=(t,a)=>{for(var r in a||(a={}))ct.call(a,r)&&ke(t,r,a[r]);if(_e)for(var r of _e(a))lt.call(a,r)&&ke(t,r,a[r]);return t},R=(t,a)=>it(t,ot(a));var _=(t,a,r)=>new Promise((n,s)=>{var i=d=>{try{g(r.next(d))}catch(m){s(m)}},c=d=>{try{g(r.throw(d))}catch(m){s(m)}},g=d=>d.done?n(d.value):Promise.resolve(d.value).then(i,c);g((r=r.apply(t,a)).next())});import{a as E,j as e}from"./notifications-DGuCqj8i.js";import{b as dt,r as u,f as ut,N as Se,a as ze,L as mt,O as ht,g as qe,u as ft,h as pt,i as w,j as ne,B as gt}from"./react-vendor-BQ7pSkNi.js";import{a as ce,b as Y,u as te,Q as xt,c as vt}from"./react-query-B7OIdD7u.js";import{z as D,al as yt,B as Pe,a8 as Ve,af as ae,J as ue,N as bt,ab as me,q as Ue,F as jt,a1 as wt,am as Nt,j as K,an as _t,a6 as kt,X as be,ao as He,V as Qe,ap as W,l as St,aq as Pt,ar as Tt,T as Xe,A as Te,C as re,I as Ce,a as Ct,s as je,m as At,as as Et,u as Rt,k as Mt,aj as Ot,at as Dt,U as Lt,au as It,av as Ae,Q as $t,aw as Ft,E as Wt,ag as zt,ah as qt,ax as Vt,b as Ut,K as Ht,ay as Qt}from"./ui-vendor-DFmaqm_b.js";import{u as Z,s as P,L as se,K as G,A as Xt}from"./customers-IXR_7pB8.js";import{u as Jt}from"./forms-Dmkgx8TD.js";import{r as Kt}from"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var he={},Ee=dt;he.createRoot=Ee.createRoot,he.hydrateRoot=Ee.hydrateRoot;var Je={exports:{}};Je.exports={ReactQueryDevtools:function(){return null},ReactQueryDevtoolsPanel:function(){return null}};var Bt=Je.exports;const Yt="modulepreload",Gt=function(t){return"/"+t},Re={},k=function(a,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),g=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=Promise.allSettled(r.map(d=>{if(d=Gt(d),d in Re)return;Re[d]=!0;const m=d.endsWith(".css"),y=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${y}`))return;const l=document.createElement("link");if(l.rel=m?"stylesheet":Yt,m||(l.as="script"),l.crossOrigin="",l.href=d,g&&l.setAttribute("nonce",g),document.head.appendChild(l),m)return new Promise((o,f)=>{l.addEventListener("load",o),l.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(c){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=c,window.dispatchEvent(g),!g.defaultPrevented)throw c}return s.then(c=>{for(const g of c||[])g.status==="rejected"&&i(g.reason);return a().catch(i)})},z={getNotifications:(...a)=>_(void 0,[...a],function*(t={}){const r=new URLSearchParams;t.page&&r.append("page",t.page),t.limit&&r.append("limit",t.limit),t.type&&r.append("type",t.type),t.is_read!==void 0&&r.append("is_read",t.is_read),t.priority&&r.append("priority",t.priority),t.include_archived&&r.append("include_archived",t.include_archived);const n=r.toString(),s=`/notifications${n?`?${n}`:""}`;return E.get(s)}),getNotification:t=>_(void 0,null,function*(){return E.get(`/notifications/${t}`)}),markAsRead:t=>_(void 0,null,function*(){return E.patch(`/notifications/${t}/read`)}),markAllAsRead:()=>_(void 0,null,function*(){return E.patch("/notifications/read-all")}),archive:t=>_(void 0,null,function*(){return E.patch(`/notifications/${t}/archive`)}),delete:t=>_(void 0,null,function*(){return E.delete(`/notifications/${t}`)}),getSettings:()=>_(void 0,null,function*(){return E.get("/notifications/settings/preferences")}),updateSettings:t=>_(void 0,null,function*(){return E.put("/notifications/settings/preferences",t)}),cleanupExpired:()=>_(void 0,null,function*(){return E.delete("/notifications/cleanup/expired")}),create:t=>_(void 0,null,function*(){return E.post("/notifications",t)})},Zt=u.createContext(),ea=({children:t})=>{const{user:a}=Z(),r=ce(),n=u.useRef(!1),s=u.useRef(new Set),[i,c]=u.useState([]),[g,d]=u.useState(0),[m,y]=u.useState(!1),[l,o]=u.useState({email_notifications:!0,push_notifications:!0,sound_notifications:!0,notification_types:{ticket_assigned:!0,ticket_updated:!0,ticket_completed:!0,system_alert:!0,technician_status:!0,new_ticket:!0}}),{data:f,isLoading:h,refetch:N}=Y(["notifications",{page:1,limit:50,is_read:!1}],()=>z.getNotifications({page:1,limit:50,is_read:!1}),{enabled:!!a,refetchInterval:3e4,onSuccess:p=>{var b;(b=p==null?void 0:p.data)!=null&&b.notifications&&(c(p.data.notifications),d(p.data.unreadCount||0))}}),{data:M}=Y(["notification-settings"],z.getSettings,{enabled:!!a,onSuccess:p=>{var b;(b=p==null?void 0:p.data)!=null&&b.settings&&o(p.data.settings)}}),v=u.useCallback(p=>{const b=`${p.id||p.type}-${p.timestamp||Date.now()}`;if(s.current.has(b)){console.log("⚠️ Duplicate notification ignored:",b);return}s.current.add(b),setTimeout(()=>{s.current.delete(b)},1e4),console.log("🔔 Received notification:",p),c(I=>[p,...I]),d(I=>I+1),l.push_notifications&&O(p.type)&&J(p),l.sound_notifications&&O(p.type)&&L(),r.invalidateQueries(["notifications"])},[l,r]),S=u.useCallback(p=>{console.log("🎫 Ticket updated:",p),r.invalidateQueries(["tickets"]),r.invalidateQueries(["ticket",p.ticketId]),(p.assignedTo===(a==null?void 0:a.id)||p.updatedBy===(a==null?void 0:a.id))&&D.success(`Ticket #${p.ticketId} updated`)},[r,a]),j=u.useCallback(p=>{console.log("👷 Technician status changed:",p),r.invalidateQueries(["technicians"]),r.invalidateQueries(["technician-stats"]),((a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="supervisor")&&D.info(`Technician status updated: ${p.status}`)},[r,a]),C=u.useCallback(p=>{console.log("⚠️ System alert:",p);const b={duration:p.priority==="urgent"?1e4:5e3,style:{background:p.priority==="urgent"?"#ef4444":"#f59e0b",color:"white"}};D(p.message,b)},[]),O=p=>{var b;return((b=l.notification_types)==null?void 0:b[p])!==!1},J=p=>{const b={duration:5e3,style:{background:p.priority==="high"?"#ef4444":"#3b82f6",color:"white"}};D(p.message,b)},L=()=>{try{const p=new(window.AudioContext||window.webkitAudioContext),b=p.createOscillator(),I=p.createGain();b.connect(I),I.connect(p.destination),b.frequency.value=800,b.type="sine",I.gain.setValueAtTime(.3,p.currentTime),I.gain.exponentialRampToValueAtTime(.01,p.currentTime+.5),b.start(p.currentTime),b.stop(p.currentTime+.5)}catch(p){console.warn("Could not play notification sound:",p)}};u.useEffect(()=>{if(!a)return;console.log("🔗 Initializing Socket.IO connection..."),P.connect(a);const b=setInterval(()=>{const I=P.getConnectionStatus();y(I.isConnected)},1e3);return()=>{clearInterval(b)}},[a]),u.useEffect(()=>{if(!(!m||n.current))return console.log("📡 Setting up socket event listeners..."),n.current=!0,P.on("notification",v),P.on("ticket_updated",S),P.on("technician_status_changed",j),P.on("system_alert",C),()=>{console.log("🔌 Cleaning up socket event listeners..."),n.current=!1,P.off("notification",v),P.off("ticket_updated",S),P.off("technician_status_changed",j),P.off("system_alert",C)}},[m,v,S,j,C]),u.useEffect(()=>()=>{console.log("🛑 Disconnecting socket on unmount..."),P.disconnect()},[]);const st={notifications:i,unreadCount:g,isSocketConnected:m,settings:l,isLoading:h,markAsRead:p=>_(void 0,null,function*(){try{yield z.markAsRead(p),c(b=>b.map(I=>I.id===p?R(T({},I),{is_read:!0,read_at:new Date().toISOString()}):I)),d(b=>Math.max(0,b-1)),r.invalidateQueries(["notifications"])}catch(b){console.error("Error marking notification as read:",b),D.error("Failed to mark notification as read")}}),markAllAsRead:()=>_(void 0,null,function*(){try{yield z.markAllAsRead(),c(p=>p.map(b=>R(T({},b),{is_read:!0,read_at:new Date().toISOString()}))),d(0),r.invalidateQueries(["notifications"]),D.success("All notifications marked as read")}catch(p){console.error("Error marking all notifications as read:",p),D.error("Failed to mark all notifications as read")}}),archiveNotification:p=>_(void 0,null,function*(){try{yield z.archiveNotification(p),c(b=>b.filter(I=>I.id!==p)),r.invalidateQueries(["notifications"]),D.success("Notification archived")}catch(b){console.error("Error archiving notification:",b),D.error("Failed to archive notification")}}),updateSettings:p=>_(void 0,null,function*(){try{yield z.updateSettings(p),o(b=>T(T({},b),p)),r.invalidateQueries(["notification-settings"]),D.success("Notification settings updated")}catch(b){console.error("Error updating notification settings:",b),D.error("Failed to update notification settings")}}),refetchNotifications:N,joinRoom:p=>{m&&P.joinRoom(p)},leaveRoom:p=>{m&&P.leaveRoom(p)},emitTicketUpdate:p=>{m&&P.emitTicketUpdate(p)},emitTechnicianStatusUpdate:p=>{m&&P.emitTechnicianStatusUpdate(p)},reconnect:()=>P.reconnect(a),disconnect:()=>P.disconnect()};return e.jsx(Zt.Provider,{value:st,children:t})},ta={getAllPermissions:()=>_(void 0,null,function*(){return yield E.get("/permissions/all")}),getRolePermissions:t=>_(void 0,null,function*(){return yield E.get(`/permissions/role/${t}`)}),getPermissionMatrix:()=>_(void 0,null,function*(){return yield E.get("/permissions/matrix")}),updateRolePermissions:(t,a)=>_(void 0,null,function*(){return yield E.put(`/permissions/role/${t}`,{permissions:a})}),getMyPermissions:()=>_(void 0,null,function*(){return yield E.get("/permissions/me")})},aa=u.createContext(),ra=({children:t})=>{const{user:a}=Z(),[r,n]=u.useState([]),{data:s,isLoading:i}=Y(["permissions",a==null?void 0:a.role],()=>ta.getMyPermissions(),{enabled:!!a,onSuccess:o=>{var N;const f=((N=o.data)==null?void 0:N.permissions)||[],h=Array.isArray(f)?f.map(M=>typeof M=="string"?M:M.name):[];n(h)},onError:o=>{console.error("Failed to load permissions:",o),n([])}}),c=o=>(a==null?void 0:a.role)==="admin"?!0:r.includes(o),g=(...o)=>(a==null?void 0:a.role)==="admin"?!0:o.some(f=>r.includes(f)),l={permissions:r,isLoading:i,hasPermission:c,hasAnyPermission:g,hasAllPermissions:(...o)=>(a==null?void 0:a.role)==="admin"?!0:o.every(f=>r.includes(f)),can:(o,f)=>{const h=`${o}.${f}`;return c(h)},canAccessPage:o=>{const h={dashboard:["dashboard.view"],analytics:["analytics.view"],tickets:["tickets.view"],customers:["customers.view"],registrations:["registrations.view"],technicians:["technicians.view"],inventory:["inventory.view"],users:["users.view"],permissions:["permissions.view"]}[o];return h?g(...h):!0}};return e.jsx(aa.Provider,{value:l,children:t})},sa=({isOpen:t,onClose:a,collapsed:r})=>{var f,h,N,M;const{user:n}=Z(),s=ut(),[i,c]=u.useState(!1),[g,d]=u.useState(!1),[m,y]=u.useState(null),o=[{name:"Dashboard",href:"/dashboard",icon:yt,roles:["admin","supervisor","technician","customer_service"]},{name:"Analytics",href:"/analytics",icon:Pe,roles:["admin","supervisor"]},{name:"Performance",href:"/performance",icon:Ve,roles:["admin"]},{name:"Tickets",href:"/tickets",icon:ae,roles:["admin","supervisor","technician","customer_service"]},{name:"Customers",href:"/customers",icon:ue,roles:["admin","supervisor","customer_service"]},{name:"Registrations",href:"/registrations",icon:bt,roles:["admin","supervisor","customer_service"]},{name:"Reg Analytics",href:"/registration-analytics",icon:Pe,roles:["admin","supervisor"]},{name:"Technicians",href:"/technicians",icon:me,roles:["admin","supervisor"]},{name:"Inventory",href:"/inventory-stock",icon:Ue,roles:["admin","supervisor","technician"]},{name:"Invoices",href:"/invoices",icon:jt,roles:["admin","supervisor","customer_service"]},{name:"Payments",href:"/payments",icon:wt,roles:["admin","supervisor","customer_service"]},{name:"Master Data",icon:Nt,roles:["admin","supervisor"],hasSubmenu:!0,submenu:[{name:"Service Types",href:"/master-data/service-types"},{name:"Service Categories",href:"/master-data/service-categories"},{name:"Paket Langganan",href:"/master-data/packages"},{name:"Price List",href:"/master-data/price-list"},{name:"Equipment",href:"/master-data/equipment"},{name:"ODP",href:"/master-data/odp"}]},{name:"Notifications",icon:K,roles:["admin","supervisor"],hasSubmenu:!0,submenu:[{name:"Templates",href:"/notifications/templates"},{name:"Analytics",href:"/notifications/analytics"},{name:"Settings",href:"/notifications/settings"}]},{name:"Users",href:"/users",icon:_t,roles:["admin","supervisor"]},{name:"Permissions",href:"/permissions",icon:kt,roles:["admin"]}].filter(v=>v.roles.includes(n==null?void 0:n.role));return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-75 z-20 lg:hidden",onClick:a}),e.jsxs("div",{className:`
        fixed inset-y-0 left-0 z-30 bg-white shadow-lg transform transition-all duration-300 ease-in-out
        lg:translate-x-0 lg:static lg:inset-0
        ${t?"translate-x-0":"-translate-x-full"}
        ${r?"lg:w-20":"lg:w-64"}
        w-64
      `,children:[e.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:"/aglis-logo.svg",alt:"AGLIS Net",className:"h-8 w-auto"})}),!r&&e.jsx("div",{className:"ml-3 transition-opacity duration-300",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 whitespace-nowrap",children:"AGLIS"})})]}),e.jsx("button",{onClick:a,className:"p-2 rounded-md text-gray-500 hover:text-gray-600 hover:bg-gray-100 lg:hidden",children:e.jsx(be,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"mt-6 px-3",children:e.jsx("div",{className:"space-y-1",children:o.map(v=>{var C;const S=v.icon;if(v.hasSubmenu){const O=(C=v.submenu)==null?void 0:C.some(q=>s.pathname.startsWith(q.href)),J=v.name==="Master Data"?i:g,L=v.name==="Master Data"?c:d,V=J||O;return e.jsxs("div",{className:"relative group/submenu",children:[e.jsxs("button",{onClick:()=>!r&&L(!J),onMouseEnter:()=>y(v.name),onMouseLeave:()=>y(null),className:`
                        w-full group flex items-center justify-between px-3 py-2 text-sm font-medium rounded-lg transition-colors
                        ${O?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}
                        ${r?"justify-center":""}
                      `,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:`
                          h-5 w-5 flex-shrink-0
                          ${r?"":"mr-3"}
                          ${O?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}
                        `}),!r&&v.name]}),!r&&(V?e.jsx(He,{className:"h-4 w-4"}):e.jsx(Qe,{className:"h-4 w-4"}))]}),r&&m===v.name&&e.jsxs("div",{className:"absolute left-full ml-2 top-0 bg-gray-900 text-white text-sm px-3 py-2 rounded-lg whitespace-nowrap z-50 shadow-lg",children:[v.name,e.jsx("div",{className:"absolute left-0 top-1/2 -translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-900 rotate-45"})]}),V&&!r&&e.jsx("div",{className:"ml-8 mt-1 space-y-1",children:v.submenu.map(q=>{const B=s.pathname===q.href;return e.jsx(Se,{to:q.href,className:`
                                block px-3 py-2 text-sm rounded-lg transition-colors
                                ${B?"bg-blue-50 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                              `,onClick:a,children:q.name},q.name)})})]},v.name)}const j=s.pathname.startsWith(v.href);return e.jsxs("div",{className:"relative group/item",children:[e.jsxs(Se,{to:v.href,onMouseEnter:()=>y(v.name),onMouseLeave:()=>y(null),className:`
                      group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors
                      ${j?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}
                      ${r?"justify-center":""}
                    `,onClick:a,children:[e.jsx(S,{className:`
                      h-5 w-5 flex-shrink-0
                      ${r?"":"mr-3"}
                      ${j?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}
                    `}),!r&&v.name]}),r&&m===v.name&&e.jsxs("div",{className:"absolute left-full ml-2 top-0 bg-gray-900 text-white text-sm px-3 py-2 rounded-lg whitespace-nowrap z-50 shadow-lg",children:[v.name,e.jsx("div",{className:"absolute left-0 top-1/2 -translate-x-1 -translate-y-1/2 w-2 h-2 bg-gray-900 rotate-45"})]})]},v.name)})})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200",children:e.jsxs("div",{className:`flex items-center ${r?"justify-center":""}`,children:[e.jsxs("div",{className:"flex-shrink-0 relative group",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-600 rounded-full flex items-center justify-center cursor-pointer",children:e.jsx("span",{className:"text-white font-medium text-sm",children:(h=(f=n==null?void 0:n.full_name)==null?void 0:f.charAt(0))==null?void 0:h.toUpperCase()})}),r&&e.jsxs("div",{className:"hidden group-hover:block absolute left-full ml-2 bottom-0 bg-gray-900 text-white text-sm px-3 py-2 rounded-lg whitespace-nowrap z-50 shadow-lg min-w-max",children:[e.jsx("p",{className:"font-medium",children:n==null?void 0:n.full_name}),e.jsx("p",{className:"text-xs text-gray-300 capitalize",children:(N=n==null?void 0:n.role)==null?void 0:N.replace("_"," ")}),e.jsx("div",{className:"absolute left-0 bottom-3 -translate-x-1 w-2 h-2 bg-gray-900 rotate-45"})]})]}),!r&&e.jsxs("div",{className:"ml-3 overflow-hidden",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n==null?void 0:n.full_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize truncate",children:(M=n==null?void 0:n.role)==null?void 0:M.replace("_"," ")})]})]})})]})]})},na=(t={})=>{const a=ce(),[r,n]=u.useState(0),{data:s,isLoading:i,error:c,refetch:g}=Y(["notifications",t],()=>z.getNotifications(t),{refetchOnWindowFocus:!1,staleTime:3e4,select:o=>o.data});u.useEffect(()=>{(s==null?void 0:s.unreadCount)!==void 0&&n(s.unreadCount)},[s==null?void 0:s.unreadCount]),u.useEffect(()=>{P.isConnected||P.connect();const o=h=>{console.log("🔔 [useNotifications] New notification received:",h),a.setQueryData(["notifications",t],N=>N&&R(T({},N),{notifications:[h,...N.notifications||[]],unreadCount:(N.unreadCount||0)+1})),n(N=>N+1),(h.priority==="high"||h.priority==="urgent")&&W(h.title,{icon:"🔔",duration:5e3})},f=h=>{console.log("🔄 [useNotifications] Notification update received:",h),g()};return P.on("notification",o),P.on("notification_updated",f),()=>{P.off("notification",o),P.off("notification_updated",f)}},[a,t,g]);const d=te(o=>z.markAsRead(o),{onSuccess:(o,f)=>{a.setQueryData(["notifications",t],h=>h&&R(T({},h),{notifications:(h.notifications||[]).map(N=>N.id===f?R(T({},N),{is_read:!0,read_at:new Date().toISOString()}):N),unreadCount:Math.max(0,(h.unreadCount||0)-1)})),n(h=>Math.max(0,h-1))},onError:o=>{console.error("Failed to mark notification as read:",o),W.error("Gagal menandai notifikasi sebagai dibaca")}}),m=te(()=>z.markAllAsRead(),{onSuccess:()=>{a.setQueryData(["notifications",t],o=>o&&R(T({},o),{notifications:(o.notifications||[]).map(f=>R(T({},f),{is_read:!0,read_at:new Date().toISOString()})),unreadCount:0})),n(0),W.success("Semua notifikasi ditandai sebagai dibaca")},onError:o=>{console.error("Failed to mark all notifications as read:",o),W.error("Gagal menandai semua notifikasi sebagai dibaca")}}),y=te(o=>z.archive(o),{onSuccess:(o,f)=>{a.setQueryData(["notifications",t],h=>h&&R(T({},h),{notifications:(h.notifications||[]).filter(N=>N.id!==f),unreadCount:Math.max(0,(h.unreadCount||0)-1)})),n(h=>Math.max(0,h-1)),W.success("Notifikasi diarsipkan")},onError:o=>{console.error("Failed to archive notification:",o),W.error("Gagal mengarsipkan notifikasi")}}),l=te(o=>z.delete(o),{onSuccess:(o,f)=>{a.setQueryData(["notifications",t],h=>h&&R(T({},h),{notifications:(h.notifications||[]).filter(N=>N.id!==f),unreadCount:Math.max(0,(h.unreadCount||0)-1)})),n(h=>Math.max(0,h-1)),W.success("Notifikasi dihapus")},onError:o=>{console.error("Failed to delete notification:",o),W.error("Gagal menghapus notifikasi")}});return{notifications:(s==null?void 0:s.notifications)||[],pagination:s==null?void 0:s.pagination,unreadCount:r,isLoading:i,error:c,refetch:g,markAsRead:d.mutate,markAllAsRead:m.mutate,archive:y.mutate,delete:l.mutate,isMarkingAsRead:d.isLoading,isMarkingAllAsRead:m.isLoading,isArchiving:y.isLoading,isDeleting:l.isLoading}},ia=()=>{const t=ce(),{data:a,isLoading:r,error:n}=Y(["notification-settings"],()=>z.getSettings(),{select:i=>{var c;return(c=i.data)==null?void 0:c.settings}}),s=te(i=>z.updateSettings(i),{onSuccess:i=>{t.setQueryData(["notification-settings"],{data:{settings:i.data.settings}}),W.success("Pengaturan notifikasi berhasil diperbarui")},onError:i=>{console.error("Failed to update notification settings:",i),W.error("Gagal memperbarui pengaturan notifikasi")}});return{settings:a,isLoading:r,error:n,updateSettings:s.mutate,isUpdating:s.isLoading}},oa=()=>{const[t,a]=u.useState(0),{data:r}=Y(["notifications","unread-count"],()=>z.getNotifications({limit:1,is_read:!1}),{refetchInterval:3e4,select:n=>{var s;return((s=n.data)==null?void 0:s.unreadCount)||0}});return u.useEffect(()=>{r!==void 0&&a(r)},[r]),u.useEffect(()=>{P.isConnected||P.connect();const n=()=>{a(i=>i+1)},s=()=>{a(r||0)};return P.on("notification",n),P.on("notification_updated",s),()=>{P.off("notification",n),P.off("notification_updated",s)}},[r]),t};function fe(t){"@babel/helpers - typeof";return fe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},fe(t)}function H(t,a){if(a.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+a.length+" present")}function $(t){H(1,arguments);var a=Object.prototype.toString.call(t);return t instanceof Date||fe(t)==="object"&&a==="[object Date]"?new Date(t.getTime()):typeof t=="number"||a==="[object Number]"?new Date(t):((typeof t=="string"||a==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var ca={};function la(){return ca}function Me(t){var a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),t.getTime()-a.getTime()}function oe(t,a){H(2,arguments);var r=$(t),n=$(a),s=r.getTime()-n.getTime();return s<0?-1:s>0?1:s}function da(t,a){H(2,arguments);var r=$(t),n=$(a),s=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return s*12+i}function ua(t,a){return H(2,arguments),$(t).getTime()-$(a).getTime()}var ma={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(a){return a<0?Math.ceil(a):Math.floor(a)}},ha="trunc";function fa(t){return ma[ha]}function pa(t){H(1,arguments);var a=$(t);return a.setHours(23,59,59,999),a}function ga(t){H(1,arguments);var a=$(t),r=a.getMonth();return a.setFullYear(a.getFullYear(),r+1,0),a.setHours(23,59,59,999),a}function xa(t){H(1,arguments);var a=$(t);return pa(a).getTime()===ga(a).getTime()}function va(t,a){H(2,arguments);var r=$(t),n=$(a),s=oe(r,n),i=Math.abs(da(r,n)),c;if(i<1)c=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-s*i);var g=oe(r,n)===-s;xa($(t))&&i===1&&oe(t,n)===1&&(g=!1),c=s*(i-Number(g))}return c===0?0:c}function ya(t,a,r){H(2,arguments);var n=ua(t,a)/1e3;return fa()(n)}var ba={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ja=function(a,r,n){var s,i=ba[a];return typeof i=="string"?s=i:r===1?s=i.one:s=i.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function ee(t){return function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=a.width?String(a.width):t.defaultWidth,n=t.formats[r]||t.formats[t.defaultWidth];return n}}var wa={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Na={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},_a={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},ka={date:ee({formats:wa,defaultWidth:"full"}),time:ee({formats:Na,defaultWidth:"full"}),dateTime:ee({formats:_a,defaultWidth:"full"})},Sa={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Pa=function(a,r,n,s){return Sa[a]};function Q(t){return function(a,r){var n=r!=null&&r.context?String(r.context):"standalone",s;if(n==="formatting"&&t.formattingValues){var i=t.defaultFormattingWidth||t.defaultWidth,c=r!=null&&r.width?String(r.width):i;s=t.formattingValues[c]||t.formattingValues[i]}else{var g=t.defaultWidth,d=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[d]||t.values[g]}var m=t.argumentCallback?t.argumentCallback(a):a;return s[m]}}var Ta={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Ca={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Aa={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ea={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ra={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ma={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Oa=function(a,r){var n=Number(a),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},Da={ordinalNumber:Oa,era:Q({values:Ta,defaultWidth:"wide"}),quarter:Q({values:Ca,defaultWidth:"wide",argumentCallback:function(a){return a-1}}),month:Q({values:Aa,defaultWidth:"wide"}),day:Q({values:Ea,defaultWidth:"wide"}),dayPeriod:Q({values:Ra,defaultWidth:"wide",formattingValues:Ma,defaultFormattingWidth:"wide"})};function X(t){return function(a){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=a.match(s);if(!i)return null;var c=i[0],g=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(g)?Ia(g,function(l){return l.test(c)}):La(g,function(l){return l.test(c)}),m;m=t.valueCallback?t.valueCallback(d):d,m=r.valueCallback?r.valueCallback(m):m;var y=a.slice(c.length);return{value:m,rest:y}}}function La(t,a){for(var r in t)if(t.hasOwnProperty(r)&&a(t[r]))return r}function Ia(t,a){for(var r=0;r<t.length;r++)if(a(t[r]))return r}function Ke(t){return function(a){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=a.match(t.matchPattern);if(!n)return null;var s=n[0],i=a.match(t.parsePattern);if(!i)return null;var c=t.valueCallback?t.valueCallback(i[0]):i[0];c=r.valueCallback?r.valueCallback(c):c;var g=a.slice(s.length);return{value:c,rest:g}}}var $a=/^(\d+)(th|st|nd|rd)?/i,Fa=/\d+/i,Wa={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},za={any:[/^b/i,/^(a|c)/i]},qa={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Va={any:[/1/i,/2/i,/3/i,/4/i]},Ua={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ha={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Qa={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Xa={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ja={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ka={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Ba={ordinalNumber:Ke({matchPattern:$a,parsePattern:Fa,valueCallback:function(a){return parseInt(a,10)}}),era:X({matchPatterns:Wa,defaultMatchWidth:"wide",parsePatterns:za,defaultParseWidth:"any"}),quarter:X({matchPatterns:qa,defaultMatchWidth:"wide",parsePatterns:Va,defaultParseWidth:"any",valueCallback:function(a){return a+1}}),month:X({matchPatterns:Ua,defaultMatchWidth:"wide",parsePatterns:Ha,defaultParseWidth:"any"}),day:X({matchPatterns:Qa,defaultMatchWidth:"wide",parsePatterns:Xa,defaultParseWidth:"any"}),dayPeriod:X({matchPatterns:Ja,defaultMatchWidth:"any",parsePatterns:Ka,defaultParseWidth:"any"})},Ya={code:"en-US",formatDistance:ja,formatLong:ka,formatRelative:Pa,localize:Da,match:Ba,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Be(t,a){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r]);return t}function Ga(t){return Be({},t)}var Oe=1440,Za=2520,de=43200,er=86400;function tr(t,a,r){var n,s;H(2,arguments);var i=la(),c=(n=(s=r==null?void 0:r.locale)!==null&&s!==void 0?s:i.locale)!==null&&n!==void 0?n:Ya;if(!c.formatDistance)throw new RangeError("locale must contain formatDistance property");var g=oe(t,a);if(isNaN(g))throw new RangeError("Invalid time value");var d=Be(Ga(r),{addSuffix:!!(r!=null&&r.addSuffix),comparison:g}),m,y;g>0?(m=$(a),y=$(t)):(m=$(t),y=$(a));var l=ya(y,m),o=(Me(y)-Me(m))/1e3,f=Math.round((l-o)/60),h;if(f<2)return r!=null&&r.includeSeconds?l<5?c.formatDistance("lessThanXSeconds",5,d):l<10?c.formatDistance("lessThanXSeconds",10,d):l<20?c.formatDistance("lessThanXSeconds",20,d):l<40?c.formatDistance("halfAMinute",0,d):l<60?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",1,d):f===0?c.formatDistance("lessThanXMinutes",1,d):c.formatDistance("xMinutes",f,d);if(f<45)return c.formatDistance("xMinutes",f,d);if(f<90)return c.formatDistance("aboutXHours",1,d);if(f<Oe){var N=Math.round(f/60);return c.formatDistance("aboutXHours",N,d)}else{if(f<Za)return c.formatDistance("xDays",1,d);if(f<de){var M=Math.round(f/Oe);return c.formatDistance("xDays",M,d)}else if(f<er)return h=Math.round(f/de),c.formatDistance("aboutXMonths",h,d)}if(h=va(y,m),h<12){var v=Math.round(f/de);return c.formatDistance("xMonths",v,d)}else{var S=h%12,j=Math.floor(h/12);return S<3?c.formatDistance("aboutXYears",j,d):S<9?c.formatDistance("overXYears",j,d):c.formatDistance("almostXYears",j+1,d)}}function Ye(t,a){return H(1,arguments),tr(t,Date.now(),a)}var ar={lessThanXSeconds:{one:"kurang dari 1 detik",other:"kurang dari {{count}} detik"},xSeconds:{one:"1 detik",other:"{{count}} detik"},halfAMinute:"setengah menit",lessThanXMinutes:{one:"kurang dari 1 menit",other:"kurang dari {{count}} menit"},xMinutes:{one:"1 menit",other:"{{count}} menit"},aboutXHours:{one:"sekitar 1 jam",other:"sekitar {{count}} jam"},xHours:{one:"1 jam",other:"{{count}} jam"},xDays:{one:"1 hari",other:"{{count}} hari"},aboutXWeeks:{one:"sekitar 1 minggu",other:"sekitar {{count}} minggu"},xWeeks:{one:"1 minggu",other:"{{count}} minggu"},aboutXMonths:{one:"sekitar 1 bulan",other:"sekitar {{count}} bulan"},xMonths:{one:"1 bulan",other:"{{count}} bulan"},aboutXYears:{one:"sekitar 1 tahun",other:"sekitar {{count}} tahun"},xYears:{one:"1 tahun",other:"{{count}} tahun"},overXYears:{one:"lebih dari 1 tahun",other:"lebih dari {{count}} tahun"},almostXYears:{one:"hampir 1 tahun",other:"hampir {{count}} tahun"}},rr=function(a,r,n){var s,i=ar[a];return typeof i=="string"?s=i:r===1?s=i.one:s=i.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"dalam waktu "+s:s+" yang lalu":s},sr={full:"EEEE, d MMMM yyyy",long:"d MMMM yyyy",medium:"d MMM yyyy",short:"d/M/yyyy"},nr={full:"HH.mm.ss",long:"HH.mm.ss",medium:"HH.mm",short:"HH.mm"},ir={full:"{{date}} 'pukul' {{time}}",long:"{{date}} 'pukul' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},or={date:ee({formats:sr,defaultWidth:"full"}),time:ee({formats:nr,defaultWidth:"full"}),dateTime:ee({formats:ir,defaultWidth:"full"})},cr={lastWeek:"eeee 'lalu pukul' p",yesterday:"'Kemarin pukul' p",today:"'Hari ini pukul' p",tomorrow:"'Besok pukul' p",nextWeek:"eeee 'pukul' p",other:"P"},lr=function(a,r,n,s){return cr[a]},dr={narrow:["SM","M"],abbreviated:["SM","M"],wide:["Sebelum Masehi","Masehi"]},ur={narrow:["1","2","3","4"],abbreviated:["K1","K2","K3","K4"],wide:["Kuartal ke-1","Kuartal ke-2","Kuartal ke-3","Kuartal ke-4"]},mr={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"],wide:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]},hr={narrow:["M","S","S","R","K","J","S"],short:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],abbreviated:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],wide:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},fr={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},pr={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},gr=function(a,r){var n=Number(a);return"ke-"+n},xr={ordinalNumber:gr,era:Q({values:dr,defaultWidth:"wide"}),quarter:Q({values:ur,defaultWidth:"wide",argumentCallback:function(a){return a-1}}),month:Q({values:mr,defaultWidth:"wide"}),day:Q({values:hr,defaultWidth:"wide"}),dayPeriod:Q({values:fr,defaultWidth:"wide",formattingValues:pr,defaultFormattingWidth:"wide"})},vr=/^ke-(\d+)?/i,yr=/\d+/i,br={narrow:/^(sm|m)/i,abbreviated:/^(s\.?\s?m\.?|s\.?\s?e\.?\s?u\.?|m\.?|e\.?\s?u\.?)/i,wide:/^(sebelum masehi|sebelum era umum|masehi|era umum)/i},jr={any:[/^s/i,/^(m|e)/i]},wr={narrow:/^[1234]/i,abbreviated:/^K-?\s[1234]/i,wide:/^Kuartal ke-?\s?[1234]/i},Nr={any:[/1/i,/2/i,/3/i,/4/i]},_r={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|mei|jun|jul|agt|sep|okt|nov|des)/i,wide:/^(januari|februari|maret|april|mei|juni|juli|agustus|september|oktober|november|desember)/i},kr={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^ma/i,/^ap/i,/^me/i,/^jun/i,/^jul/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},Sr={narrow:/^[srkjm]/i,short:/^(min|sen|sel|rab|kam|jum|sab)/i,abbreviated:/^(min|sen|sel|rab|kam|jum|sab)/i,wide:/^(minggu|senin|selasa|rabu|kamis|jumat|sabtu)/i},Pr={narrow:[/^m/i,/^s/i,/^s/i,/^r/i,/^k/i,/^j/i,/^s/i],any:[/^m/i,/^sen/i,/^sel/i,/^r/i,/^k/i,/^j/i,/^sa/i]},Tr={narrow:/^(a|p|tengah m|tengah h|(di(\swaktu)?) (pagi|siang|sore|malam))/i,any:/^([ap]\.?\s?m\.?|tengah malam|tengah hari|(di(\swaktu)?) (pagi|siang|sore|malam))/i},Cr={any:{am:/^a/i,pm:/^pm/i,midnight:/^tengah m/i,noon:/^tengah h/i,morning:/pagi/i,afternoon:/siang/i,evening:/sore/i,night:/malam/i}},Ar={ordinalNumber:Ke({matchPattern:vr,parsePattern:yr,valueCallback:function(a){return parseInt(a,10)}}),era:X({matchPatterns:br,defaultMatchWidth:"wide",parsePatterns:jr,defaultParseWidth:"any"}),quarter:X({matchPatterns:wr,defaultMatchWidth:"wide",parsePatterns:Nr,defaultParseWidth:"any",valueCallback:function(a){return a+1}}),month:X({matchPatterns:_r,defaultMatchWidth:"wide",parsePatterns:kr,defaultParseWidth:"any"}),day:X({matchPatterns:Sr,defaultMatchWidth:"wide",parsePatterns:Pr,defaultParseWidth:"any"}),dayPeriod:X({matchPatterns:Tr,defaultMatchWidth:"any",parsePatterns:Cr,defaultParseWidth:"any"})},Ge={code:"id",formatDistance:rr,formatLong:or,formatRelative:lr,localize:xr,match:Ar,options:{weekStartsOn:1,firstWeekContainsDate:1}};const Er=({isOpen:t,onClose:a})=>{const[r,n]=u.useState("all"),[s,i]=u.useState(new Set),[c,g]=u.useState(!1),[d,m]=u.useState({type:"",priority:"",is_read:void 0}),{notifications:y,pagination:l,unreadCount:o,isLoading:f,markAsRead:h,markAllAsRead:N,archive:M,delete:v,isMarkingAllAsRead:S}=na({type:d.type||void 0,priority:d.priority||void 0,is_read:d.is_read});u.useEffect(()=>{const x=A=>{A.key==="Escape"&&a()};if(t)return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[t,a]);const j=y.filter(x=>{switch(r){case"unread":return!x.is_read;case"archived":return x.is_archived;case"high":return x.priority==="high"||x.priority==="urgent";default:return!x.is_archived}}),C=x=>{switch(x){case"urgent":return e.jsx(Te,{className:"h-4 w-4 text-red-500"});case"high":return e.jsx(Ct,{className:"h-4 w-4 text-orange-500"});case"normal":return e.jsx(Ce,{className:"h-4 w-4 text-blue-500"});case"low":return e.jsx(re,{className:"h-4 w-4 text-green-500"});default:return e.jsx(Ce,{className:"h-4 w-4 text-gray-500"})}},O=x=>{switch(x){case"ticket_assigned":case"ticket_updated":case"ticket_completed":return e.jsx(re,{className:"h-5 w-5 text-blue-600"});case"system_alert":return e.jsx(Te,{className:"h-5 w-5 text-red-600"});case"technician_status":return e.jsx(Ve,{className:"h-5 w-5 text-yellow-600"});case"new_ticket":return e.jsx(K,{className:"h-5 w-5 text-green-600"});default:return e.jsx(K,{className:"h-5 w-5 text-gray-600"})}},J=x=>({ticket_assigned:"Tiket Ditugaskan",ticket_updated:"Tiket Diperbarui",ticket_completed:"Tiket Selesai",system_alert:"Peringatan Sistem",technician_status:"Status Teknisi",new_ticket:"Tiket Baru"})[x]||x,L=x=>{const A=new Set(s);A.has(x)?A.delete(x):A.add(x),i(A)},V=()=>{s.size===j.length?i(new Set):i(new Set(j.map(x=>x.id)))},q=x=>{s.forEach(A=>{switch(x){case"mark-read":h(A);break;case"archive":M(A);break;case"delete":v(A);break}}),i(new Set)},B=[{id:"all",label:"Semua",count:y.length},{id:"unread",label:"Belum Dibaca",count:o},{id:"high",label:"Prioritas Tinggi",count:y.filter(x=>x.priority==="high"||x.priority==="urgent").length},{id:"archived",label:"Diarsipkan",count:y.filter(x=>x.is_archived).length}];return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl transform transition-transform",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"h-6 w-6 text-blue-600"}),o>0&&e.jsx("span",{className:"absolute -top-2 -right-2 h-5 w-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:o>99?"99+":o})]}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Notifikasi"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>g(!c),className:`p-2 rounded-lg transition-colors ${c?"bg-blue-100 text-blue-600":"text-gray-500 hover:bg-gray-100"}`,children:e.jsx(St,{className:"h-4 w-4"})}),e.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(be,{className:"h-4 w-4"})})]})]}),c&&e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("select",{value:d.type,onChange:x=>m(A=>R(T({},A),{type:x.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Semua Tipe"}),e.jsx("option",{value:"ticket_assigned",children:"Tiket Ditugaskan"}),e.jsx("option",{value:"ticket_updated",children:"Tiket Diperbarui"}),e.jsx("option",{value:"ticket_completed",children:"Tiket Selesai"}),e.jsx("option",{value:"system_alert",children:"Peringatan Sistem"}),e.jsx("option",{value:"technician_status",children:"Status Teknisi"}),e.jsx("option",{value:"new_ticket",children:"Tiket Baru"})]}),e.jsxs("select",{value:d.priority,onChange:x=>m(A=>R(T({},A),{priority:x.target.value})),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Semua Prioritas"}),e.jsx("option",{value:"urgent",children:"Urgent"}),e.jsx("option",{value:"high",children:"Tinggi"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"low",children:"Rendah"})]}),e.jsxs("select",{value:d.is_read===void 0?"":d.is_read.toString(),onChange:x=>m(A=>R(T({},A),{is_read:x.target.value===""?void 0:x.target.value==="true"})),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"false",children:"Belum Dibaca"}),e.jsx("option",{value:"true",children:"Sudah Dibaca"})]}),e.jsx("button",{onClick:()=>m({type:"",priority:"",is_read:void 0}),className:"px-3 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset"})]})}),e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:V,className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:s.size===j.length?"Batal Pilih":"Pilih Semua"}),s.size>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>q("mark-read"),className:"text-sm text-green-600 hover:text-green-800 font-medium",children:"Tandai Dibaca"}),e.jsx("button",{onClick:()=>q("archive"),className:"text-sm text-orange-600 hover:text-orange-800 font-medium",children:"Arsipkan"}),e.jsx("button",{onClick:()=>q("delete"),className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Hapus"})]})]}),o>0&&e.jsxs("button",{onClick:N,disabled:S,className:"flex items-center space-x-1 px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[e.jsx(Pt,{className:"h-4 w-4"}),e.jsx("span",{children:"Tandai Semua Dibaca"})]})]})}),e.jsx("div",{className:"flex border-b border-gray-200",children:B.map(x=>e.jsxs("button",{onClick:()=>n(x.id),className:`flex-1 px-4 py-3 text-sm font-medium transition-colors ${r===x.id?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[x.label,x.count>0&&e.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${r===x.id?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:x.count})]},x.id))}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:f?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):j.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx(K,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Tidak ada notifikasi"}),e.jsx("p",{className:"text-sm text-center",children:r==="unread"?"Semua notifikasi sudah dibaca":"Belum ada notifikasi yang tersedia"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:j.map(x=>e.jsx("div",{className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${x.is_read?"":"bg-blue-50"}`,onClick:()=>{x.is_read||h(x.id)},children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("input",{type:"checkbox",checked:s.has(x.id),onChange:A=>{A.stopPropagation(),L(x.id)},className:"mt-1 h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[O(x.type),e.jsx("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:J(x.type)}),C(x.priority)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:Ye(new Date(x.created_at),{addSuffix:!0,locale:Ge})}),e.jsxs("div",{className:"flex items-center space-x-1",children:[!x.is_read&&e.jsx("div",{className:"h-2 w-2 bg-blue-600 rounded-full"}),e.jsx("button",{onClick:A=>{A.stopPropagation(),M(x.id)},className:"p-1 text-gray-400 hover:text-orange-600 transition-colors",title:"Arsipkan",children:e.jsx(Tt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:A=>{A.stopPropagation(),v(x.id)},className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Hapus",children:e.jsx(Xe,{className:"h-4 w-4"})})]})]})]}),e.jsx("h3",{className:`mt-2 text-sm font-medium ${x.is_read?"text-gray-700":"text-gray-900"}`,children:x.title}),e.jsx("p",{className:`mt-1 text-sm ${x.is_read?"text-gray-500":"text-gray-700"}`,children:x.message}),x.data&&e.jsx("div",{className:"mt-2 text-xs text-gray-500",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:JSON.stringify(x.data,null,2)})})]})]})},x.id))})}),l&&e.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:["Menampilkan ",j.length," dari ",l.total," notifikasi"]}),l.hasNext&&e.jsx("button",{className:"text-blue-600 hover:text-blue-800 font-medium",children:"Lihat Lebih Banyak"})]})})]})]}):null},Rr=({className:t=""})=>{const[a,r]=u.useState(!1),n=oa();return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>r(!0),className:`relative p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors ${t}`,title:"Notifikasi",children:[e.jsx(K,{className:"h-5 w-5"}),n>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-medium animate-pulse",children:n>99?"99+":n}),n>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 rounded-full animate-ping opacity-75"})]}),e.jsx(Er,{isOpen:a,onClose:()=>r(!1)})]})},Mr=({isOpen:t,onClose:a})=>{const{settings:r,updateSettings:n,isUpdating:s}=ia(),[i,c]=u.useState({email_notifications:!0,push_notifications:!0,sound_notifications:!0,notification_types:{ticket_assigned:!0,ticket_updated:!0,ticket_completed:!0,system_alert:!0,technician_status:!0,new_ticket:!0},quiet_hours_start:"",quiet_hours_end:""});ze.useEffect(()=>{var l,o,f;r&&c({email_notifications:(l=r.email_notifications)!=null?l:!0,push_notifications:(o=r.push_notifications)!=null?o:!0,sound_notifications:(f=r.sound_notifications)!=null?f:!0,notification_types:r.notification_types||{ticket_assigned:!0,ticket_updated:!0,ticket_completed:!0,system_alert:!0,technician_status:!0,new_ticket:!0},quiet_hours_start:r.quiet_hours_start||"",quiet_hours_end:r.quiet_hours_end||""})},[r]);const g=l=>{l.preventDefault(),n(i)},d=(l,o)=>{c(f=>R(T({},f),{notification_types:R(T({},f.notification_types),{[l]:o})}))},m=()=>{i.quiet_hours_start&&i.quiet_hours_end?c(l=>R(T({},l),{quiet_hours_start:"",quiet_hours_end:""})):c(l=>R(T({},l),{quiet_hours_start:"22:00",quiet_hours_end:"07:00"}))},y={ticket_assigned:"Tiket Ditugaskan",ticket_updated:"Tiket Diperbarui",ticket_completed:"Tiket Selesai",system_alert:"Peringatan Sistem",technician_status:"Status Teknisi",new_ticket:"Tiket Baru"};return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl transform transition-transform",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(je,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Pengaturan Notifikasi"})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(be,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(K,{className:"h-5 w-5 mr-2 text-blue-600"}),"Pengaturan Umum"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(At,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Email Notifikasi"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Terima notifikasi via email"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.email_notifications,onChange:l=>c(o=>R(T({},o),{email_notifications:l.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(K,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Push Notifikasi"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Terima notifikasi push di browser"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.push_notifications,onChange:l=>c(o=>R(T({},o),{push_notifications:l.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Et,{className:"h-5 w-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Suara Notifikasi"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Mainkan suara saat ada notifikasi"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.sound_notifications,onChange:l=>c(o=>R(T({},o),{sound_notifications:l.target.checked})),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(Rt,{className:"h-5 w-5 mr-2 text-blue-600"}),"Tipe Notifikasi"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(y).map(([l,o])=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-900",children:o}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.notification_types[l],onChange:f=>d(l,f.target.checked),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]},l))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[e.jsx(Mt,{className:"h-5 w-5 mr-2 text-blue-600"}),"Jam Tenang"]}),e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Nonaktifkan Notifikasi"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Jangan tampilkan notifikasi pada jam tertentu"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:!!(i.quiet_hours_start&&i.quiet_hours_end),onChange:m,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),i.quiet_hours_start&&i.quiet_hours_end&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dari"}),e.jsx("input",{type:"time",value:i.quiet_hours_start,onChange:l=>c(o=>R(T({},o),{quiet_hours_start:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sampai"}),e.jsx("input",{type:"time",value:i.quiet_hours_end,onChange:l=>c(o=>R(T({},o),{quiet_hours_end:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:s,className:"flex-1 px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:s?"Menyimpan...":"Simpan"})]})]})})]})]}):null},De={createSample:()=>_(void 0,null,function*(){return E.post("/test-notifications/create-sample")}),clearAll:()=>_(void 0,null,function*(){return E.delete("/test-notifications/clear-all")})},Or=({isOpen:t,onClose:a})=>{const[r,n]=u.useState(!1),[s,i]=u.useState(!1),c=()=>_(void 0,null,function*(){try{n(!0);const d=yield De.createSample();W.success(`Created ${d.data.notifications.length} sample notifications`)}catch(d){console.error("Failed to create sample notifications:",d),W.error("Failed to create sample notifications")}finally{n(!1)}}),g=()=>_(void 0,null,function*(){try{i(!0),yield De.clearAll(),W.success("All notifications cleared")}catch(d){console.error("Failed to clear notifications:",d),W.error("Failed to clear notifications")}finally{i(!1)}});return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),e.jsxs("div",{className:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white rounded-xl shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(je,{className:"h-6 w-6 text-blue-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Test Notifications"})]}),e.jsx("button",{onClick:a,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors",children:"×"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-6",children:"Gunakan panel ini untuk membuat notifikasi sample untuk testing Notification Center."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:c,disabled:r,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Ot,{className:"h-5 w-5"}),e.jsx("span",{children:r?"Creating...":"Create Sample Notifications"})]}),e.jsxs("button",{onClick:g,disabled:s,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(Xe,{className:"h-5 w-5"}),e.jsx("span",{children:s?"Clearing...":"Clear All Notifications"})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Sample notifications include:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Ticket assigned notification"}),e.jsx("li",{children:"• Ticket status update"}),e.jsx("li",{children:"• System alert (urgent priority)"}),e.jsx("li",{children:"• Technician status update"}),e.jsx("li",{children:"• New ticket created"}),e.jsx("li",{children:"• Ticket completed"})]})]})]})]})]}):null},Dr=({onMenuClick:t})=>{var l,o;const{user:a,logout:r}=Z(),[n,s]=u.useState(!1),[i,c]=u.useState(!1),[g,d]=u.useState(!1),m=u.useRef(null);u.useEffect(()=>{const f=h=>{m.current&&!m.current.contains(h.target)&&s(!1)};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[]);const y=()=>{r(),s(!1)};return e.jsxs("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40",children:[e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:t,className:"p-2 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 lg:hidden transition-colors",children:e.jsx(Dt,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:"/aglis-logo.svg",alt:"AGLIS Net",className:"h-9 w-auto"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 hidden sm:block",children:"AGLIS Management System"}),e.jsx("h1",{className:"text-lg font-semibold text-gray-900 sm:hidden",children:"AGLIS"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[e.jsx(Rr,{}),e.jsxs("div",{className:"relative",ref:m,children:[e.jsxs("button",{onClick:()=>s(!n),className:"flex items-center space-x-2 p-2 rounded-lg text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors",children:[e.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-600 to-blue-700 rounded-full flex items-center justify-center shadow-sm",children:e.jsx(Lt,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"hidden lg:block text-left min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a==null?void 0:a.full_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize truncate",children:(l=a==null?void 0:a.role)==null?void 0:l.replace("_"," ")})]}),e.jsx(He,{className:`h-4 w-4 text-gray-400 transition-transform duration-200 ${n?"rotate-180":""}`})]}),n&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl py-2 z-[9999] border border-gray-200 ring-1 ring-black ring-opacity-5",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a==null?void 0:a.full_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize truncate",children:(o=a==null?void 0:a.role)==null?void 0:o.replace("_"," ")})]}),e.jsxs("div",{className:"py-1",children:[e.jsxs(mt,{to:"/profile",className:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>s(!1),children:[e.jsx(je,{className:"h-4 w-4 mr-3 text-gray-400"}),"Profile Settings"]}),e.jsxs("button",{onClick:()=>{c(!0),s(!1)},className:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:[e.jsx(K,{className:"h-4 w-4 mr-3 text-gray-400"}),"Notification Settings"]}),(a==null?void 0:a.role)==="admin"&&e.jsxs("button",{onClick:()=>{d(!0),s(!1)},className:"flex items-center w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors",children:[e.jsx(It,{className:"h-4 w-4 mr-3 text-gray-400"}),"Test Notifications"]}),e.jsxs("button",{onClick:y,className:"flex items-center w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(Ae,{className:"h-4 w-4 mr-3 text-red-500"}),"Sign Out"]})]})]})]}),e.jsx("button",{onClick:y,className:"lg:hidden p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors",title:"Sign Out",children:e.jsx(Ae,{className:"h-4 w-4"})})]})]})}),e.jsx(Mr,{isOpen:i,onClose:()=>c(!1)}),e.jsx(Or,{isOpen:g,onClose:()=>d(!1)})]})},Lr=()=>{const[t,a]=u.useState(!1),[r,n]=u.useState(()=>localStorage.getItem("sidebarCollapsed")==="true");return u.useEffect(()=>{localStorage.setItem("sidebarCollapsed",r)},[r]),e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[e.jsx(sa,{isOpen:t,onClose:()=>a(!1),collapsed:r}),e.jsx("button",{onClick:()=>n(!r),className:`
          hidden lg:flex items-center justify-center
          fixed top-20 z-50
          w-6 h-12 bg-white border border-gray-200 
          rounded-r-lg shadow-md
          text-gray-600 hover:text-blue-600 hover:bg-blue-50
          transition-all duration-300
          group
          ${r?"left-20":"left-64"}
        `,title:r?"Expand Sidebar":"Collapse Sidebar",children:r?e.jsx(Qe,{className:"h-4 w-4 group-hover:scale-125 transition-transform"}):e.jsx($t,{className:"h-4 w-4 group-hover:scale-125 transition-transform"})}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Dr,{onMenuClick:()=>a(!0)}),e.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(ht,{})})})]})]})};var Ze={exports:{}},Ir="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",$r=Ir,Fr=$r;function et(){}function tt(){}tt.resetWarningCache=et;var Wr=function(){function t(n,s,i,c,g,d){if(d!==Fr){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}t.isRequired=t;function a(){return t}var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:a,element:t,elementType:t,instanceOf:a,node:t,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:tt,resetWarningCache:et};return r.PropTypes=r,r};Ze.exports=Wr();var zr=Ze.exports;const F=qe(zr);var qr=["sitekey","onChange","theme","type","tabindex","onExpired","onErrored","size","stoken","grecaptcha","badge","hl","isolated"];function pe(){return pe=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pe.apply(this,arguments)}function Vr(t,a){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(a.indexOf(s)>=0)&&(r[s]=t[s]);return r}function ie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ur(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,ge(t,a)}function ge(t,a){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},ge(t,a)}var le=function(t){Ur(a,t);function a(){var n;return n=t.call(this)||this,n.handleExpired=n.handleExpired.bind(ie(n)),n.handleErrored=n.handleErrored.bind(ie(n)),n.handleChange=n.handleChange.bind(ie(n)),n.handleRecaptchaRef=n.handleRecaptchaRef.bind(ie(n)),n}var r=a.prototype;return r.getCaptchaFunction=function(s){return this.props.grecaptcha?this.props.grecaptcha.enterprise?this.props.grecaptcha.enterprise[s]:this.props.grecaptcha[s]:null},r.getValue=function(){var s=this.getCaptchaFunction("getResponse");return s&&this._widgetId!==void 0?s(this._widgetId):null},r.getWidgetId=function(){return this.props.grecaptcha&&this._widgetId!==void 0?this._widgetId:null},r.execute=function(){var s=this.getCaptchaFunction("execute");if(s&&this._widgetId!==void 0)return s(this._widgetId);this._executeRequested=!0},r.executeAsync=function(){var s=this;return new Promise(function(i,c){s.executionResolve=i,s.executionReject=c,s.execute()})},r.reset=function(){var s=this.getCaptchaFunction("reset");s&&this._widgetId!==void 0&&s(this._widgetId)},r.forceReset=function(){var s=this.getCaptchaFunction("reset");s&&s()},r.handleExpired=function(){this.props.onExpired?this.props.onExpired():this.handleChange(null)},r.handleErrored=function(){this.props.onErrored&&this.props.onErrored(),this.executionReject&&(this.executionReject(),delete this.executionResolve,delete this.executionReject)},r.handleChange=function(s){this.props.onChange&&this.props.onChange(s),this.executionResolve&&(this.executionResolve(s),delete this.executionReject,delete this.executionResolve)},r.explicitRender=function(){var s=this.getCaptchaFunction("render");if(s&&this._widgetId===void 0){var i=document.createElement("div");this._widgetId=s(i,{sitekey:this.props.sitekey,callback:this.handleChange,theme:this.props.theme,type:this.props.type,tabindex:this.props.tabindex,"expired-callback":this.handleExpired,"error-callback":this.handleErrored,size:this.props.size,stoken:this.props.stoken,hl:this.props.hl,badge:this.props.badge,isolated:this.props.isolated}),this.captcha.appendChild(i)}this._executeRequested&&this.props.grecaptcha&&this._widgetId!==void 0&&(this._executeRequested=!1,this.execute())},r.componentDidMount=function(){this.explicitRender()},r.componentDidUpdate=function(){this.explicitRender()},r.handleRecaptchaRef=function(s){this.captcha=s},r.render=function(){var s=this.props;s.sitekey,s.onChange,s.theme,s.type,s.tabindex,s.onExpired,s.onErrored,s.size,s.stoken,s.grecaptcha,s.badge,s.hl,s.isolated;var i=Vr(s,qr);return u.createElement("div",pe({},i,{ref:this.handleRecaptchaRef}))},a}(u.Component);le.displayName="ReCAPTCHA";le.propTypes={sitekey:F.string.isRequired,onChange:F.func,grecaptcha:F.object,theme:F.oneOf(["dark","light"]),type:F.oneOf(["image","audio"]),tabindex:F.number,onExpired:F.func,onErrored:F.func,size:F.oneOf(["compact","normal","invisible"]),stoken:F.string,hl:F.string,badge:F.oneOf(["bottomright","bottomleft","inline"]),isolated:F.bool};le.defaultProps={onChange:function(){},theme:"light",type:"image",tabindex:0,size:"normal",badge:"bottomright"};var we=Kt,Hr={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Qr={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Xr={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},at={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Ne={};Ne[we.ForwardRef]=Xr;Ne[we.Memo]=at;function Le(t){return we.isMemo(t)?at:Ne[t.$$typeof]||Hr}var Jr=Object.defineProperty,Kr=Object.getOwnPropertyNames,Ie=Object.getOwnPropertySymbols,Br=Object.getOwnPropertyDescriptor,Yr=Object.getPrototypeOf,$e=Object.prototype;function rt(t,a,r){if(typeof a!="string"){if($e){var n=Yr(a);n&&n!==$e&&rt(t,n,r)}var s=Kr(a);Ie&&(s=s.concat(Ie(a)));for(var i=Le(t),c=Le(a),g=0;g<s.length;++g){var d=s[g];if(!Qr[d]&&!(r&&r[d])&&!(c&&c[d])&&!(i&&i[d])){var m=Br(a,d);try{Jr(t,d,m)}catch(y){}}}}return t}var Gr=rt;const Zr=qe(Gr);function xe(){return xe=Object.assign||function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xe.apply(this,arguments)}function es(t,a){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(a.indexOf(s)>=0)&&(r[s]=t[s]);return r}function ts(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a}var U={},as=0;function rs(t,a){return a=a||{},function(n){var s=n.displayName||n.name||"Component",i=function(g){ts(d,g);function d(y,l){var o;return o=g.call(this,y,l)||this,o.state={},o.__scriptURL="",o}var m=d.prototype;return m.asyncScriptLoaderGetScriptLoaderID=function(){return this.__scriptLoaderID||(this.__scriptLoaderID="async-script-loader-"+as++),this.__scriptLoaderID},m.setupScriptURL=function(){return this.__scriptURL=typeof t=="function"?t():t,this.__scriptURL},m.asyncScriptLoaderHandleLoad=function(l){var o=this;this.setState(l,function(){return o.props.asyncScriptOnLoad&&o.props.asyncScriptOnLoad(o.state)})},m.asyncScriptLoaderTriggerOnScriptLoaded=function(){var l=U[this.__scriptURL];if(!l||!l.loaded)throw new Error("Script is not loaded.");for(var o in l.observers)l.observers[o](l);delete window[a.callbackName]},m.componentDidMount=function(){var l=this,o=this.setupScriptURL(),f=this.asyncScriptLoaderGetScriptLoaderID(),h=a,N=h.globalName,M=h.callbackName,v=h.scriptId;if(N&&typeof window[N]!="undefined"&&(U[o]={loaded:!0,observers:{}}),U[o]){var S=U[o];if(S&&(S.loaded||S.errored)){this.asyncScriptLoaderHandleLoad(S);return}S.observers[f]=function(L){return l.asyncScriptLoaderHandleLoad(L)};return}var j={};j[f]=function(L){return l.asyncScriptLoaderHandleLoad(L)},U[o]={loaded:!1,observers:j};var C=document.createElement("script");C.src=o,C.async=!0;for(var O in a.attributes)C.setAttribute(O,a.attributes[O]);v&&(C.id=v);var J=function(V){if(U[o]){var q=U[o],B=q.observers;for(var x in B)V(B[x])&&delete B[x]}};M&&typeof window!="undefined"&&(window[M]=function(){return l.asyncScriptLoaderTriggerOnScriptLoaded()}),C.onload=function(){var L=U[o];L&&(L.loaded=!0,J(function(V){return M?!1:(V(L),!0)}))},C.onerror=function(){var L=U[o];L&&(L.errored=!0,J(function(V){return V(L),!0}))},document.body.appendChild(C)},m.componentWillUnmount=function(){var l=this.__scriptURL;if(a.removeOnUnmount===!0)for(var o=document.getElementsByTagName("script"),f=0;f<o.length;f+=1)o[f].src.indexOf(l)>-1&&o[f].parentNode&&o[f].parentNode.removeChild(o[f]);var h=U[l];h&&(delete h.observers[this.asyncScriptLoaderGetScriptLoaderID()],a.removeOnUnmount===!0&&delete U[l])},m.render=function(){var l=a.globalName,o=this.props;o.asyncScriptOnLoad;var f=o.forwardedRef,h=es(o,["asyncScriptOnLoad","forwardedRef"]);return l&&typeof window!="undefined"&&(h[l]=typeof window[l]!="undefined"?window[l]:void 0),h.ref=f,u.createElement(n,h)},d}(u.Component),c=u.forwardRef(function(g,d){return u.createElement(i,xe({},g,{forwardedRef:d}))});return c.displayName="AsyncScriptLoader("+s+")",c.propTypes={asyncScriptOnLoad:F.func},Zr(c,n)}}var ve="onloadcallback",ss="grecaptcha";function ye(){return typeof window!="undefined"&&window.recaptchaOptions||{}}function ns(){var t=ye(),a=t.useRecaptchaNet?"recaptcha.net":"www.google.com";return t.enterprise?"https://"+a+"/recaptcha/enterprise.js?onload="+ve+"&render=explicit":"https://"+a+"/recaptcha/api.js?onload="+ve+"&render=explicit"}const is=rs(ns,{callbackName:ve,globalName:ss,attributes:ye().nonce?{nonce:ye().nonce}:{}})(le),os=()=>{const{login:t}=Z(),[a,r]=u.useState(!1),[n,s]=u.useState(!1),[i,c]=u.useState(null),[g,d]=u.useState(""),[m,y]=u.useState(!1),l=u.useRef(null),{register:o,handleSubmit:f,formState:{errors:h}}=Jt();u.useEffect(()=>{_(void 0,null,function*(){try{const S=yield E.get("/auth/recaptcha-config");S.data&&(y(S.data.enabled),d(S.data.siteKey))}catch(S){console.error("Failed to fetch reCAPTCHA config:",S),y(!1)}})},[]);const N=v=>{c(v)},M=v=>_(void 0,null,function*(){if(m&&!i){D.error("Please complete the reCAPTCHA verification");return}r(!0);try{const S=R(T({},v),{recaptchaToken:i}),j=yield t(S);j.success?D.success("Login successful!"):(l.current&&(l.current.reset(),c(null)),j.error.includes("locked")?D.error(j.error,{duration:5e3}):j.error.includes("Too many")?D.error(j.error,{duration:5e3}):j.error.includes("reCAPTCHA")||j.error.includes("captcha")?D.error("Security verification failed. Please try again."):D.error(j.error))}catch(S){l.current&&(l.current.reset(),c(null)),D.error("Login failed. Please try again.")}finally{r(!1)}});return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"mx-auto flex items-center justify-center",children:e.jsx("img",{src:"/aglis-logo.svg",alt:"AGLIS Net",className:"h-16 w-auto"})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"AGLIS Management System"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to your account"})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:f(M),children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"username",className:"form-label",children:"Username or Email"}),e.jsx("input",T({id:"username",type:"text",autoComplete:"username",className:`form-input ${h.username?"border-red-500":""}`,placeholder:"Enter your username or email"},o("username",{required:"Username or email is required"}))),h.username&&e.jsx("p",{className:"form-error",children:h.username.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"form-label",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",T({id:"password",type:n?"text":"password",autoComplete:"current-password",className:`form-input pr-10 ${h.password?"border-red-500":""}`,placeholder:"Enter your password"},o("password",{required:"Password is required"}))),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!n),children:n?e.jsx(Ft,{className:"h-5 w-5 text-gray-400"}):e.jsx(Wt,{className:"h-5 w-5 text-gray-400"})})]}),h.password&&e.jsx("p",{className:"form-error",children:h.password.message})]})]}),m&&g&&e.jsx("div",{className:"flex justify-center",children:e.jsx(is,{ref:l,sitekey:g,onChange:N,onExpired:()=>c(null),onErrored:()=>{c(null),D.error("reCAPTCHA error. Please refresh the page.")},theme:"light"})}),e.jsxs("div",{children:[e.jsx("button",{type:"submit",disabled:a||m&&!i,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:a?e.jsx(se,{size:"sm"}):"Sign In"}),m&&!i&&e.jsx("p",{className:"mt-2 text-sm text-center text-gray-500",children:"Please complete the reCAPTCHA verification above"})]})]})]})})},Fe={getDashboardOverview:(t=30)=>_(void 0,null,function*(){return yield E.get(`/analytics/dashboard/overview?timeframe=${t}`)}),getTicketTrends:(t=30)=>_(void 0,null,function*(){return yield E.get(`/analytics/dashboard/ticket-trends?days=${t}`)}),getServiceDistribution:()=>_(void 0,null,function*(){return yield E.get("/analytics/dashboard/service-distribution")}),getTechnicianPerformance:()=>_(void 0,null,function*(){return yield E.get("/analytics/dashboard/technician-performance")}),getPriorityAnalysis:()=>_(void 0,null,function*(){return yield E.get("/analytics/dashboard/priority-analysis")}),getRecentActivities:(t=10)=>_(void 0,null,function*(){return yield E.get(`/analytics/dashboard/recent-activities?limit=${t}`)})},cs=()=>{var l,o,f,h,N,M;const{user:t}=Z(),a=ft(),r=ce(),{data:n,isLoading:s}=Y("dashboard-overview",()=>Fe.getDashboardOverview(),{refetchInterval:3e4,refetchOnWindowFocus:!0,refetchOnMount:"always",staleTime:0}),{data:i,isLoading:c}=Y("dashboard-activities",()=>Fe.getRecentActivities(50),{refetchInterval:15e3,refetchOnWindowFocus:!0,refetchOnMount:"always",staleTime:0});if(u.useEffect(()=>{const v=()=>{r.invalidateQueries("dashboard-overview"),r.invalidateQueries("dashboard-activities"),console.log("📊 Dashboard data refreshed due to ticket update")};return window.addEventListener("ticket-updated",v),window.addEventListener("ticket-created",v),window.addEventListener("ticket-assigned",v),window.addEventListener("ticket-completed",v),()=>{window.removeEventListener("ticket-updated",v),window.removeEventListener("ticket-created",v),window.removeEventListener("ticket-assigned",v),window.removeEventListener("ticket-completed",v)}},[r]),s)return e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(se,{})});const g=(n==null?void 0:n.data)||{},d=((l=g.tickets)==null?void 0:l.byStatus)||{},m={total_tickets:((o=g.tickets)==null?void 0:o.total)||0,open_tickets:d.open||0,assigned_tickets:d.assigned||0,in_progress_tickets:d.in_progress||0,on_hold_tickets:d.on_hold||0,completed_tickets:d.completed||0,cancelled_tickets:d.cancelled||0,avg_resolution_time:((f=g.resolution)==null?void 0:f.averageHours)||null,avg_customer_rating:((h=g.satisfaction)==null?void 0:h.averageRating)||null,sla_compliance:((N=g.sla)==null?void 0:N.complianceRate)||null,active_technicians:((M=g.technicians)==null?void 0:M.available)||0,approaching_sla:0,overdue_tickets:0},y=({title:v,description:S,icon:j,color:C="blue",onClick:O})=>e.jsx("button",{onClick:O,className:"card hover:shadow-md transition-shadow text-left w-full h-full",children:e.jsxs("div",{className:"card-body flex items-center h-full",children:[e.jsx("div",{className:`p-2 rounded-lg bg-${C}-100 mr-3 flex-shrink-0`,children:e.jsx(j,{className:`h-5 w-5 text-${C}-600`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:v}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:S})]})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",t==null?void 0:t.full_name,"!"]}),e.jsx("p",{className:"text-gray-600",children:"Here's what's happening with your ISP operations today."})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-4",children:[e.jsx(G,{title:"Total",value:m.total_tickets||0,icon:ae,color:"blue"}),e.jsx(G,{title:"Open",value:m.open_tickets||0,icon:zt,color:"blue"}),e.jsx(G,{title:"Assigned",value:m.assigned_tickets||0,icon:ue,color:"indigo"}),e.jsx(G,{title:"Progress",value:m.in_progress_tickets||0,icon:qt,color:"orange"}),e.jsx(G,{title:"On Hold",value:m.on_hold_tickets||0,icon:Vt,color:"yellow"}),e.jsx(G,{title:"Completed",value:m.completed_tickets||0,icon:re,color:"green"}),e.jsx(G,{title:"Cancelled",value:m.cancelled_tickets||0,icon:Ut,color:"red"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card h-full",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 h-full",children:[e.jsx(y,{title:"Create New Ticket",description:"Add a new service request",icon:ae,color:"blue",onClick:()=>a("/tickets")}),e.jsx(y,{title:"Add Customer",description:"Register new customer",icon:ue,color:"green",onClick:()=>a("/customers")}),e.jsx(y,{title:"Manage Technicians",description:"View and manage technicians",icon:me,color:"purple",onClick:()=>a("/technicians")}),e.jsx(y,{title:"Check Inventory",description:"View stock levels",icon:Ue,color:"orange",onClick:()=>a("/inventory")})]})})]})}),e.jsx("div",{children:e.jsxs("div",{className:"card h-full flex flex-col",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Today's Activity"})}),e.jsx("div",{className:"card-body flex-1 overflow-hidden",children:c?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(se,{})}):i!=null&&i.data&&i.data.length>0?e.jsx("div",{className:"space-y-4 overflow-y-auto h-full pr-2",style:{maxHeight:"180px"},children:i.data.map((v,S)=>{let j="",C=ae,O="blue";return v.status==="completed"?(j=`Ticket #${v.ticketNumber} completed`,C=re,O="green"):v.status==="assigned"?(j=`Ticket #${v.ticketNumber} assigned to technician`,C=me,O="purple"):v.status==="in_progress"?(j=`Ticket #${v.ticketNumber} in progress`,C=Ht,O="orange"):v.status==="open"?(j=`New ticket created: ${v.title}`,C=ae,O="blue"):j=`Ticket #${v.ticketNumber} - ${v.title}`,e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`p-1 bg-${O}-100 rounded-full`,children:e.jsx(C,{className:`h-4 w-4 text-${O}-600`})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-gray-900",children:j}),e.jsx("p",{className:"text-xs text-gray-500",children:v.timestamp&&!isNaN(new Date(v.timestamp).getTime())?Ye(new Date(v.timestamp),{addSuffix:!0,locale:Ge}):"Baru saja"})]})]},S)})}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Tidak ada aktivitas hari ini"})})]})})]}),((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="supervisor")&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Performance Overview"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Average Resolution Time"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.avg_resolution_time?`${m.avg_resolution_time.toFixed(1)} hours`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Customer Satisfaction"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.avg_customer_rating?`${m.avg_customer_rating.toFixed(1)}/5.0`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"SLA Compliance"}),e.jsx("span",{className:`text-sm font-medium ${m.sla_compliance>=90?"text-green-600":"text-yellow-600"}`,children:m.sla_compliance?`${m.sla_compliance.toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active Technicians"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:m.active_technicians||0})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"System Alerts"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"space-y-3",children:[m.approaching_sla>0,m.overdue_tickets>0,e.jsxs("div",{className:"flex items-center p-3 bg-green-50 rounded-lg",children:[e.jsx(re,{className:"h-5 w-5 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"All tickets on track"}),e.jsx("p",{className:"text-xs text-green-600",children:"No urgent alerts"})]})]})]})})]})]})]})},ls=u.lazy(()=>k(()=>import("./AnalyticsDashboard-DfdWFgIt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),ds=u.lazy(()=>k(()=>import("./PerformanceDashboard-DR01maUM.js"),__vite__mapDeps([9,1,2,3,4,5]))),us=u.lazy(()=>k(()=>import("./tickets-D86rcXeL.js").then(t=>t.T),__vite__mapDeps([10,1,2,3,4,5,6,7,8]))),ms=u.lazy(()=>k(()=>import("./tickets-D86rcXeL.js").then(t=>t.a),__vite__mapDeps([10,1,2,3,4,5,6,7,8]))),hs=u.lazy(()=>k(()=>import("./customers-IXR_7pB8.js").then(t=>t.C),__vite__mapDeps([6,1,2,3,4,5,7,8]))),fs=u.lazy(()=>k(()=>import("./customers-IXR_7pB8.js").then(t=>t.m),__vite__mapDeps([6,1,2,3,4,5,7,8]))),ps=u.lazy(()=>k(()=>import("./TechniciansPage-BRhxSNjR.js"),__vite__mapDeps([11,1,2,3,4,5,10,6,7,8]))),gs=u.lazy(()=>k(()=>import("./TechnicianDetailPage-CuCEllFR.js"),__vite__mapDeps([12,1,2,3,4,5,6,7,8,10]))),xs=u.lazy(()=>k(()=>import("./InventoryPage-B5Xvnboe.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8]))),vs=u.lazy(()=>k(()=>import("./InventoryStockPage-Cxu6iFqH.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,8]))),ys=u.lazy(()=>k(()=>import("./PackagesPage-BzFazpMm.js"),__vite__mapDeps([15,1,2,3,4,5,6,7,8]))),bs=u.lazy(()=>k(()=>import("./PriceListPage-C9oqBTeB.js"),__vite__mapDeps([16,1,2,3,4,5,6,7,8]))),js=u.lazy(()=>k(()=>import("./EquipmentPage-D9wChxBc.js"),__vite__mapDeps([17,1,2,3,4,5,6,7,8]))),ws=u.lazy(()=>k(()=>import("./ODPPage-C4N6-UnU.js"),__vite__mapDeps([18,1,2,3,4,5,10,6,7,8]))),Ns=u.lazy(()=>k(()=>import("./ServiceTypesPage-10a8JJwP.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8]))),_s=u.lazy(()=>k(()=>import("./ServiceCategoriesPage-DfxVO9Y9.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8]))),ks=u.lazy(()=>k(()=>import("./UsersPage-Ne-1TIaS.js"),__vite__mapDeps([21,1,2,3,4,5,6,7,8]))),Ss=u.lazy(()=>k(()=>import("./PermissionsPage-Deia1t4w.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8]))),Ps=u.lazy(()=>k(()=>import("./ProfilePage-CHRMbnA5.js"),__vite__mapDeps([23,1,2,3,4,5,8,6,7]))),Ts=u.lazy(()=>k(()=>import("./RegisterPage-C6uImjb1.js"),__vite__mapDeps([24,1,2,3,4,5,8,25,6,7]))),We=u.lazy(()=>k(()=>import("./TrackingPage-CwmS1vdf.js"),__vite__mapDeps([26,1,2,3,4,5,25,6,7,8]))),Cs=u.lazy(()=>k(()=>import("./RegistrationsPage-DYbj8YAY.js"),__vite__mapDeps([27,1,2,3,4,5,25,6,7,8]))),As=u.lazy(()=>k(()=>import("./RegistrationDetailPage-BuQcU2nE.js"),__vite__mapDeps([28,1,2,3,4,5,25,6,7,8]))),Es=u.lazy(()=>k(()=>import("./RegistrationAnalyticsPage-CQ29nEH2.js"),__vite__mapDeps([29,1,2,3,4,5]))),Rs=u.lazy(()=>k(()=>import("./notifications-DGuCqj8i.js").then(t=>t.N),__vite__mapDeps([1,2,3,4,5]))),Ms=u.lazy(()=>k(()=>import("./notifications-DGuCqj8i.js").then(t=>t.b),__vite__mapDeps([1,2,3,4,5]))),Os=u.lazy(()=>k(()=>import("./notifications-DGuCqj8i.js").then(t=>t.c),__vite__mapDeps([1,2,3,4,5]))),Ds=u.lazy(()=>k(()=>import("./InvoicesPage-Dk5cVMKS.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8]))),Ls=u.lazy(()=>k(()=>import("./InvoiceDetailPage-DPNKpJTj.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8]))),Is=u.lazy(()=>k(()=>import("./InvoiceCreatePage-N7FkdzSS.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8]))),$s=u.lazy(()=>k(()=>import("./PaymentsPage-q3A2wxsT.js"),__vite__mapDeps([33,1,2,3,4,5,6,7,8])));function Fs(){const{user:t,loading:a}=Z();return a?e.jsx(se,{}):e.jsx(ra,{children:e.jsx(ea,{children:e.jsx(u.Suspense,{fallback:e.jsx(se,{}),children:e.jsxs(pt,{children:[e.jsx(w,{path:"/login",element:t?e.jsx(ne,{to:"/dashboard",replace:!0}):e.jsx(os,{})}),e.jsx(w,{path:"/register",element:e.jsx(Ts,{})}),e.jsx(w,{path:"/track",element:e.jsx(We,{})}),e.jsx(w,{path:"/track/:registrationNumber",element:e.jsx(We,{})}),e.jsxs(w,{path:"/*",element:t?e.jsx(Lr,{}):e.jsx(ne,{to:"/login",replace:!0}),children:[e.jsx(w,{path:"dashboard",element:e.jsx(cs,{})}),e.jsx(w,{path:"analytics",element:e.jsx(ls,{})}),e.jsx(w,{path:"performance",element:e.jsx(ds,{})}),e.jsx(w,{path:"tickets",element:e.jsx(us,{})}),e.jsx(w,{path:"tickets/:id",element:e.jsx(ms,{})}),e.jsx(w,{path:"customers",element:e.jsx(hs,{})}),e.jsx(w,{path:"customers/:id",element:e.jsx(fs,{})}),e.jsx(w,{path:"registrations",element:e.jsx(Cs,{})}),e.jsx(w,{path:"registrations/:id",element:e.jsx(As,{})}),e.jsx(w,{path:"registration-analytics",element:e.jsx(Es,{})}),e.jsx(w,{path:"technicians",element:e.jsx(ps,{})}),e.jsx(w,{path:"technicians/:id",element:e.jsx(gs,{})}),e.jsx(w,{path:"inventory",element:e.jsx(xs,{})}),e.jsx(w,{path:"inventory-stock",element:e.jsx(vs,{})}),e.jsx(w,{path:"master-data/service-types",element:e.jsx(Ns,{})}),e.jsx(w,{path:"master-data/service-categories",element:e.jsx(_s,{})}),e.jsx(w,{path:"master-data/packages",element:e.jsx(ys,{})}),e.jsx(w,{path:"master-data/price-list",element:e.jsx(bs,{})}),e.jsx(w,{path:"master-data/equipment",element:e.jsx(js,{})}),e.jsx(w,{path:"master-data/odp",element:e.jsx(ws,{})}),e.jsx(w,{path:"notifications/templates",element:e.jsx(Rs,{})}),e.jsx(w,{path:"notifications/analytics",element:e.jsx(Ms,{})}),e.jsx(w,{path:"notifications/settings",element:e.jsx(Os,{})}),e.jsx(w,{path:"users",element:e.jsx(ks,{})}),e.jsx(w,{path:"permissions",element:e.jsx(Ss,{})}),e.jsx(w,{path:"invoices",element:e.jsx(Ds,{})}),e.jsx(w,{path:"invoices/new",element:e.jsx(Is,{})}),e.jsx(w,{path:"invoices/:id",element:e.jsx(Ls,{})}),e.jsx(w,{path:"payments",element:e.jsx($s,{})}),e.jsx(w,{path:"profile",element:e.jsx(Ps,{})}),e.jsx(w,{path:"",element:e.jsx(ne,{to:"/dashboard",replace:!0})})]}),e.jsx(w,{path:"*",element:e.jsx(ne,{to:"/dashboard",replace:!0})})]})})})})}const Ws=new xt({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1,staleTime:5*60*1e3}}});he.createRoot(document.getElementById("root")).render(e.jsx(ze.StrictMode,{children:e.jsxs(vt,{client:Ws,children:[e.jsx(gt,{children:e.jsxs(Xt,{children:[e.jsx(Fs,{}),e.jsx(Qt,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,theme:{primary:"green",secondary:"black"}}}})]})}),e.jsx(Bt.ReactQueryDevtools,{initialIsOpen:!1})]})}));export{is as R,Fe as a,ta as p};
//# sourceMappingURL=index-DU4XVapb.js.map
