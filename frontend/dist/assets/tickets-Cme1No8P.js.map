{"version":3,"file":"tickets-Cme1No8P.js","sources":["../../src/services/technicianService.js","../../src/components/SmartAssignmentModal.jsx","../../src/components/MultiTechnicianSelector.jsx","../../src/components/TeamAssignmentModal.jsx","../../src/pages/tickets/TicketsPage.jsx","../../src/services/odpService.js","../../src/components/StatusUpdateForm.jsx","../../src/components/TechnicianTeamDisplay.jsx","../../src/pages/tickets/TicketDetailPage.jsx"],"sourcesContent":["import api from './api'\n\nexport const technicianService = {\n  // Get all technicians with filtering\n  getTechnicians: async (params = {}) => {\n    const queryString = new URLSearchParams(params).toString()\n    const response = await api.get(`/technicians?${queryString}`)\n    return response\n  },\n\n  // Get technician by ID with detailed information\n  getTechnician: async (id) => {\n    const response = await api.get(`/technicians/${id}`)\n    return response\n  },\n\n  // Create new technician\n  createTechnician: async (technicianData) => {\n    const response = await api.post('/technicians', technicianData)\n    return response\n  },\n\n  // Update technician\n  updateTechnician: async (id, technicianData) => {\n    const response = await api.put(`/technicians/${id}`, technicianData)\n    return response\n  },\n\n  // Delete technician\n  deleteTechnician: async (id) => {\n    const response = await api.delete(`/technicians/${id}`)\n    return response\n  },\n\n  // Update technician availability status\n  updateAvailability: async (id, availabilityData) => {\n    const response = await api.patch(`/technicians/${id}/availability`, availabilityData)\n    return response\n  },\n\n  // Add skill to technician\n  addSkill: async (id, skillData) => {\n    const response = await api.post(`/technicians/${id}/skills`, skillData)\n    return response\n  },\n\n  // Get technician statistics\n  getTechnicianStats: async () => {\n    const response = await api.get('/technicians/stats/overview')\n    return response\n  },\n\n  // Get available technicians for assignment\n  getAvailableTechnicians: async (params = {}) => {\n    const queryString = new URLSearchParams(params).toString()\n    const response = await api.get(`/technicians/available/assignment?${queryString}`)\n    return response\n  },\n\n  // Get technician performance data\n  getTechnicianPerformance: async (id, period = 'month') => {\n    const response = await api.get(`/technicians/${id}/performance?period=${period}`)\n    return response\n  },\n\n  // Update technician location\n  updateLocation: async (id, locationData) => {\n    const response = await api.patch(`/technicians/${id}/location`, locationData)\n    return response\n  },\n\n  // Get technician schedule\n  getTechnicianSchedule: async (id, startDate, endDate) => {\n    const params = new URLSearchParams({\n      start_date: startDate,\n      end_date: endDate\n    })\n    const response = await api.get(`/technicians/${id}/schedule?${params}`)\n    return response\n  },\n\n  // Update technician schedule\n  updateSchedule: async (id, scheduleData) => {\n    const response = await api.put(`/technicians/${id}/schedule`, scheduleData)\n    return response\n  }\n}\n","import React, { useState, useEffect } from 'react'\nimport { useQuery, useMutation, useQueryClient } from 'react-query'\nimport { \n  X, User, MapPin, Star, Clock, Zap, Award, \n  CheckCircle, AlertCircle, Loader, Target,\n  Users, TrendingUp, Navigation, Wrench\n} from 'lucide-react'\nimport { ticketService } from '../services/ticketService'\nimport { technicianService } from '../services/technicianService'\nimport LoadingSpinner from './LoadingSpinner'\nimport toast from 'react-hot-toast'\n\nconst SmartAssignmentModal = ({ isOpen, onClose, ticket }) => {\n  const [assignmentMode, setAssignmentMode] = useState('auto') // 'auto' or 'manual'\n  const [selectedTechnician, setSelectedTechnician] = useState(null)\n  const [assignmentOptions, setAssignmentOptions] = useState({\n    force_zone: '',\n    required_skills: []\n  })\n  \n  const queryClient = useQueryClient()\n\n  // Get assignment recommendations\n  const { data: recommendationsData, isLoading: loadingRecommendations } = useQuery(\n    ['assignment-recommendations', ticket?.id],\n    () => ticketService.getAssignmentRecommendations(ticket.id),\n    { \n      enabled: isOpen && !!ticket?.id,\n      refetchOnWindowFocus: false\n    }\n  )\n\n  // Auto assignment mutation\n  const autoAssignMutation = useMutation(\n    (options) => ticketService.autoAssignTicket(ticket.id, options),\n    {\n      onSuccess: (data) => {\n        toast.success('Ticket berhasil di-assign secara otomatis!')\n        queryClient.invalidateQueries(['tickets'])\n        queryClient.invalidateQueries(['ticket', ticket.id])\n        onClose()\n      },\n      onError: (error) => {\n        toast.error(error.response?.data?.message || 'Gagal melakukan auto assignment')\n      }\n    }\n  )\n\n  // Manual assignment mutation\n  const manualAssignMutation = useMutation(\n    (technicianId) => ticketService.assignTicket(ticket.id, technicianId),\n    {\n      onSuccess: () => {\n        toast.success('Ticket berhasil di-assign!')\n        queryClient.invalidateQueries(['tickets'])\n        queryClient.invalidateQueries(['ticket', ticket.id])\n        onClose()\n      },\n      onError: (error) => {\n        toast.error(error.response?.data?.message || 'Gagal melakukan assignment')\n      }\n    }\n  )\n\n  const handleAutoAssign = () => {\n    autoAssignMutation.mutate(assignmentOptions)\n  }\n\n  const handleManualAssign = () => {\n    if (!selectedTechnician) {\n      toast.error('Pilih teknisi terlebih dahulu')\n      return\n    }\n    manualAssignMutation.mutate(selectedTechnician.id)\n  }\n\n  const getAvailabilityBadge = (status) => {\n    const badges = {\n      available: { color: 'bg-green-100 text-green-800', icon: CheckCircle, label: 'Available' },\n      unavailable: { color: 'bg-red-100 text-red-800', icon: AlertCircle, label: 'Unavailable' }\n    }\n    const badge = badges[status] || badges.unavailable\n    const Icon = badge.icon\n    \n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${badge.color}`}>\n        <Icon className=\"h-3 w-3 mr-1\" />\n        {badge.label}\n      </span>\n    )\n  }\n\n  const getCapacityBadge = (status) => {\n    const badges = {\n      available: { color: 'bg-blue-100 text-blue-800', label: 'Has Capacity' },\n      full: { color: 'bg-orange-100 text-orange-800', label: 'At Capacity' }\n    }\n    const badge = badges[status] || badges.full\n    \n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${badge.color}`}>\n        {badge.label}\n      </span>\n    )\n  }\n\n  const getDistanceBadge = (status) => {\n    const badges = {\n      near: { color: 'bg-green-100 text-green-800', icon: Navigation, label: 'Nearby' },\n      medium: { color: 'bg-yellow-100 text-yellow-800', icon: Navigation, label: 'Medium' },\n      far: { color: 'bg-red-100 text-red-800', icon: Navigation, label: 'Far' },\n      unknown: { color: 'bg-gray-100 text-gray-800', icon: Navigation, label: 'Unknown' }\n    }\n    const badge = badges[status] || badges.unknown\n    const Icon = badge.icon\n    \n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${badge.color}`}>\n        <Icon className=\"h-3 w-3 mr-1\" />\n        {badge.label}\n      </span>\n    )\n  }\n\n  const getSkillLevelBadge = (level) => {\n    const badges = {\n      junior: { color: 'bg-blue-100 text-blue-800', label: 'Junior' },\n      senior: { color: 'bg-purple-100 text-purple-800', label: 'Senior' },\n      expert: { color: 'bg-orange-100 text-orange-800', label: 'Expert' },\n      specialist: { color: 'bg-red-100 text-red-800', label: 'Specialist' }\n    }\n    const badge = badges[level] || badges.junior\n    \n    return (\n      <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${badge.color}`}>\n        <Award className=\"h-3 w-3 mr-1\" />\n        {badge.label}\n      </span>\n    )\n  }\n\n  if (!isOpen) return null\n\n  const recommendations = recommendationsData?.data?.recommendations || []\n  const ticketData = recommendationsData?.data?.ticket || ticket\n\n  return (\n    <div className=\"fixed inset-0 z-50 overflow-y-auto\">\n      <div className=\"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0\">\n        <div className=\"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75\" onClick={onClose} />\n\n        <div className=\"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full\">\n          {/* Header */}\n          <div className=\"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center\">\n                <Target className=\"h-6 w-6 text-blue-600 mr-2\" />\n                <h3 className=\"text-lg font-medium text-gray-900\">\n                  Smart Assignment - Ticket #{ticketData?.ticket_number}\n                </h3>\n              </div>\n              <button\n                onClick={onClose}\n                className=\"text-gray-400 hover:text-gray-600\"\n              >\n                <X className=\"h-6 w-6\" />\n              </button>\n            </div>\n\n            {/* Ticket Info */}\n            <div className=\"bg-gray-50 rounded-lg p-4 mb-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium text-gray-500\">Customer</label>\n                  <p className=\"text-sm text-gray-900\">{ticketData?.customer_name}</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium text-gray-500\">Service Type</label>\n                  <p className=\"text-sm text-gray-900\">{ticketData?.service_type || 'General'}</p>\n                </div>\n                <div>\n                  <label className=\"text-sm font-medium text-gray-500\">Priority</label>\n                  <span className={`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${\n                    ticketData?.priority === 'high' ? 'bg-red-100 text-red-800' :\n                    ticketData?.priority === 'medium' ? 'bg-yellow-100 text-yellow-800' :\n                    'bg-green-100 text-green-800'\n                  }`}>\n                    {ticketData?.priority || 'low'}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            {/* Assignment Mode Toggle */}\n            <div className=\"flex space-x-4 mb-6\">\n              <button\n                onClick={() => setAssignmentMode('auto')}\n                className={`flex items-center px-4 py-2 rounded-lg font-medium ${\n                  assignmentMode === 'auto'\n                    ? 'bg-blue-100 text-blue-700 border-2 border-blue-200'\n                    : 'bg-gray-100 text-gray-700 border-2 border-transparent hover:bg-gray-200'\n                }`}\n              >\n                <Zap className=\"h-4 w-4 mr-2\" />\n                Auto Assignment\n              </button>\n              <button\n                onClick={() => setAssignmentMode('manual')}\n                className={`flex items-center px-4 py-2 rounded-lg font-medium ${\n                  assignmentMode === 'manual'\n                    ? 'bg-blue-100 text-blue-700 border-2 border-blue-200'\n                    : 'bg-gray-100 text-gray-700 border-2 border-transparent hover:bg-gray-200'\n                }`}\n              >\n                <Users className=\"h-4 w-4 mr-2\" />\n                Manual Selection\n              </button>\n            </div>\n\n            {/* Auto Assignment Options */}\n            {assignmentMode === 'auto' && (\n              <div className=\"bg-blue-50 rounded-lg p-4 mb-6\">\n                <h4 className=\"text-sm font-medium text-blue-900 mb-3\">Assignment Options</h4>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-blue-700 mb-1\">\n                      Force Work Zone\n                    </label>\n                    <select\n                      className=\"form-input text-sm\"\n                      value={assignmentOptions.force_zone}\n                      onChange={(e) => setAssignmentOptions(prev => ({ ...prev, force_zone: e.target.value }))}\n                    >\n                      <option value=\"\">Any Zone</option>\n                      <option value=\"Jakarta_Pusat\">Jakarta Pusat</option>\n                      <option value=\"Jakarta_Selatan\">Jakarta Selatan</option>\n                      <option value=\"Jakarta_Utara\">Jakarta Utara</option>\n                      <option value=\"Jakarta_Timur\">Jakarta Timur</option>\n                      <option value=\"Jakarta_Barat\">Jakarta Barat</option>\n                    </select>\n                  </div>\n                  <div>\n                    <label className=\"block text-sm font-medium text-blue-700 mb-1\">\n                      Required Skills\n                    </label>\n                    <select\n                      className=\"form-input text-sm\"\n                      multiple\n                      value={assignmentOptions.required_skills}\n                      onChange={(e) => {\n                        const values = Array.from(e.target.selectedOptions, option => option.value)\n                        setAssignmentOptions(prev => ({ ...prev, required_skills: values }))\n                      }}\n                    >\n                      <option value=\"fiber_optic\">Fiber Optic</option>\n                      <option value=\"wireless\">Wireless</option>\n                      <option value=\"networking\">Networking</option>\n                      <option value=\"installation\">Installation</option>\n                      <option value=\"troubleshooting\">Troubleshooting</option>\n                    </select>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Loading State */}\n            {loadingRecommendations && (\n              <div className=\"flex items-center justify-center py-8\">\n                <LoadingSpinner size=\"lg\" />\n                <span className=\"ml-3 text-gray-600\">Loading recommendations...</span>\n              </div>\n            )}\n\n            {/* Technician Recommendations */}\n            {!loadingRecommendations && recommendations.length > 0 && (\n              <div>\n                <h4 className=\"text-sm font-medium text-gray-900 mb-4\">\n                  {assignmentMode === 'auto' ? 'Top Matches' : 'Available Technicians'}\n                </h4>\n                <div className=\"space-y-3 max-h-96 overflow-y-auto\">\n                  {recommendations.slice(0, assignmentMode === 'auto' ? 3 : 10).map((tech) => (\n                    <div\n                      key={tech.id}\n                      className={`border rounded-lg p-4 cursor-pointer transition-all ${\n                        assignmentMode === 'manual' && selectedTechnician?.id === tech.id\n                          ? 'border-blue-500 bg-blue-50'\n                          : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\n                      }`}\n                      onClick={() => assignmentMode === 'manual' && setSelectedTechnician(tech)}\n                    >\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex items-start space-x-3\">\n                          <div className=\"flex-shrink-0 h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center\">\n                            <User className=\"h-5 w-5 text-gray-600\" />\n                          </div>\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center space-x-2 mb-1\">\n                              <h5 className=\"text-sm font-medium text-gray-900\">{tech.full_name}</h5>\n                              {getSkillLevelBadge(tech.skill_level)}\n                            </div>\n                            <p className=\"text-xs text-gray-500 mb-2\">ID: {tech.employee_id}</p>\n                            \n                            {/* Status Badges */}\n                            <div className=\"flex flex-wrap gap-2 mb-2\">\n                              {getAvailabilityBadge(tech.availability_status)}\n                              {getCapacityBadge(tech.capacity_status)}\n                              {getDistanceBadge(tech.distance_status)}\n                            </div>\n\n                            {/* Metrics */}\n                            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs\">\n                              <div className=\"flex items-center\">\n                                <Star className=\"h-3 w-3 text-yellow-400 mr-1\" />\n                                <span>{tech.avg_rating ? parseFloat(tech.avg_rating).toFixed(1) : 'N/A'}</span>\n                              </div>\n                              <div className=\"flex items-center\">\n                                <Clock className=\"h-3 w-3 text-blue-400 mr-1\" />\n                                <span>{tech.current_tickets}/{tech.max_daily_tickets}</span>\n                              </div>\n                              <div className=\"flex items-center\">\n                                <TrendingUp className=\"h-3 w-3 text-green-400 mr-1\" />\n                                <span>{tech.avg_sla ? parseFloat(tech.avg_sla).toFixed(1) : 'N/A'}%</span>\n                              </div>\n                              <div className=\"flex items-center\">\n                                <MapPin className=\"h-3 w-3 text-purple-400 mr-1\" />\n                                <span>{tech.work_zone?.replace('_', ' ')}</span>\n                              </div>\n                            </div>\n\n                            {/* Specializations */}\n                            {tech.specializations && tech.specializations.length > 0 && (\n                              <div className=\"mt-2\">\n                                <div className=\"flex flex-wrap gap-1\">\n                                  {tech.specializations.slice(0, 3).map((spec, index) => (\n                                    <span key={index} className=\"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800\">\n                                      <Wrench className=\"h-3 w-3 mr-1\" />\n                                      {spec.replace('_', ' ')}\n                                    </span>\n                                  ))}\n                                  {tech.specializations.length > 3 && (\n                                    <span className=\"text-xs text-gray-500\">\n                                      +{tech.specializations.length - 3} more\n                                    </span>\n                                  )}\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n\n                        {/* Recommendation Score */}\n                        <div className=\"flex-shrink-0 text-right\">\n                          <div className=\"text-lg font-bold text-blue-600\">\n                            {tech.recommendation_score || 0}\n                          </div>\n                          <div className=\"text-xs text-gray-500\">Score</div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* No Recommendations */}\n            {!loadingRecommendations && recommendations.length === 0 && (\n              <div className=\"text-center py-8\">\n                <Users className=\"mx-auto h-12 w-12 text-gray-400\" />\n                <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No technicians available</h3>\n                <p className=\"mt-1 text-sm text-gray-500\">\n                  No technicians match the current criteria.\n                </p>\n              </div>\n            )}\n          </div>\n\n          {/* Footer */}\n          <div className=\"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse\">\n            {assignmentMode === 'auto' ? (\n              <button\n                onClick={handleAutoAssign}\n                disabled={autoAssignMutation.isLoading || recommendations.length === 0}\n                className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {autoAssignMutation.isLoading ? (\n                  <>\n                    <Loader className=\"animate-spin h-4 w-4 mr-2\" />\n                    Assigning...\n                  </>\n                ) : (\n                  <>\n                    <Zap className=\"h-4 w-4 mr-2\" />\n                    Auto Assign\n                  </>\n                )}\n              </button>\n            ) : (\n              <button\n                onClick={handleManualAssign}\n                disabled={manualAssignMutation.isLoading || !selectedTechnician}\n                className=\"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {manualAssignMutation.isLoading ? (\n                  <>\n                    <Loader className=\"animate-spin h-4 w-4 mr-2\" />\n                    Assigning...\n                  </>\n                ) : (\n                  <>\n                    <CheckCircle className=\"h-4 w-4 mr-2\" />\n                    Assign Selected\n                  </>\n                )}\n              </button>\n            )}\n            \n            <button\n              onClick={onClose}\n              className=\"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm\"\n            >\n              Cancel\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default SmartAssignmentModal\n","import React, { useState } from 'react';\nimport { User, Star, Search, Briefcase, Activity } from 'lucide-react';\n\nconst MultiTechnicianSelector = ({ \n  availableTechnicians = [], \n  selectedTechnicians = [], \n  leadTechnicianId = null,\n  onChange,\n  onLeadChange\n}) => {\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const filteredTechnicians = availableTechnicians.filter(tech => \n    tech.full_name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    tech.specialization?.toLowerCase().includes(searchQuery.toLowerCase())\n  );\n\n  const handleToggleTechnician = (tech) => {\n    const isSelected = selectedTechnicians.some(t => t.technician_id === tech.id);\n    \n    if (isSelected) {\n      // Remove technician\n      const newSelection = selectedTechnicians.filter(t => t.technician_id !== tech.id);\n      onChange(newSelection);\n      \n      // If removing lead, clear lead selection\n      if (leadTechnicianId === tech.id) {\n        onLeadChange(null);\n      }\n    } else {\n      // Add technician\n      const newTech = {\n        technician_id: tech.id,\n        role: 'member'\n      };\n      onChange([...selectedTechnicians, newTech]);\n    }\n  };\n\n  const handleSetLead = (techId) => {\n    // Update roles: set selected as lead, others as member\n    const updated = selectedTechnicians.map(t => ({\n      ...t,\n      role: t.technician_id === techId ? 'lead' : (t.role === 'support' ? 'support' : 'member')\n    }));\n    onChange(updated);\n    onLeadChange(techId);\n  };\n\n  const handleSetRole = (techId, newRole) => {\n    const updated = selectedTechnicians.map(t => \n      t.technician_id === techId ? { ...t, role: newRole } : t\n    );\n    onChange(updated);\n  };\n\n  const getTechnicianWorkload = (tech) => {\n    // TODO: Get from API - current active tickets count\n    return tech.current_workload || 0;\n  };\n\n  const isSelected = (techId) => {\n    return selectedTechnicians.some(t => t.technician_id === techId);\n  };\n\n  const getSelectedRole = (techId) => {\n    const tech = selectedTechnicians.find(t => t.technician_id === techId);\n    return tech?.role || 'member';\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Search */}\n      <div className=\"relative\">\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n        <input\n          type=\"text\"\n          value={searchQuery}\n          onChange={(e) => setSearchQuery(e.target.value)}\n          placeholder=\"Cari teknisi...\"\n          className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n        />\n      </div>\n\n      {/* Selected Count */}\n      {selectedTechnicians.length > 0 && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-3\">\n          <p className=\"text-sm text-blue-700\">\n            <strong>{selectedTechnicians.length} teknisi</strong> dipilih\n            {leadTechnicianId && (\n              <span className=\"ml-2\">\n                • Lead: {availableTechnicians.find(t => t.id === leadTechnicianId)?.full_name}\n              </span>\n            )}\n          </p>\n        </div>\n      )}\n\n      {/* Technician List */}\n      <div className=\"max-h-96 overflow-y-auto space-y-2\">\n        {filteredTechnicians.length === 0 ? (\n          <p className=\"text-center text-gray-500 py-4\">Tidak ada teknisi tersedia</p>\n        ) : (\n          filteredTechnicians.map((tech) => {\n            const selected = isSelected(tech.id);\n            const role = getSelectedRole(tech.id);\n            const isLead = leadTechnicianId === tech.id;\n            const workload = getTechnicianWorkload(tech);\n\n            return (\n              <div\n                key={tech.id}\n                className={`border rounded-lg p-4 transition-all ${\n                  selected \n                    ? 'border-blue-500 bg-blue-50' \n                    : 'border-gray-200 hover:border-gray-300'\n                }`}\n              >\n                <div className=\"flex items-start space-x-3\">\n                  {/* Checkbox */}\n                  <input\n                    type=\"checkbox\"\n                    checked={selected}\n                    onChange={() => handleToggleTechnician(tech)}\n                    className=\"mt-1 h-5 w-5 text-blue-600 rounded focus:ring-blue-500\"\n                  />\n\n                  {/* Tech Info */}\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center space-x-2 mb-1\">\n                      <h4 className=\"font-semibold text-gray-900\">{tech.full_name}</h4>\n                      {isLead && (\n                        <span className=\"inline-flex items-center px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full\">\n                          <Star className=\"h-3 w-3 mr-1\" />\n                          LEAD\n                        </span>\n                      )}\n                    </div>\n\n                    <div className=\"flex flex-wrap items-center gap-2 text-sm text-gray-600\">\n                      {tech.specialization && (\n                        <span className=\"flex items-center\">\n                          <Briefcase className=\"h-3 w-3 mr-1\" />\n                          {tech.specialization}\n                        </span>\n                      )}\n                      <span className=\"flex items-center\">\n                        <Activity className=\"h-3 w-3 mr-1\" />\n                        {workload} active tickets\n                      </span>\n                    </div>\n\n                    {/* Role Selection (only for selected technicians) */}\n                    {selected && (\n                      <div className=\"mt-3 flex items-center space-x-2\">\n                        <label className=\"text-sm text-gray-600\">Role:</label>\n                        <div className=\"flex space-x-2\">\n                          <button\n                            type=\"button\"\n                            onClick={() => handleSetLead(tech.id)}\n                            className={`px-3 py-1 text-xs rounded-lg transition-colors ${\n                              isLead\n                                ? 'bg-yellow-500 text-white'\n                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                            }`}\n                          >\n                            <Star className=\"h-3 w-3 inline mr-1\" />\n                            Lead\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => handleSetRole(tech.id, 'member')}\n                            className={`px-3 py-1 text-xs rounded-lg transition-colors ${\n                              selected && role === 'member' && !isLead\n                                ? 'bg-blue-500 text-white'\n                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                            }`}\n                          >\n                            Member\n                          </button>\n                          <button\n                            type=\"button\"\n                            onClick={() => handleSetRole(tech.id, 'support')}\n                            className={`px-3 py-1 text-xs rounded-lg transition-colors ${\n                              role === 'support'\n                                ? 'bg-purple-500 text-white'\n                                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                            }`}\n                          >\n                            Support\n                          </button>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              </div>\n            );\n          })\n        )}\n      </div>\n\n      {/* Validation Message */}\n      {selectedTechnicians.length > 0 && !leadTechnicianId && (\n        <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-3\">\n          <p className=\"text-sm text-yellow-700\">\n            ⚠️ Pilih satu teknisi sebagai <strong>Lead</strong>\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MultiTechnicianSelector;\n\n","import React, { useState } from 'react';\nimport { useQuery, useMutation, useQueryClient } from 'react-query';\nimport { X, Users, AlertCircle, CheckCircle } from 'lucide-react';\nimport { technicianService } from '../services/technicianService';\nimport api from '../services/api';\nimport MultiTechnicianSelector from './MultiTechnicianSelector';\nimport toast from 'react-hot-toast';\n\nconst TeamAssignmentModal = ({ isOpen, onClose, ticket }) => {\n  const queryClient = useQueryClient();\n  const [selectedTechnicians, setSelectedTechnicians] = useState([]);\n  const [leadTechnicianId, setLeadTechnicianId] = useState(null);\n\n  // Fetch available technicians\n  const { data: techniciansData, isLoading } = useQuery(\n    'technicians-active',\n    () => technicianService.getTechnicians({ status: 'active' }),\n    {\n      enabled: isOpen\n    }\n  );\n\n  // Team assignment mutation\n  const assignTeamMutation = useMutation(\n    async () => {\n      const response = await api.put(`/tickets/${ticket.id}/assign-team`, {\n        technicians: selectedTechnicians\n      });\n      return response;\n    },\n    {\n      onSuccess: () => {\n        toast.success('Tim berhasil di-assign!');\n        queryClient.invalidateQueries(['tickets']);\n        queryClient.invalidateQueries(['ticket', ticket.id]);\n        onClose();\n        setSelectedTechnicians([]);\n        setLeadTechnicianId(null);\n      },\n      onError: (error) => {\n        toast.error(error.response?.data?.message || 'Gagal assign tim');\n      }\n    }\n  );\n\n  const technicians = techniciansData?.data || techniciansData || [];\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    if (selectedTechnicians.length === 0) {\n      toast.error('Pilih minimal 1 teknisi');\n      return;\n    }\n\n    if (!leadTechnicianId) {\n      toast.error('Tentukan lead technician');\n      return;\n    }\n\n    assignTeamMutation.mutate();\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\n        {/* Header */}\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"p-2 bg-purple-100 rounded-lg\">\n                <Users className=\"h-6 w-6 text-purple-600\" />\n              </div>\n              <div>\n                <h2 className=\"text-xl font-bold text-gray-900\">Assign Technician Team</h2>\n                <p className=\"text-sm text-gray-600\">\n                  Ticket #{ticket?.ticket_number} - {ticket?.title}\n                </p>\n              </div>\n            </div>\n            <button\n              onClick={onClose}\n              className=\"p-2 hover:bg-gray-100 rounded-lg transition-colors\"\n            >\n              <X className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </div>\n\n        {/* Body */}\n        <div className=\"flex-1 overflow-y-auto p-6\">\n          {isLoading ? (\n            <div className=\"flex justify-center py-12\">\n              <div className=\"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent\"></div>\n            </div>\n          ) : (\n            <form onSubmit={handleSubmit} id=\"team-assignment-form\">\n              <div className=\"mb-4\">\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Pilih Teknisi (bisa lebih dari 1)\n                </label>\n                \n                <MultiTechnicianSelector\n                  availableTechnicians={technicians}\n                  selectedTechnicians={selectedTechnicians}\n                  leadTechnicianId={leadTechnicianId}\n                  onChange={setSelectedTechnicians}\n                  onLeadChange={setLeadTechnicianId}\n                />\n              </div>\n\n              {/* Info Box */}\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4\">\n                <p className=\"text-sm text-blue-700\">\n                  <strong>💡 Catatan:</strong>\n                </p>\n                <ul className=\"text-sm text-blue-700 mt-2 space-y-1 ml-4 list-disc\">\n                  <li>Pilih minimal 1 teknisi (untuk single assignment)</li>\n                  <li>Untuk tim, pilih 2+ teknisi</li>\n                  <li>Tentukan 1 teknisi sebagai <strong>Lead</strong> (koordinator)</li>\n                  <li>Lead bertanggung jawab untuk koordinasi & update</li>\n                  <li>Semua anggota tim akan menerima notifikasi WhatsApp</li>\n                </ul>\n              </div>\n            </form>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"p-6 border-t border-gray-200 bg-gray-50\">\n          <div className=\"flex justify-between items-center\">\n            <div>\n              {selectedTechnicians.length > 0 && (\n                <p className=\"text-sm text-gray-600\">\n                  {selectedTechnicians.length === 1 ? (\n                    <span><CheckCircle className=\"inline h-4 w-4 text-green-600 mr-1\" />Single assignment ready</span>\n                  ) : (\n                    <span><Users className=\"inline h-4 w-4 text-blue-600 mr-1\" />{selectedTechnicians.length} teknisi dalam tim</span>\n                  )}\n                </p>\n              )}\n            </div>\n            <div className=\"flex space-x-3\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors\"\n              >\n                Batal\n              </button>\n              <button\n                type=\"submit\"\n                form=\"team-assignment-form\"\n                disabled={assignTeamMutation.isLoading || selectedTechnicians.length === 0 || !leadTechnicianId}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              >\n                {assignTeamMutation.isLoading ? 'Assigning...' : \n                 selectedTechnicians.length === 1 ? 'Assign Technician' : \n                 `Assign Team (${selectedTechnicians.length})`}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default TeamAssignmentModal;\n\n","import React, { useState, useEffect } from 'react'\nimport { useQuery, useQueryClient } from 'react-query'\nimport { Ticket, Plus, Search, Filter, Eye, Target, CheckCircle, Clock, AlertCircle, Users, PlayCircle, PauseCircle, XCircle, FileCheck, ArrowUpDown, ArrowUp, ArrowDown, ChevronLeft, ChevronRight, Download, Loader2, Copy, Check, User, UserPlus, PhoneCall, Mail as MailIcon, ShieldAlert, Trash2 } from 'lucide-react'\nimport { Link, useNavigate } from 'react-router-dom'\nimport toast from 'react-hot-toast'\nimport { ticketService } from '../../services/ticketService'\nimport TicketCreateForm from '../../components/TicketCreateForm'\nimport SmartAssignmentModal from '../../components/SmartAssignmentModal'\nimport TeamAssignmentModal from '../../components/TeamAssignmentModal'\nimport LoadingSpinner from '../../components/LoadingSpinner'\nimport KPICard from '../../components/dashboard/KPICard'\nimport { exportToExcel, formatCurrency, formatDate } from '../../utils/exportToExcel'\nimport { useAuth } from '../../contexts/AuthContext'\n\nconst TicketsPage = () => {\n  const navigate = useNavigate()\n  const queryClient = useQueryClient()\n  const { user: currentUser, isAdmin, isSupervisor, isTechnician, isCustomerService } = useAuth()\n  \n  const [showCreateForm, setShowCreateForm] = useState(false)\n  const [showAssignmentModal, setShowAssignmentModal] = useState(false)\n  const [showTeamAssignmentModal, setShowTeamAssignmentModal] = useState(false)\n  const [selectedTicketForAssignment, setSelectedTicketForAssignment] = useState(null)\n  const [currentPage, setCurrentPage] = useState(1)\n  const [limit, setLimit] = useState(10)\n  const [sortBy, setSortBy] = useState('created_at')\n  const [sortOrder, setSortOrder] = useState('DESC')\n  const [isExporting, setIsExporting] = useState(false)\n  const [technicianView, setTechnicianView] = useState('my-tickets') // 'my-tickets' or 'available'\n  const [filters, setFilters] = useState({\n    search: '',\n    status: '',\n    type: '',\n    priority: ''\n  })\n  \n  // Bulk selection states\n  const [selectedTickets, setSelectedTickets] = useState([])\n  const [selectAll, setSelectAll] = useState(false)\n  \n  // Copy to clipboard state\n  const [copiedField, setCopiedField] = useState(null)\n\n  // Format type name for display\n  const formatTypeName = (type) => {\n    const typeNames = {\n      'installation': 'Installation',\n      'repair': 'Repair',\n      'maintenance': 'Maintenance',\n      'upgrade': 'Upgrade',\n      'downgrade': 'Downgrade',\n      'wifi_setup': 'WiFi Setup',\n      'dismantle': 'Dismantle',\n      'speed_test': 'Speed Test',\n      'bandwidth_upgrade': 'Bandwidth Upgrade',\n      'redundancy_setup': 'Redundancy Setup',\n      'network_config': 'Network Config',\n      'security_audit': 'Security Audit'\n    }\n    return typeNames[type] || type\n  }\n\n  // Fetch tickets with pagination and sorting\n  const { data: ticketsData, isLoading, refetch } = useQuery(\n    ['tickets', filters, currentPage, limit, sortBy, sortOrder],\n    () => ticketService.getTickets({\n      ...filters,\n      page: currentPage,\n      limit,\n      sort_by: sortBy,\n      sort_order: sortOrder\n    }),\n    { \n      keepPreviousData: false, // Changed to false for immediate sorting feedback\n      refetchOnMount: true\n    }\n  )\n\n  // Fetch ticket statistics\n  const { data: statsData } = useQuery(\n    'ticket-stats',\n    () => ticketService.getTicketStats(),\n    {\n      refetchOnWindowFocus: true,\n      refetchOnMount: 'always'\n    }\n  )\n\n  // Listen to socket events for real-time ticket updates\n  useEffect(() => {\n    const handleTicketUpdate = () => {\n      // Invalidate and refetch ticket data\n      queryClient.invalidateQueries(['tickets'])\n      queryClient.invalidateQueries('ticket-stats')\n      console.log('🎫 Ticket list & stats refreshed due to ticket update')\n    }\n\n    // Listen to custom events from socket\n    window.addEventListener('ticket-updated', handleTicketUpdate)\n    window.addEventListener('ticket-created', handleTicketUpdate)\n    window.addEventListener('ticket-assigned', handleTicketUpdate)\n    window.addEventListener('ticket-completed', handleTicketUpdate)\n\n    // Cleanup\n    return () => {\n      window.removeEventListener('ticket-updated', handleTicketUpdate)\n      window.removeEventListener('ticket-created', handleTicketUpdate)\n      window.removeEventListener('ticket-assigned', handleTicketUpdate)\n      window.removeEventListener('ticket-completed', handleTicketUpdate)\n    }\n  }, [queryClient])\n\n  const handleCreateSuccess = () => {\n    setCurrentPage(1)\n    refetch()\n  }\n  \n  const handleSort = (column) => {\n    if (sortBy === column) {\n      // Toggle sort order\n      setSortOrder(sortOrder === 'ASC' ? 'DESC' : 'ASC')\n    } else {\n      // New column, default to DESC\n      setSortBy(column)\n      setSortOrder('DESC')\n    }\n    setCurrentPage(1) // Reset to first page when sorting changes\n    \n    // Invalidate queries to force refresh\n    queryClient.invalidateQueries(['tickets'])\n  }\n  \n  const getSortIcon = (column) => {\n    if (sortBy !== column) {\n      return <ArrowUpDown className=\"h-4 w-4 text-gray-400\" />\n    }\n    return sortOrder === 'ASC' \n      ? <ArrowUp className=\"h-4 w-4 text-blue-600\" />\n      : <ArrowDown className=\"h-4 w-4 text-blue-600\" />\n  }\n\n  const handleAssignTicket = (ticket) => {\n    setSelectedTicketForAssignment(ticket)\n    setShowAssignmentModal(true)\n  }\n\n  const handleTeamAssignTicket = (ticket) => {\n    setSelectedTicketForAssignment(ticket)\n    setShowTeamAssignmentModal(true)\n  }\n\n  // Export tickets to Excel\n  const handleExport = async () => {\n    try {\n      setIsExporting(true)\n      \n      // Fetch all tickets with current filters (no pagination limit)\n      const response = await ticketService.getTickets({\n        ...filters,\n        page: 1,\n        limit: 10000, // Get all data\n        sort_by: sortBy,\n        sort_order: sortOrder\n      })\n\n      const allTickets = response.data.tickets || []\n      \n      if (allTickets.length === 0) {\n        toast.error('Tidak ada data untuk di-export')\n        return\n      }\n\n      // Format data for Excel\n      const exportData = allTickets.map((ticket, index) => ({\n        'No': index + 1,\n        'Ticket Number': ticket.ticket_number,\n        'Tanggal Dibuat': formatDate(ticket.created_at),\n        'Type': formatTypeName(ticket.type),\n        'Status': ticket.status?.toUpperCase() || '-',\n        'Priority': ticket.priority?.toUpperCase() || '-',\n        'Customer': ticket.customer_name || '-',\n        'Customer Code': ticket.customer_code || '-',\n        'Teknisi': ticket.technician_name || 'Unassigned',\n        'Judul': ticket.title,\n        'Category': ticket.category || '-',\n        'SLA Due Date': formatDate(ticket.sla_due_date),\n        'Completed Date': ticket.completed_at ? formatDate(ticket.completed_at) : '-',\n        'Scheduled Date': ticket.scheduled_date ? formatDate(ticket.scheduled_date) : '-',\n        'Estimated Duration (min)': ticket.estimated_duration || '-'\n      }))\n\n      // Export to Excel\n      const result = exportToExcel(exportData, 'Tickets_Export', 'Tickets Data')\n      \n      toast.success(`✅ ${result.rows} tickets berhasil di-export!`)\n      \n    } catch (error) {\n      console.error('Export error:', error)\n      toast.error('Gagal export data. Silakan coba lagi.')\n    } finally {\n      setIsExporting(false)\n    }\n  }\n\n  const closeAssignmentModal = () => {\n    setShowAssignmentModal(false)\n    setSelectedTicketForAssignment(null)\n  }\n\n  const getStatusBadge = (status) => {\n    const statusConfig = {\n      open: { class: 'badge-info', label: 'Open' },\n      assigned: { class: 'badge-warning', label: 'Assigned' },\n      in_progress: { class: 'badge-warning', label: 'In Progress' },\n      completed: { class: 'badge-success', label: 'Completed' },\n      cancelled: { class: 'badge-gray', label: 'Cancelled' },\n      on_hold: { class: 'badge-gray', label: 'On Hold' }\n    }\n    const config = statusConfig[status] || statusConfig.open\n    return <span className={`badge ${config.class}`}>{config.label}</span>\n  }\n\n  const getPriorityBadge = (priority) => {\n    const priorityConfig = {\n      low: { class: 'badge-gray', label: 'Low' },\n      normal: { class: 'badge-info', label: 'Normal' },\n      high: { class: 'badge-warning', label: 'High' },\n      critical: { class: 'badge-danger', label: 'Critical' }\n    }\n    const config = priorityConfig[priority] || priorityConfig.normal\n    return <span className={`badge ${config.class}`}>{config.label}</span>\n  }\n\n  // ==================== BULK SELECTION HANDLERS ====================\n  \n  const handleSelectAll = (e) => {\n    if (e.target.checked) {\n      setSelectedTickets(tickets.map(t => t.id))\n      setSelectAll(true)\n    } else {\n      setSelectedTickets([])\n      setSelectAll(false)\n    }\n  }\n\n  const handleSelectTicket = (ticketId) => {\n    if (selectedTickets.includes(ticketId)) {\n      setSelectedTickets(selectedTickets.filter(id => id !== ticketId))\n      setSelectAll(false)\n    } else {\n      const newSelected = [...selectedTickets, ticketId]\n      setSelectedTickets(newSelected)\n      if (newSelected.length === tickets.length) {\n        setSelectAll(true)\n      }\n    }\n  }\n\n  // ==================== BULK ACTION HANDLERS ====================\n\n  const handleBulkClose = async () => {\n    if (selectedTickets.length === 0) {\n      toast.error('Pilih ticket terlebih dahulu')\n      return\n    }\n\n    if (!window.confirm(`Close ${selectedTickets.length} ticket yang dipilih?`)) {\n      return\n    }\n\n    try {\n      let successCount = 0\n      let errorCount = 0\n\n      for (const ticketId of selectedTickets) {\n        try {\n          await ticketService.updateTicket(ticketId, { status: 'completed' })\n          successCount++\n        } catch (error) {\n          errorCount++\n          console.error(`Failed to close ticket ${ticketId}:`, error)\n        }\n      }\n\n      if (successCount > 0) {\n        toast.success(`✅ ${successCount} ticket berhasil di-close${errorCount > 0 ? `, ${errorCount} gagal` : ''}`)\n        refetch()\n        setSelectedTickets([])\n        setSelectAll(false)\n      } else {\n        toast.error('Gagal close ticket')\n      }\n    } catch (error) {\n      console.error('Bulk close error:', error)\n      toast.error('Terjadi kesalahan saat close ticket')\n    }\n  }\n\n  const handleBulkDelete = async () => {\n    if (selectedTickets.length === 0) {\n      toast.error('Pilih ticket terlebih dahulu')\n      return\n    }\n\n    if (!window.confirm(`⚠️ PERINGATAN: Hapus ${selectedTickets.length} ticket yang dipilih?`)) {\n      return\n    }\n\n    try {\n      let successCount = 0\n      let errorCount = 0\n\n      for (const ticketId of selectedTickets) {\n        try {\n          await ticketService.deleteTicket(ticketId)\n          successCount++\n        } catch (error) {\n          errorCount++\n          console.error(`Failed to delete ticket ${ticketId}:`, error)\n        }\n      }\n\n      if (successCount > 0) {\n        toast.success(`✅ ${successCount} ticket berhasil dihapus${errorCount > 0 ? `, ${errorCount} gagal` : ''}`)\n        refetch()\n        setSelectedTickets([])\n        setSelectAll(false)\n      } else {\n        toast.error('Gagal hapus ticket')\n      }\n    } catch (error) {\n      console.error('Bulk delete error:', error)\n      toast.error('Terjadi kesalahan saat hapus ticket')\n    }\n  }\n\n  // ==================== COPY TO CLIPBOARD HANDLER ====================\n\n  const handleCopyToClipboard = (text, fieldName) => {\n    navigator.clipboard.writeText(text).then(() => {\n      setCopiedField(fieldName)\n      toast.success(`${fieldName} berhasil di-copy!`)\n      setTimeout(() => setCopiedField(null), 2000)\n    }).catch(err => {\n      toast.error('Gagal copy ke clipboard')\n      console.error('Copy error:', err)\n    })\n  }\n\n  // ==================== QUICK ACTION HANDLERS ====================\n\n  const handleQuickAssign = (e, ticket) => {\n    e.stopPropagation() // Prevent row click\n    setSelectedTicketForAssignment(ticket)\n    setShowAssignmentModal(true)\n  }\n\n  const handleQuickTeamAssign = (e, ticket) => {\n    e.stopPropagation() // Prevent row click\n    setSelectedTicketForAssignment(ticket)\n    setShowTeamAssignmentModal(true)\n  }\n\n  const handleQuickComplete = async (e, ticket) => {\n    e.stopPropagation() // Prevent row click\n    \n    if (!window.confirm(`Mark ticket ${ticket.ticket_number} as completed?`)) return\n\n    try {\n      await ticketService.updateTicket(ticket.id, { status: 'completed' })\n      toast.success(`Ticket ${ticket.ticket_number} marked as completed`)\n      refetch()\n    } catch (error) {\n      toast.error('Failed to complete ticket')\n      console.error('Quick complete error:', error)\n    }\n  }\n\n  const handleQuickCall = (e, phone) => {\n    e.stopPropagation() // Prevent row click\n    window.location.href = `tel:${phone}`\n  }\n\n  const handleQuickEmail = (e, email) => {\n    e.stopPropagation() // Prevent row click\n    window.location.href = `mailto:${email}`\n  }\n\n  // ==================== RBAC CHECK ====================\n  \n  // All authenticated users can access Tickets page\n  const hasAccess = isAdmin || isSupervisor || isTechnician || isCustomerService\n  const canCreate = isAdmin || isSupervisor || isCustomerService\n  const canDelete = isAdmin\n  const canAssign = isAdmin || isSupervisor\n\n  const stats = statsData?.data || {}\n\n  if (!hasAccess) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-96\">\n        <ShieldAlert className=\"h-24 w-24 text-red-500 mb-4\" />\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Access Denied</h2>\n        <p className=\"text-gray-600 mb-4\">You don't have permission to access Tickets.</p>\n        <p className=\"text-sm text-gray-500\">This page is for staff only.</p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">Tickets</h1>\n          <p className=\"text-gray-600\">Manage service requests and work orders</p>\n        </div>\n        <div className=\"flex gap-3\">\n          <button \n            onClick={handleExport}\n            disabled={isExporting || isLoading}\n            className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors inline-flex items-center disabled:opacity-50 disabled:cursor-not-allowed\"\n          >\n            {isExporting ? (\n              <>\n                <Loader2 className=\"h-4 w-4 mr-2 animate-spin\" />\n                Exporting...\n              </>\n            ) : (\n              <>\n                <Download className=\"h-4 w-4 mr-2\" />\n                Export to Excel\n              </>\n            )}\n          </button>\n          {canCreate && (\n            <button \n              onClick={() => setShowCreateForm(true)}\n              className=\"btn-primary\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              New Ticket\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Bulk Action Toolbar - Shows when items are selected */}\n      {selectedTickets.length > 0 && (\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <span className=\"text-sm font-medium text-blue-900\">\n                {selectedTickets.length} ticket dipilih\n              </span>\n              <button\n                onClick={() => {\n                  setSelectedTickets([])\n                  setSelectAll(false)\n                }}\n                className=\"text-sm text-blue-600 hover:text-blue-800 hover:underline\"\n              >\n                Batal Pilihan\n              </button>\n            </div>\n            <div className=\"flex gap-2\">\n              {canAssign && (\n                <button\n                  onClick={() => {\n                    if (selectedTickets.length === 1) {\n                      const ticket = tickets.find(t => t.id === selectedTickets[0])\n                      handleQuickAssign({ stopPropagation: () => {} }, ticket)\n                    } else {\n                      toast.info('Bulk assign coming soon!')\n                    }\n                  }}\n                  className=\"px-3 py-1.5 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors text-sm inline-flex items-center\"\n                >\n                  <UserPlus className=\"h-4 w-4 mr-1\" />\n                  Assign\n                </button>\n              )}\n              <button\n                onClick={handleBulkClose}\n                className=\"px-3 py-1.5 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm inline-flex items-center\"\n              >\n                <CheckCircle className=\"h-4 w-4 mr-1\" />\n                Close\n              </button>\n              {canDelete && (\n                <button\n                  onClick={handleBulkDelete}\n                  className=\"px-3 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors text-sm inline-flex items-center\"\n                >\n                  <Trash2 className=\"h-4 w-4 mr-1\" />\n                  Delete\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Technician View Toggle */}\n      {isTechnician && (\n        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center\">\n              <Target className=\"h-5 w-5 text-blue-600 mr-2\" />\n              <span className=\"text-sm font-medium text-gray-700\">View Mode:</span>\n            </div>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={() => {\n                  setTechnicianView('my-tickets')\n                  setFilters({ ...filters, status: '' })\n                }}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                  technicianView === 'my-tickets'\n                    ? 'bg-blue-600 text-white shadow-md'\n                    : 'bg-white text-gray-700 hover:bg-gray-100'\n                }`}\n              >\n                📋 My Tickets\n              </button>\n              <button\n                onClick={() => {\n                  setTechnicianView('available')\n                  setFilters({ ...filters, status: 'open' })\n                }}\n                className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${\n                  technicianView === 'available'\n                    ? 'bg-green-600 text-white shadow-md'\n                    : 'bg-white text-gray-700 hover:bg-gray-100'\n                }`}\n              >\n                🆓 Available Tickets\n              </button>\n            </div>\n          </div>\n          <div className=\"mt-3 text-xs text-gray-600\">\n            {technicianView === 'my-tickets' \n              ? '📌 Showing tickets assigned to you' \n              : '🎯 Showing unassigned tickets you can claim'}\n          </div>\n        </div>\n      )}\n\n      {/* Statistics Cards - Grouped by Status Type */}\n      <div className=\"space-y-6\">\n        {/* Row 1: Overview + Active Tickets */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n          <KPICard \n            icon={Ticket} \n            title=\"Total Tickets\" \n            value={stats.total_tickets || 0} \n            color=\"blue\"\n            onClick={() => {\n              setFilters({ search: '', status: '', type: '', priority: '' })\n              setCurrentPage(1)\n            }}\n          />\n          <KPICard \n            icon={FileCheck} \n            title=\"Open\" \n            value={stats.open_tickets || 0} \n            color=\"indigo\"\n            onClick={() => {\n              setFilters({ ...filters, status: filters.status === 'open' ? '' : 'open' })\n              setCurrentPage(1)\n            }}\n          />\n          <KPICard \n            icon={Users} \n            title=\"Assigned\" \n            value={stats.assigned_tickets || 0} \n            color=\"purple\"\n            onClick={() => {\n              setFilters({ ...filters, status: filters.status === 'assigned' ? '' : 'assigned' })\n              setCurrentPage(1)\n            }}\n          />\n          <KPICard \n            icon={PlayCircle} \n            title=\"In Progress\" \n            value={stats.in_progress_tickets || 0} \n            color=\"yellow\"\n            onClick={() => {\n              setFilters({ ...filters, status: filters.status === 'in_progress' ? '' : 'in_progress' })\n              setCurrentPage(1)\n            }}\n          />\n        </div>\n        \n        {/* Row 2: Completed Status */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <KPICard \n            icon={CheckCircle} \n            title=\"Completed\" \n            value={stats.completed_tickets || 0} \n            color=\"green\"\n            onClick={() => {\n              setFilters({ ...filters, status: filters.status === 'completed' ? '' : 'completed' })\n              setCurrentPage(1)\n            }}\n          />\n          <KPICard \n            icon={XCircle} \n            title=\"Cancelled\" \n            value={stats.cancelled_tickets || 0} \n            color=\"red\"\n            onClick={() => {\n              setFilters({ ...filters, status: filters.status === 'cancelled' ? '' : 'cancelled' })\n              setCurrentPage(1)\n            }}\n          />\n        </div>\n      </div>\n\n      {/* Filters */}\n      <div className=\"bg-white shadow rounded-lg p-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n          {/* Search */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Search\n            </label>\n            <div className=\"relative\">\n              <Search className=\"h-4 w-4 absolute left-3 top-3 text-gray-400\" />\n              <input\n                type=\"text\"\n                className=\"form-input pl-10\"\n                placeholder=\"Cari tiket...\"\n                value={filters.search}\n                onChange={(e) => setFilters({ ...filters, search: e.target.value })}\n              />\n            </div>\n          </div>\n\n          {/* Status Filter */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Status\n            </label>\n            <select\n              className=\"form-input\"\n              value={filters.status}\n              onChange={(e) => setFilters({ ...filters, status: e.target.value })}\n            >\n              <option value=\"\">Semua Status</option>\n              <option value=\"open\">Open</option>\n              <option value=\"assigned\">Assigned</option>\n              <option value=\"in_progress\">In Progress</option>\n              <option value=\"on_hold\">On Hold</option>\n              <option value=\"completed\">Completed</option>\n              <option value=\"cancelled\">Cancelled</option>\n            </select>\n          </div>\n\n          {/* Type Filter */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Tipe\n            </label>\n            <select\n              className=\"form-input\"\n              value={filters.type}\n              onChange={(e) => setFilters({ ...filters, type: e.target.value })}\n            >\n              <option value=\"\">Semua Tipe</option>\n              <option value=\"installation\">Installation</option>\n              <option value=\"repair\">Repair</option>\n              <option value=\"maintenance\">Maintenance</option>\n              <option value=\"upgrade\">Upgrade</option>\n              <option value=\"downgrade\">Downgrade</option>\n              <option value=\"wifi_setup\">WiFi Setup</option>\n              <option value=\"dismantle\">Dismantle</option>\n            </select>\n          </div>\n\n          {/* Priority Filter */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              Prioritas\n            </label>\n            <select\n              className=\"form-input\"\n              value={filters.priority}\n              onChange={(e) => setFilters({ ...filters, priority: e.target.value })}\n            >\n              <option value=\"\">Semua Prioritas</option>\n              <option value=\"low\">Low</option>\n              <option value=\"normal\">Normal</option>\n              <option value=\"high\">High</option>\n              <option value=\"critical\">Critical</option>\n            </select>\n          </div>\n        </div>\n      </div>\n\n      {/* Tickets List */}\n      <div className=\"card\">\n        <div className=\"card-header\">\n          <h2 className=\"text-lg font-semibold text-gray-900\">\n            All Tickets\n            {ticketsData?.data && (\n              <span className=\"text-sm font-normal text-gray-500 ml-2\">\n                ({ticketsData.data.pagination.total} total)\n              </span>\n            )}\n          </h2>\n        </div>\n        <div className=\"card-body p-0\">\n          {isLoading ? (\n            <div className=\"py-12\">\n              <LoadingSpinner className=\"mx-auto\" />\n            </div>\n          ) : ticketsData?.data?.tickets?.length > 0 ? (\n            <div className=\"overflow-x-auto\">\n              <table className=\"table w-full\" style={{ tableLayout: 'fixed', minWidth: '1200px' }}>\n                <thead className=\"table-header\">\n                  <tr>\n                    {/* Bulk Selection Checkbox */}\n                    <th className=\"table-header-cell\" style={{ width: '50px' }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={selectAll}\n                        onChange={handleSelectAll}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        title=\"Pilih Semua\"\n                      />\n                    </th>\n                    <th \n                      className=\"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors\"\n                      onClick={() => handleSort('ticket_number')}\n                      style={{ width: '200px' }}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span>Ticket</span>\n                        {getSortIcon('ticket_number')}\n                      </div>\n                    </th>\n                    <th className=\"table-header-cell\" style={{ width: '160px' }}>Customer</th>\n                    <th \n                      className=\"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors\"\n                      onClick={() => handleSort('type')}\n                      style={{ width: '110px' }}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span>Type</span>\n                        {getSortIcon('type')}\n                      </div>\n                    </th>\n                    <th \n                      className=\"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors\"\n                      onClick={() => handleSort('priority')}\n                      style={{ width: '90px' }}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span>Priority</span>\n                        {getSortIcon('priority')}\n                      </div>\n                    </th>\n                    <th \n                      className=\"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors\"\n                      onClick={() => handleSort('status')}\n                      style={{ width: '110px' }}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span>Status</span>\n                        {getSortIcon('status')}\n                      </div>\n                    </th>\n                    <th className=\"table-header-cell\" style={{ width: '140px' }}>Technician</th>\n                    <th \n                      className=\"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors\"\n                      onClick={() => handleSort('created_at')}\n                      style={{ width: '110px' }}\n                    >\n                      <div className=\"flex items-center justify-between\">\n                        <span>Created</span>\n                        {getSortIcon('created_at')}\n                      </div>\n                    </th>\n                    <th className=\"table-header-cell\" style={{ width: '120px' }}>Quick Actions</th>\n                  </tr>\n                </thead>\n                <tbody className=\"table-body\">\n                  {ticketsData.data.tickets.map((ticket) => (\n                    <tr \n                      key={ticket.id}\n                      onClick={() => navigate(`/tickets/${ticket.id}`)}\n                      className=\"group cursor-pointer hover:bg-blue-50 hover:shadow-md hover:border-l-4 hover:border-l-blue-500 transition-all duration-200\"\n                      title=\"Klik untuk lihat detail ticket\"\n                    >\n                      {/* Bulk Selection Checkbox */}\n                      <td \n                        className=\"table-cell\"\n                        onClick={(e) => e.stopPropagation()}\n                      >\n                        <input\n                          type=\"checkbox\"\n                          checked={selectedTickets.includes(ticket.id)}\n                          onChange={() => handleSelectTicket(ticket.id)}\n                          className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                        />\n                      </td>\n\n                      {/* Ticket Number & Title with Copy */}\n                      <td className=\"table-cell\">\n                        <div>\n                          <div className=\"font-medium text-gray-900 flex items-center gap-1\">\n                            <span>{ticket.ticket_number}</span>\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                handleCopyToClipboard(ticket.ticket_number, 'Ticket Number')\n                              }}\n                              className=\"opacity-0 group-hover:opacity-100 p-0.5 hover:bg-gray-200 rounded transition-opacity\"\n                              title=\"Copy Ticket Number\"\n                            >\n                              {copiedField === 'Ticket Number' ? (\n                                <Check className=\"h-3 w-3 text-green-600\" />\n                              ) : (\n                                <Copy className=\"h-3 w-3 text-gray-500\" />\n                              )}\n                            </button>\n                          </div>\n                          <div className=\"text-sm text-gray-500 truncate\" title={ticket.title}>\n                            {ticket.title}\n                          </div>\n                        </div>\n                      </td>\n\n                      {/* Customer with Copy */}\n                      <td className=\"table-cell\">\n                        <div>\n                          <div className=\"font-medium text-gray-900 truncate\" title={ticket.customer_name}>\n                            {ticket.customer_name}\n                          </div>\n                          <div className=\"text-sm text-gray-500 truncate flex items-center gap-1\">\n                            <span>{ticket.customer_phone}</span>\n                            <button\n                              onClick={(e) => {\n                                e.stopPropagation()\n                                handleCopyToClipboard(ticket.customer_phone, 'Phone')\n                              }}\n                              className=\"opacity-0 group-hover:opacity-100 p-0.5 hover:bg-gray-200 rounded transition-opacity\"\n                              title=\"Copy Phone\"\n                            >\n                              {copiedField === 'Phone' ? (\n                                <Check className=\"h-3 w-3 text-green-600\" />\n                              ) : (\n                                <Copy className=\"h-3 w-3 text-gray-500\" />\n                              )}\n                            </button>\n                          </div>\n                        </div>\n                      </td>\n                      <td className=\"table-cell whitespace-nowrap\" style={{ width: '110px' }}>\n                        <span className=\"capitalize\">{formatTypeName(ticket.type)}</span>\n                      </td>\n                      <td className=\"table-cell whitespace-nowrap\">\n                        {getPriorityBadge(ticket.priority)}\n                      </td>\n                      <td className=\"table-cell whitespace-nowrap\">\n                        {getStatusBadge(ticket.status)}\n                      </td>\n                      <td className=\"table-cell\">\n                        {ticket.technician_name ? (\n                          <div>\n                            <div className=\"font-medium text-gray-900 truncate\" title={ticket.technician_name}>\n                              {ticket.technician_name}\n                            </div>\n                            <div className=\"text-sm text-gray-500 truncate\">\n                              {ticket.employee_id}\n                            </div>\n                          </div>\n                        ) : (\n                          <span className=\"text-gray-400\">Unassigned</span>\n                        )}\n                      </td>\n                      <td className=\"table-cell whitespace-nowrap\" style={{ width: '110px' }}>\n                        <div className=\"text-sm text-gray-900\">\n                          {new Date(ticket.created_at).toLocaleDateString()}\n                        </div>\n                        <div className=\"text-sm text-gray-500\">\n                          {new Date(ticket.created_at).toLocaleTimeString()}\n                        </div>\n                      </td>\n\n                      {/* Quick Actions (appear on hover) */}\n                      <td \n                        className=\"table-cell\"\n                        onClick={(e) => e.stopPropagation()}\n                      >\n                        <div className=\"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity\">\n                          {/* Quick Call */}\n                          {ticket.customer_phone && (\n                            <button\n                              onClick={(e) => handleQuickCall(e, ticket.customer_phone)}\n                              className=\"p-1.5 hover:bg-green-100 rounded transition-colors\"\n                              title=\"Call Customer\"\n                            >\n                              <PhoneCall className=\"h-4 w-4 text-green-600\" />\n                            </button>\n                          )}\n\n                          {/* Quick Assign - Admin/Supervisor */}\n                          {canAssign && ticket.status !== 'completed' && ticket.status !== 'cancelled' && (\n                            <>\n                              <button\n                                onClick={(e) => handleQuickAssign(e, ticket)}\n                                className=\"p-1.5 hover:bg-purple-100 rounded transition-colors\"\n                                title=\"Assign Single Technician\"\n                              >\n                                <UserPlus className=\"h-4 w-4 text-purple-600\" />\n                              </button>\n                              <button\n                                onClick={(e) => handleQuickTeamAssign(e, ticket)}\n                                className=\"p-1.5 hover:bg-blue-100 rounded transition-colors\"\n                                title=\"Assign Team (Multiple Technicians)\"\n                              >\n                                <Users className=\"h-4 w-4 text-blue-600\" />\n                              </button>\n                            </>\n                          )}\n\n                          {/* Assign to Me - Technician Only */}\n                          {isTechnician && ticket.status === 'open' && !ticket.assigned_technician_id && (\n                            <button\n                              onClick={async (e) => {\n                                e.stopPropagation()\n                                try {\n                                  // Get my technician profile\n                                  const techResponse = await fetch(`/api/technicians?user_id=${currentUser.id}`, {\n                                    headers: {\n                                      'Authorization': `Bearer ${localStorage.getItem('token')}`\n                                    }\n                                  })\n                                  const techData = await techResponse.json()\n                                  const myTechProfile = techData?.data?.technicians?.[0]\n                                  \n                                  if (!myTechProfile) {\n                                    toast.error('Technician profile not found')\n                                    return\n                                  }\n\n                                  // Assign ticket to me\n                                  await ticketService.assignTicket(ticket.id, myTechProfile.id)\n                                  toast.success('Ticket assigned to you!')\n                                  refetch()\n                                } catch (error) {\n                                  toast.error(error.response?.data?.message || 'Failed to assign ticket')\n                                }\n                              }}\n                              className=\"p-1.5 hover:bg-blue-100 rounded transition-colors\"\n                              title=\"Assign to Me\"\n                            >\n                              <User className=\"h-4 w-4 text-blue-600\" />\n                            </button>\n                          )}\n\n                          {/* Quick Complete */}\n                          {ticket.status !== 'completed' && ticket.status !== 'cancelled' && (\n                            <button\n                              onClick={(e) => handleQuickComplete(e, ticket)}\n                              className=\"p-1.5 hover:bg-green-100 rounded transition-colors\"\n                              title=\"Mark as Completed\"\n                            >\n                              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n                            </button>\n                          )}\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          ) : (\n            <div className=\"text-center py-12\">\n              <Ticket className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h3 className=\"text-lg font-medium text-gray-900 mb-2\">No tickets found</h3>\n              <p className=\"text-gray-500 mb-4\">\n                Get started by creating your first ticket.\n              </p>\n              <button \n                onClick={() => setShowCreateForm(true)}\n                className=\"btn-primary\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Create First Ticket\n              </button>\n            </div>\n          )}\n        </div>\n        \n        {/* Pagination */}\n        {ticketsData?.data?.tickets?.length > 0 && ticketsData?.data?.pagination && (\n          <div className=\"bg-white border-t border-gray-200 px-6 py-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex-1 flex justify-between sm:hidden\">\n                <button\n                  onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                  disabled={currentPage === 1}\n                  className=\"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Previous\n                </button>\n                <button\n                  onClick={() => setCurrentPage(Math.min(ticketsData.data.pagination.pages, currentPage + 1))}\n                  disabled={currentPage === ticketsData.data.pagination.pages}\n                  className=\"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  Next\n                </button>\n              </div>\n              <div className=\"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"flex items-center gap-2\">\n                    <label className=\"text-sm text-gray-700\">Show</label>\n                    <select\n                      value={limit}\n                      onChange={(e) => {\n                        setLimit(parseInt(e.target.value))\n                        setCurrentPage(1)\n                      }}\n                      className=\"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500\"\n                    >\n                      <option value=\"10\">10</option>\n                      <option value=\"25\">25</option>\n                      <option value=\"50\">50</option>\n                      <option value=\"100\">100</option>\n                    </select>\n                    <span className=\"text-sm text-gray-700\">rows</span>\n                  </div>\n                  <div className=\"border-l border-gray-300 h-6\"></div>\n                  <p className=\"text-sm text-gray-700\">\n                    Showing <span className=\"font-medium\">{((currentPage - 1) * limit) + 1}</span> to{' '}\n                    <span className=\"font-medium\">\n                      {Math.min(currentPage * limit, ticketsData.data.pagination.total)}\n                    </span>{' '}\n                    of <span className=\"font-medium\">{ticketsData.data.pagination.total}</span> results\n                  </p>\n                </div>\n                <div>\n                  <nav className=\"relative z-0 inline-flex rounded-md shadow-sm -space-x-px\" aria-label=\"Pagination\">\n                    <button\n                      onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\n                      disabled={currentPage === 1}\n                      className=\"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      <ChevronLeft className=\"h-5 w-5\" />\n                    </button>\n                    {Array.from({ length: Math.min(ticketsData.data.pagination.pages, 10) }, (_, i) => {\n                      const totalPages = ticketsData.data.pagination.pages;\n                      if (totalPages <= 10) return i + 1;\n                      if (currentPage <= 5) return i + 1;\n                      if (currentPage >= totalPages - 4) return totalPages - 9 + i;\n                      return currentPage - 5 + i;\n                    }).map((page) => (\n                      <button\n                        key={page}\n                        onClick={() => setCurrentPage(page)}\n                        className={`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${\n                          currentPage === page\n                            ? 'z-10 bg-blue-50 border-blue-500 text-blue-600'\n                            : 'bg-white border-gray-300 text-gray-500 hover:bg-gray-50'\n                        }`}\n                      >\n                        {page}\n                      </button>\n                    ))}\n                    <button\n                      onClick={() => setCurrentPage(Math.min(ticketsData.data.pagination.pages, currentPage + 1))}\n                      disabled={currentPage === ticketsData.data.pagination.pages}\n                      className=\"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\"\n                    >\n                      <ChevronRight className=\"h-5 w-5\" />\n                    </button>\n                  </nav>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Create Ticket Form Modal */}\n      <TicketCreateForm\n        isOpen={showCreateForm}\n        onClose={() => setShowCreateForm(false)}\n        onSuccess={handleCreateSuccess}\n      />\n\n      {/* Smart Assignment Modal */}\n      <SmartAssignmentModal\n        isOpen={showAssignmentModal}\n        onClose={closeAssignmentModal}\n        ticket={selectedTicketForAssignment}\n      />\n\n      {/* Team Assignment Modal (Multi-Technician) */}\n      <TeamAssignmentModal\n        isOpen={showTeamAssignmentModal}\n        onClose={() => {\n          setShowTeamAssignmentModal(false);\n          setSelectedTicketForAssignment(null);\n        }}\n        ticket={selectedTicketForAssignment}\n      />\n    </div>\n  )\n}\n\nexport default TicketsPage\n","import api from './api'\n\nconst odpService = {\n  getAll: async (params = {}) => {\n    try {\n      const queryParams = new URLSearchParams()\n      \n      if (params.status) queryParams.append('status', params.status)\n      if (params.area) queryParams.append('area', params.area)\n      if (params.search) queryParams.append('search', params.search)\n      if (params.page) queryParams.append('page', params.page)\n      if (params.limit) queryParams.append('limit', params.limit)\n      if (params.sort_by) queryParams.append('sort_by', params.sort_by)\n      if (params.sort_order) queryParams.append('sort_order', params.sort_order)\n      \n      const queryString = queryParams.toString()\n      const response = await api.get(`/odp${queryString ? '?' + queryString : ''}`)\n      return response\n    } catch (error) {\n      console.error('❌ ODPService error:', error)\n      return { data: [], pagination: {} }\n    }\n  },\n\n  getById: async (id) => {\n    return await api.get(`/odp/${id}`)\n  },\n\n  create: async (data) => {\n    return await api.post('/odp', data)\n  },\n\n  update: async (id, data) => {\n    return await api.put(`/odp/${id}`, data)\n  },\n\n  delete: async (id) => {\n    return await api.delete(`/odp/${id}`)\n  }\n}\n\nexport default odpService\n\n","import React, { useState, useEffect } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { Clock, CheckCircle, XCircle, Pause, Play, Upload, Image as ImageIcon } from 'lucide-react'\nimport { useAuth } from '../contexts/AuthContext'\nimport LoadingSpinner from './LoadingSpinner'\nimport { useQuery } from 'react-query'\nimport { technicianService } from '../services/technicianService'\nimport odpService from '../services/odpService'\nimport packageService from '../services/packageService'\n\nconst StatusUpdateForm = ({ ticket, onUpdate, isLoading, preSelectedStatus, onStatusPreSelected }) => {\n  const { user } = useAuth()\n  const [selectedStatus, setSelectedStatus] = useState(ticket.status)\n  const [selectedTechnician, setSelectedTechnician] = useState(ticket.assigned_technician_id || '')\n  \n  // Auto-select status if pre-selected from Quick Actions\n  useEffect(() => {\n    if (preSelectedStatus) {\n      setSelectedStatus(preSelectedStatus)\n      // Call callback to clear pre-selected status\n      if (onStatusPreSelected) {\n        onStatusPreSelected()\n      }\n    }\n  }, [preSelectedStatus, onStatusPreSelected])\n  \n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    reset,\n    watch,\n    setValue\n  } = useForm()\n  \n  // Fetch ODP list for dropdown\n  const { data: odpList, isLoading: odpLoading, error: odpError } = useQuery(\n    'odp-active',\n    () => odpService.getAll(),\n    {\n      refetchOnWindowFocus: false,\n      select: (response) => {\n        console.log('🔍 ODP API Response:', response)\n        \n        // Extract array from response.data\n        const odpArray = Array.isArray(response?.data) ? response.data : []\n        console.log('📦 ODP Array:', odpArray)\n        \n        // Filter only active ODPs\n        const activeOdps = odpArray.filter(odp => odp.status === 'active')\n        console.log('✅ Active ODPs:', activeOdps)\n        \n        return activeOdps\n      }\n    }\n  )\n  \n  // Fetch packages for upgrade/downgrade\n  const { data: packagesList, isLoading: packagesLoading, error: packagesError } = useQuery(\n    'packages-active',\n    () => packageService.getAll(),\n    {\n      refetchOnWindowFocus: false,\n      enabled: ticket.type === 'upgrade' || ticket.type === 'downgrade',\n      select: (data) => {\n        // packageService.getAll() returns array directly\n        // Backend already filters by is_active = true, so no need to filter again\n        const packages = Array.isArray(data) ? data : []\n        return packages\n      }\n    }\n  )\n  \n  // State for image previews (managed directly in onChange handlers)\n  const [otdrPreview, setOtdrPreview] = useState(null)\n  const [attenuationPreview, setAttenuationPreview] = useState(null)\n  const [modemSnPreview, setModemSnPreview] = useState(null)\n  \n  // Store file objects for display info (filename, size)\n  const [otdrFile, setOtdrFile] = useState(null)\n  const [attenuationFile, setAttenuationFile] = useState(null)\n  const [modemSnFile, setModemSnFile] = useState(null)\n\n  // Auto-fill dates when status changes to 'completed'\n  useEffect(() => {\n    if (selectedStatus === 'completed') {\n      const now = new Date()\n      const year = now.getFullYear()\n      const month = String(now.getMonth() + 1).padStart(2, '0')\n      const day = String(now.getDate()).padStart(2, '0')\n      const hours = String(now.getHours()).padStart(2, '0')\n      const minutes = String(now.getMinutes()).padStart(2, '0')\n      \n      const datetimeLocal = `${year}-${month}-${day}T${hours}:${minutes}`\n      \n      // Auto-fill activation_date for installation\n      if (ticket.type === 'installation') {\n        setValue('activation_date', datetimeLocal)\n      }\n      \n      // Auto-fill repair_date for repair & maintenance\n      if (ticket.type === 'repair' || ticket.type === 'maintenance') {\n        setValue('repair_date', datetimeLocal)\n      }\n    }\n  }, [selectedStatus, ticket.type, setValue])\n\n  // Fetch available technicians ketika status berubah ke 'assigned'\n  // Fetch technicians kapan pun status 'assigned' dipilih (untuk assign & re-assign)\n  const { data: techniciansData, isLoading: techniciansLoading } = useQuery(\n    'available-technicians',\n    () => technicianService.getAvailableTechnicians(),\n    { enabled: selectedStatus === 'assigned' }\n  )\n\n  const statusOptions = [\n    { \n      value: 'open', \n      label: 'Open', \n      icon: Clock, \n      color: 'text-blue-600',\n      bgColor: 'bg-blue-100',\n      description: 'Ticket is open and waiting for assignment'\n    },\n    { \n      value: 'assigned', \n      label: 'Assigned', \n      icon: Play, \n      color: 'text-yellow-600',\n      bgColor: 'bg-yellow-100',\n      description: 'Ticket has been assigned to a technician'\n    },\n    { \n      value: 'in_progress', \n      label: 'In Progress', \n      icon: Play, \n      color: 'text-orange-600',\n      bgColor: 'bg-orange-100',\n      description: 'Work is currently being performed'\n    },\n    { \n      value: 'completed', \n      label: 'Completed', \n      icon: CheckCircle, \n      color: 'text-green-600',\n      bgColor: 'bg-green-100',\n      description: 'Work has been completed successfully'\n    },\n    { \n      value: 'on_hold', \n      label: 'On Hold', \n      icon: Pause, \n      color: 'text-gray-600',\n      bgColor: 'bg-gray-100',\n      description: 'Work is temporarily paused'\n    },\n    { \n      value: 'cancelled', \n      label: 'Cancelled', \n      icon: XCircle, \n      color: 'text-red-600',\n      bgColor: 'bg-red-100',\n      description: 'Ticket has been cancelled'\n    }\n  ]\n\n  // Filter available status transitions based on current status and user role\n  const getAvailableStatuses = () => {\n    const currentStatus = ticket.status\n    const userRole = user?.role\n    const isAssigned = !!ticket.assigned_technician_id\n\n    // Workflow rules:\n    // 1. 'open' can only transition to 'assigned' or 'cancelled'\n    // 2. 'assigned' can transition to 'in_progress', 'on_hold', 'cancelled'\n    // 3. 'in_progress' can transition to 'completed', 'on_hold', 'cancelled'\n    // 4. 'on_hold' can transition back to 'in_progress'\n    // 5. 'completed' and 'cancelled' are terminal states\n    // 6. TIDAK BOLEH kembali ke 'open' setelah status berubah\n\n    const workflowTransitions = {\n      'open': ['assigned', 'cancelled'],\n      'assigned': ['in_progress', 'on_hold', 'cancelled'],\n      'in_progress': ['completed', 'on_hold', 'cancelled'],\n      'on_hold': ['in_progress', 'cancelled'],\n      'completed': [], // terminal\n      'cancelled': []  // terminal\n    }\n\n    // Get allowed transitions for current status\n    let allowedStatuses = workflowTransitions[currentStatus] || []\n\n    // Additional rules:\n    // - 'completed' hanya bisa dipilih jika sudah 'in_progress'\n    if (currentStatus !== 'in_progress' && currentStatus !== 'on_hold') {\n      allowedStatuses = allowedStatuses.filter(s => s !== 'completed')\n    }\n\n    // - 'assigned' memerlukan teknisi assigned (akan handle di form validation)\n    \n    // Admin and supervisor have more flexibility but still follow workflow\n    if (userRole === 'admin' || userRole === 'supervisor') {\n      // Admin bisa skip ke status manapun kecuali kembali ke 'open'\n      return statusOptions.filter(status => {\n        // Current status always shown (disabled)\n        if (status.value === currentStatus) return true\n        \n        // Completed states can't be changed\n        if (currentStatus === 'completed' || currentStatus === 'cancelled') return false\n        \n        // Can't go back to 'open'\n        if (status.value === 'open') return false\n        \n        // Allow workflow transitions\n        return allowedStatuses.includes(status.value)\n      })\n    }\n\n    // Technician can only update their assigned tickets\n    if (userRole === 'technician') {\n      return statusOptions.filter(status => \n        status.value === currentStatus || allowedStatuses.includes(status.value)\n      )\n    }\n\n    // Customer service follows strict workflow\n    if (userRole === 'customer_service') {\n      return statusOptions.filter(status => \n        status.value === currentStatus || allowedStatuses.includes(status.value)\n      )\n    }\n\n    return statusOptions.filter(status => \n      status.value === currentStatus || allowedStatuses.includes(status.value)\n    )\n  }\n\n  const availableStatuses = getAvailableStatuses()\n\n  // Helper function to convert file to base64\n  const fileToBase64 = (file) => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader()\n      reader.readAsDataURL(file)\n      reader.onload = () => resolve(reader.result)\n      reader.onerror = (error) => reject(error)\n    })\n  }\n\n  const onSubmit = async (data) => {\n    console.log('=== FORM SUBMIT STARTED ===');\n    console.log('Form data:', data);\n    console.log('Selected status:', selectedStatus);\n    \n    // Manual validation for file uploads (when status = completed & type = installation)\n    if (selectedStatus === 'completed' && ticket.type === 'installation') {\n      console.log('🔍 [VALIDATION] Checking required files...');\n      console.log('🔍 [VALIDATION] otdrFile:', otdrFile);\n      console.log('🔍 [VALIDATION] attenuationFile:', attenuationFile);\n      console.log('🔍 [VALIDATION] modemSnFile:', modemSnFile);\n      console.log('🔍 [VALIDATION] data.otdr_photo:', data.otdr_photo);\n      console.log('🔍 [VALIDATION] data.attenuation_photo:', data.attenuation_photo);\n      console.log('🔍 [VALIDATION] data.modem_sn_photo:', data.modem_sn_photo);\n      \n      if (!otdrFile) {\n        console.log('❌ [VALIDATION] OTDR file missing!');\n        alert('Foto OTDR is required');\n        return;\n      }\n      if (!attenuationFile) {\n        console.log('❌ [VALIDATION] Attenuation file missing!');\n        alert('Foto Redaman Terakhir is required');\n        return;\n      }\n      if (!modemSnFile) {\n        console.log('❌ [VALIDATION] Modem SN file missing!');\n        alert('Foto SN Modem is required');\n        return;\n      }\n      console.log('✅ All required files validated:', {\n        otdr: otdrFile.name,\n        attenuation: attenuationFile.name,\n        modemSn: modemSnFile.name\n      });\n    }\n    \n    // Validation: jika pilih 'assigned' dari status 'open', harus pilih teknisi\n    if (selectedStatus === 'assigned' && ticket.status === 'open' && !selectedTechnician) {\n      alert('Please select a technician when assigning the ticket for the first time')\n      return\n    }\n\n    // PHASE 1: Conditional Smart Notes - Contextual & Informative\n    const autoGenerateNotes = () => {\n      console.log('📝 [AUTO-NOTES] Starting auto-generation...');\n      console.log('📝 [AUTO-NOTES] Custom notes provided?', !!data.notes?.trim());\n      if (data.notes && data.notes.trim()) {\n        console.log('📝 [AUTO-NOTES] Using custom notes');\n        return data.notes\n      }\n      \n      // Extract contextual data\n      const customerName = ticket.customer_name || 'Customer'\n      const customerId = ticket.customer_code || ticket.customer_id || ''\n      const ticketType = ticket.type || 'general'\n      const ticketTypeName = ticket.type_name || ticket.type || 'Ticket'\n      const ticketId = ticket.ticket_number || ticket.id\n      const oldStatus = ticket.status\n      const newStatus = selectedStatus\n      \n      console.log('📝 [AUTO-NOTES] Context:', {\n        customerName,\n        ticketType,\n        oldStatus,\n        newStatus,\n        ticketId\n      })\n      \n      const customerAddress = ticket.customer_address || ''\n      const packageName = ticket.package_name || ''\n      const bandwidth = ticket.bandwidth_down || ticket.bandwidth_up || ''\n      \n      // Get technician info\n      let technicianName = ''\n      let technicianId = ''\n      \n      // First try to get from selected technician (for new assignments)\n      if (selectedTechnician && techniciansData?.data?.technicians) {\n        console.log('📝 [AUTO-NOTES] Looking up technician, selectedTechnician:', selectedTechnician);\n        console.log('📝 [AUTO-NOTES] Available technicians:', techniciansData.data.technicians.length);\n        const tech = techniciansData.data.technicians.find(t => t.id === parseInt(selectedTechnician))\n        if (tech) {\n          technicianName = tech.full_name\n          technicianId = tech.employee_id\n          console.log('📝 [AUTO-NOTES] Found technician:', technicianName);\n        } else {\n          console.log('📝 [AUTO-NOTES] Technician not found in list');\n        }\n      }\n      \n      // Fallback to current ticket technician (for status updates)\n      if (!technicianName && ticket.technician_name) {\n        technicianName = ticket.technician_name\n        technicianId = ticket.technician_employee_id || ''\n        console.log('📝 [AUTO-NOTES] Using ticket technician:', technicianName);\n      }\n      \n      // Helper: Format date time\n      const formatDateTime = (date) => {\n        const d = new Date(date)\n        const day = String(d.getDate()).padStart(2, '0')\n        const month = String(d.getMonth() + 1).padStart(2, '0')\n        const year = d.getFullYear()\n        const hours = String(d.getHours()).padStart(2, '0')\n        const minutes = String(d.getMinutes()).padStart(2, '0')\n        return `${day}/${month}/${year} ${hours}:${minutes}`\n      }\n      \n      // Helper: Calculate target completion\n      const calculateTargetCompletion = (estimatedMinutes) => {\n        const now = new Date()\n        const target = new Date(now.getTime() + estimatedMinutes * 60000)\n        return formatDateTime(target)\n      }\n      \n      // Helper: Get equipment list by ticket type\n      const getEquipmentList = (type) => {\n        const equipment = {\n          installation: 'Dropcore fiber 50m, ONU/ONT, Patchcord LC-SC 3m, Rosette, Cable ties, Weatherproofing kit',\n          maintenance: 'OTDR, Power meter, Spare connectors, Cleaning kit, Patchcords',\n          upgrade: 'ONU (jika diperlukan), Configuration tools',\n          downgrade: 'Configuration tools, Billing system access',\n          relocation: 'Dropcore fiber, Patchcords, Cable management tools',\n          troubleshooting: 'OTDR, Power meter, Signal tester, Spare parts'\n        }\n        return equipment[type] || 'Standard technician toolkit'\n      }\n      \n      // Helper: Get estimated duration by ticket type\n      const getEstimatedDuration = (type) => {\n        const durations = {\n          installation: 120,\n          maintenance: 90,\n          upgrade: 45,\n          downgrade: 30,\n          relocation: 180,\n          troubleshooting: 60\n        }\n        return durations[type] || 60\n      }\n      \n      // Helper: Format SLA date\n      const formatSLA = () => {\n        if (ticket.sla_due_date) {\n          const sla = new Date(ticket.sla_due_date)\n          const now = new Date()\n          const diffHours = Math.floor((sla - now) / (1000 * 60 * 60))\n          const diffDays = Math.floor(diffHours / 24)\n          \n          if (diffDays > 1) {\n            return `${formatDateTime(sla)} (${diffDays} hari lagi)`\n          } else if (diffHours > 0) {\n            return `${formatDateTime(sla)} (${diffHours} jam lagi)`\n          } else {\n            return `${formatDateTime(sla)} (⚠️ URGENT)`\n          }\n        }\n        return 'Not set'\n      }\n      \n      // Conditional logic per ticket type and status\n      const ticketTypeKey = ticketType.toLowerCase()\n      \n      // ASSIGNED Status\n      if (newStatus === 'assigned') {\n        console.log('📝 [AUTO-NOTES] Generating ASSIGNED notes, technicianName:', technicianName);\n        if (oldStatus === 'open' && technicianName) {\n          const notes = `📋 TICKET ASSIGNMENT\\n\\nTiket ${ticketTypeName} (${ticketId}) berhasil di-assign.\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${customerAddress ? `\\nLokasi: ${customerAddress}` : ''}${packageName ? `\\nPackage: ${packageName}` : ''}\\n\\nStatus berubah: \"${oldStatus}\" → \"Assigned\"\\n\\nTeknisi akan segera menghubungi customer untuk koordinasi jadwal pekerjaan. Estimasi penyelesaian: ${getEstimatedDuration(ticketTypeKey)} menit setelah mulai dikerjakan.`\n          console.log('📝 [AUTO-NOTES] Generated:', notes.substring(0, 100) + '...');\n          return notes\n        } else if (technicianName) {\n          return `🔄 RE-ASSIGNMENT\\n\\nTiket ${ticketTypeName} (${ticketId}) di-assign ulang.\\n\\nTeknisi Baru: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\n\\nStatus: \"${oldStatus}\" → \"Assigned\"\\n\\nProses penanganan akan dilanjutkan oleh teknisi yang baru. Koordinasi dengan customer akan segera dilakukan.`\n        }\n      }\n      \n      // IN_PROGRESS Status - Conditional by ticket type\n      if (newStatus === 'in_progress') {\n        console.log('📝 [AUTO-NOTES] Generating IN_PROGRESS notes, ticketType:', ticketTypeKey);\n        const currentTime = formatDateTime(new Date())\n        const estimatedDuration = getEstimatedDuration(ticketTypeKey)\n        const targetTime = calculateTargetCompletion(estimatedDuration)\n        const equipment = getEquipmentList(ticketTypeKey)\n        \n        if (ticketTypeKey === 'installation') {\n          return `🔧 INSTALLATION DIMULAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${customerAddress ? `\\nLokasi: ${customerAddress}` : ''}${packageName && bandwidth ? `\\nPackage: ${packageName} (${bandwidth} Mbps)` : packageName ? `\\nPackage: ${packageName}` : ''}\\n\\nEquipment: ${equipment}\\n\\nTimeline:\\n- Mulai: ${currentTime}\\n- Target selesai: ${targetTime} (estimasi ${estimatedDuration} menit)\\n- SLA Deadline: ${formatSLA()}\\n\\nStatus: \"${oldStatus}\" → \"In Progress\"\\n\\nPekerjaan pemasangan fiber optic sedang berlangsung. Teknisi sedang melakukan routing kabel dan instalasi perangkat dengan monitoring signal quality.`\n        }\n        \n        if (ticketTypeKey === 'maintenance') {\n          return `🔧 MAINTENANCE DIMULAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${customerAddress ? `\\nLokasi: ${customerAddress}` : ''}\\nIssue: ${ticket.category_name || 'Maintenance diperlukan'}\\n\\nDiagnostic Tools: ${equipment}\\n\\nTimeline:\\n- Mulai: ${currentTime}\\n- Target resolusi: ${targetTime} (estimasi ${estimatedDuration} menit)\\n- SLA Deadline: ${formatSLA()}\\n\\nStatus: \"${oldStatus}\" → \"In Progress\"\\n\\nTeknisi sedang melakukan troubleshooting dan diagnosis untuk identifikasi akar masalah. Signal testing dan measurement sedang berlangsung.`\n        }\n        \n        if (ticketTypeKey === 'upgrade') {\n          return `📈 UPGRADE SERVICE DIMULAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${packageName ? `\\nNew Package: ${packageName}` : ''}\\n\\nConfiguration Tools: ${equipment}\\n\\nTimeline:\\n- Mulai: ${currentTime}\\n- Target selesai: ${targetTime} (estimasi ${estimatedDuration} menit)\\n- SLA Deadline: ${formatSLA()}\\n\\nStatus: \"${oldStatus}\" → \"In Progress\"\\n\\nTeknisi sedang melakukan rekonfigurasi bandwidth dan update service plan. Perubahan konfigurasi di ONU dan core network sedang berlangsung.`\n        }\n        \n        if (ticketTypeKey === 'downgrade') {\n          return `📉 DOWNGRADE SERVICE DIMULAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${packageName ? `\\nNew Package: ${packageName}` : ''}\\n\\nTimeline:\\n- Mulai: ${currentTime}\\n- Target selesai: ${targetTime} (estimasi ${estimatedDuration} menit)\\n\\nStatus: \"${oldStatus}\" → \"In Progress\"\\n\\nTeknisi sedang melakukan adjustment bandwidth sesuai package baru. Konfigurasi service plan sedang diupdate di system.`\n        }\n        \n        // Default for other types\n        return `🔧 PEKERJAAN DIMULAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${customerAddress ? `\\nLokasi: ${customerAddress}` : ''}\\nTipe: ${ticketTypeName}\\n\\nEquipment: ${equipment}\\n\\nTimeline:\\n- Mulai: ${currentTime}\\n- Target selesai: ${targetTime} (estimasi ${estimatedDuration} menit)\\n- SLA Deadline: ${formatSLA()}\\n\\nStatus: \"${oldStatus}\" → \"In Progress\"\\n\\nPekerjaan ${ticketTypeName} sedang berlangsung. Teknisi sedang aktif di lokasi customer.`\n      }\n      \n      // COMPLETED Status - Conditional by ticket type\n      if (newStatus === 'completed') {\n        const completionTime = formatDateTime(new Date())\n        \n        if (ticketTypeKey === 'installation') {\n          return `✅ INSTALLATION SELESAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\nCompletion: ${completionTime}\\n\\nInstallation Summary:\\n✓ Fiber optic installed & terminated\\n✓ ONU configured & activated${packageName ? `\\n✓ Service: ${packageName}` : ''}\\n✓ Signal testing completed\\n✓ Speed test passed\\n✓ Customer demo & acceptance completed\\n\\nStatus: \"${oldStatus}\" → \"Completed\"\\n\\nInstalasi telah selesai dengan sukses. Layanan internet sudah aktif dan customer telah menerima demo penggunaan. Ticket ditutup.`\n        }\n        \n        if (ticketTypeKey === 'maintenance') {\n          return `✅ MAINTENANCE SELESAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\nCompletion: ${completionTime}\\n\\nResolution Summary:\\n✓ Problem identified & resolved\\n✓ Signal strength restored to normal\\n✓ Service testing completed\\n✓ Connectivity stable\\n✓ Customer confirmation received\\n\\nStatus: \"${oldStatus}\" → \"Completed\"\\n\\nMasalah berhasil diselesaikan. Service kembali normal dan customer confirm satisfied. Ticket ditutup.`\n        }\n        \n        if (ticketTypeKey === 'upgrade') {\n          return `✅ UPGRADE SELESAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\nCompletion: ${completionTime}\\n\\nUpgrade Summary:\\n✓ Bandwidth reconfigured${packageName ? `\\n✓ New package: ${packageName}` : ''}\\n✓ Speed test passed\\n✓ Billing system synced\\n✓ Customer notified\\n\\nStatus: \"${oldStatus}\" → \"Completed\"\\n\\nUpgrade service berhasil diselesaikan. Package baru sudah aktif dan speed sesuai target. Ticket ditutup.`\n        }\n        \n        return `✅ PEKERJAAN SELESAI\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\nTipe: ${ticketTypeName}\\nCompletion: ${completionTime}\\n\\nStatus: \"${oldStatus}\" → \"Completed\"\\n\\n${ticketTypeName} untuk ${customerName} telah selesai dikerjakan dengan baik. Semua pekerjaan telah diselesaikan sesuai SLA. Ticket ditutup.`\n      }\n      \n      // ON_HOLD Status\n      if (newStatus === 'on_hold') {\n        return `⏸️ PEKERJAAN DITUNDA\\n\\nTeknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\nTipe: ${ticketTypeName}\\n\\nStatus: \"${oldStatus}\" → \"On Hold\"\\n\\nPekerjaan ${ticketTypeName} ditunda sementara. Menunggu:\\n- Informasi tambahan dari customer, atau\\n- Material/equipment yang diperlukan, atau\\n- Konfirmasi dari dispatcher/management\\n\\nPekerjaan akan dilanjutkan setelah requirement terpenuhi. Ticket tetap di-monitor.`\n      }\n      \n      // CANCELLED Status\n      if (newStatus === 'cancelled') {\n        return `❌ TICKET DIBATALKAN\\n\\nTiket: ${ticketTypeName} (${ticketId})\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\nCancelled: ${formatDateTime(new Date())}\\n\\nStatus: \"${oldStatus}\" → \"Cancelled\"\\n\\nTiket dibatalkan karena:\\n- Request dari customer, atau\\n- Tidak feasible secara teknis, atau\\n- Duplicate ticket, atau\\n- Alasan lainnya\\n\\nMohon hubungi dispatcher untuk informasi lebih lanjut jika diperlukan.`\n      }\n      \n      // OPEN Status\n      if (newStatus === 'open') {\n        return `📋 TICKET DIBUKA KEMBALI\\n\\nTiket: ${ticketTypeName} (${ticketId})\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}${customerAddress ? `\\nLokasi: ${customerAddress}` : ''}\\n\\nStatus: \"${oldStatus}\" → \"Open\"\\n\\nTiket dibuka kembali dan menunggu assignment ke teknisi. Perlu tindak lanjut segera.\\nSLA Deadline: ${formatSLA()}`\n      }\n      \n      // Fallback for any other status\n      return `📝 STATUS UPDATE\\n\\nTiket: ${ticketTypeName} (${ticketId})\\nCustomer: ${customerName}${customerId ? ` (${customerId})` : ''}\\n\\nStatus berubah: \"${oldStatus}\" → \"${newStatus}\"\\n\\n${technicianName ? `Teknisi: ${technicianName}${technicianId ? ` (${technicianId})` : ''}\\n` : ''}Update pada: ${formatDateTime(new Date())}`\n    }\n\n    // Auto-generate resolution notes untuk completed status\n    const autoGenerateResolutionNotes = () => {\n      // If user provided custom notes, use those\n      if (data.resolution_notes && data.resolution_notes.trim()) return data.resolution_notes\n      \n      // Only auto-generate for completed status\n      if (selectedStatus !== 'completed') return undefined\n      \n      const ticketType = (ticket.type || 'general').toLowerCase()\n      const customerName = ticket.customer_name || 'Customer'\n      const packageName = ticket.package_name || ''\n      const bandwidth = ticket.bandwidth_down || ticket.bandwidth_up || ''\n      const technicianName = ticket.technician_name || 'Technician'\n      \n      // Generate resolution based on ticket type\n      switch(ticketType) {\n        case 'installation':\n          return `Installation untuk ${customerName} telah selesai dengan sukses. Fiber optic telah terpasang dengan baik dan signal quality dalam kondisi optimal. ONU telah dikonfigurasi${packageName ? ` untuk package ${packageName}` : ''}${bandwidth ? ` dengan bandwidth ${bandwidth} Mbps` : ''}. Speed test menunjukkan hasil sesuai spesifikasi. Customer telah menerima perangkat dalam kondisi baik, menerima demo penggunaan layanan, dan menandatangani berita acara serah terima. Layanan internet sudah aktif dan berjalan normal. Tidak ada issue yang ditemukan. Ticket ditutup dengan status completed.`\n        \n        case 'maintenance':\n        case 'troubleshooting':\n          return `Issue pada layanan ${customerName} berhasil diselesaikan. Root cause telah diidentifikasi dan diperbaiki. Signal strength telah kembali normal dan koneksi stabil. Testing dilakukan untuk memastikan tidak ada packet loss atau latency berlebih. Service telah berjalan dengan baik dan customer confirm bahwa masalah sudah teratasi. Pekerjaan maintenance selesai tanpa kendala. Ticket ditutup dengan status resolved.`\n        \n        case 'upgrade':\n          return `Upgrade package untuk ${customerName} berhasil diselesaikan.${packageName ? ` New package ${packageName}` : ' Package baru'}${bandwidth ? ` dengan bandwidth ${bandwidth} Mbps` : ''} telah aktif dan berjalan normal. Rekonfigurasi bandwidth dilakukan di ONU dan core network. Speed test menunjukkan hasil sesuai dengan package baru. Billing system telah disinkronisasi dengan perubahan package. Customer telah diberitahu tentang perubahan layanan dan menerima konfirmasi aktivasi. Ticket ditutup dengan status completed.`\n        \n        case 'downgrade':\n          return `Downgrade package untuk ${customerName} berhasil diproses.${packageName ? ` New package ${packageName}` : ' Package baru'}${bandwidth ? ` dengan bandwidth ${bandwidth} Mbps` : ''} telah aktif. Adjustment bandwidth dilakukan sesuai permintaan customer. Service plan telah diupdate di system dan billing. Layanan berjalan normal dengan konfigurasi baru. Customer confirm perubahan package sesuai dengan yang diinginkan. Ticket ditutup dengan status completed.`\n        \n        case 'relocation':\n          return `Relokasi layanan untuk ${customerName} telah selesai. Perangkat telah dipindahkan ke lokasi baru dengan sukses. Fiber optic di-routing ulang dan koneksi telah di-establish dengan baik. Signal quality optimal di lokasi baru. Testing dilakukan dan semua berjalan normal. Customer confirm layanan sudah aktif di lokasi baru dan berfungsi dengan baik. Ticket ditutup dengan status completed.`\n        \n        default:\n          return `Ticket ${ticket.type_name || ticketType} untuk ${customerName} telah diselesaikan dengan baik. Semua pekerjaan yang diperlukan telah dikerjakan sesuai SLA. Testing telah dilakukan dan hasilnya memuaskan. Customer confirm satisfied dengan hasil pekerjaan. Tidak ada outstanding issue. Ticket ditutup dengan status completed.`\n      }\n    }\n\n    const updateData = {\n      status: selectedStatus,\n      notes: autoGenerateNotes(),\n      work_notes: data.work_notes || undefined,\n      resolution_notes: autoGenerateResolutionNotes(),\n      customer_rating: data.customer_rating || undefined,\n      customer_feedback: data.customer_feedback || undefined\n    }\n\n    // Kirim assigned_technician_id jika:\n    // 1. Status berubah ke 'assigned' dari 'open' (assign pertama kali)\n    // 2. Atau ada technician yang dipilih di form (re-assign)\n    if (selectedStatus === 'assigned' && selectedTechnician) {\n      updateData.assigned_technician_id = parseInt(selectedTechnician, 10)\n      console.log('=== FRONTEND: Sending technician assignment ===');\n      console.log('Selected Technician:', selectedTechnician);\n      console.log('Parsed Technician ID:', updateData.assigned_technician_id);\n      console.log('Ticket Current Status:', ticket.status);\n      console.log('New Status:', selectedStatus);\n    }\n\n    console.log('=== FRONTEND: Final Update Data ===');\n    console.log(JSON.stringify(updateData, null, 2));\n\n    // Completion fields berdasarkan service type - hanya kirim jika status 'completed'\n    if (selectedStatus === 'completed') {\n      // Convert files to base64 - use stored file objects instead of data.field\n      console.log('🔄 [SUBMIT] Converting files to base64...');\n      const otdr_photo_base64 = otdrFile ? await fileToBase64(otdrFile) : null\n      const attenuation_photo_base64 = attenuationFile ? await fileToBase64(attenuationFile) : null\n      const modem_sn_photo_base64 = modemSnFile ? await fileToBase64(modemSnFile) : null\n      \n      console.log('🔄 [SUBMIT] Files converted:', {\n        otdr: otdr_photo_base64 ? 'OK' : 'None',\n        attenuation: attenuation_photo_base64 ? 'OK' : 'None',\n        modemSn: modem_sn_photo_base64 ? 'OK' : 'None'\n      });\n      \n      // Find selected ODP ID\n      const selectedOdpData = odpList?.find(odp => odp.name === data.odp_location)\n      \n      updateData.completion_data = {\n        odp_location: data.odp_location,\n        odp_id: selectedOdpData?.id || null,\n        odp_distance: data.odp_distance,\n        otdr_photo: otdr_photo_base64 ? {\n          filename: otdrFile.name,\n          data: otdr_photo_base64\n        } : null,\n        final_attenuation: data.final_attenuation,\n        attenuation_photo: attenuation_photo_base64 ? {\n          filename: attenuationFile.name,\n          data: attenuation_photo_base64\n        } : null,\n        wifi_name: data.wifi_name,\n        wifi_password: data.wifi_password,\n        activation_date: data.activation_date,\n        modem_sn_photo: modem_sn_photo_base64 ? {\n          filename: modemSnFile.name,\n          data: modem_sn_photo_base64\n        } : null,\n        repair_date: data.repair_date,\n        new_category: data.new_category,\n        // Upgrade/Downgrade fields\n        new_package: data.new_package,\n        upgrade_notes: data.upgrade_notes,\n        downgrade_notes: data.downgrade_notes\n      }\n      \n      // Log file info for debugging\n      console.log('=== FILE UPLOADS ===');\n      if (otdrFile) console.log('OTDR Photo:', otdrFile.name, otdrFile.size, 'bytes');\n      if (attenuationFile) console.log('Attenuation Photo:', attenuationFile.name, attenuationFile.size, 'bytes');\n      if (modemSnFile) console.log('Modem SN Photo:', modemSnFile.name, modemSnFile.size, 'bytes');\n    }\n\n    await onUpdate(updateData)\n    reset()\n  }\n\n  const canUpdateStatus = availableStatuses.length > 1\n\n  // Check if ticket is already completed\n  if (ticket.status === 'completed') {\n    return (\n      <div className=\"card\">\n        <div className=\"card-header\">\n          <h3 className=\"text-lg font-semibold text-gray-900\">Update Status</h3>\n        </div>\n        <div className=\"card-body\">\n          <div className=\"text-center py-8\">\n            <CheckCircle className=\"h-16 w-16 text-green-500 mx-auto mb-4\" />\n            <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">Ticket Completed</h4>\n            <p className=\"text-gray-600\">\n              This ticket has been marked as completed and cannot be modified.\n            </p>\n            <p className=\"text-sm text-gray-500 mt-2\">\n              Completed on: {new Date(ticket.completed_at).toLocaleString()}\n            </p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"card\">\n      <div className=\"card-header\">\n        <h3 className=\"text-lg font-semibold text-gray-900\">Update Status</h3>\n      </div>\n      <div className=\"card-body\">\n        <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n          {/* Status Selection */}\n          {canUpdateStatus && (\n            <div>\n              <label className=\"form-label\">New Status</label>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                {availableStatuses.map((status) => {\n                  const Icon = status.icon\n                  const isSelected = selectedStatus === status.value\n                  const isCurrent = ticket.status === status.value\n                  \n                  return (\n                    <label\n                      key={status.value}\n                      className={`\n                        relative flex cursor-pointer rounded-lg border p-4 focus:outline-none transition-colors\n                        ${isSelected \n                          ? `border-current ${status.color} ${status.bgColor}` \n                          : isCurrent\n                          ? 'border-gray-400 bg-gray-50'\n                          : 'border-gray-300 bg-white hover:bg-gray-50'\n                        }\n                        ${isCurrent ? 'opacity-75' : ''}\n                      `}\n                    >\n                      <input\n                        type=\"radio\"\n                        value={status.value}\n                        checked={selectedStatus === status.value}\n                        onChange={(e) => setSelectedStatus(e.target.value)}\n                        className=\"sr-only\"\n                        disabled={isCurrent}\n                      />\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center\">\n                          <Icon className={`h-5 w-5 mr-3 ${\n                            isSelected ? status.color : 'text-gray-400'\n                          }`} />\n                          <div className=\"text-sm\">\n                            <div className={`font-medium ${\n                              isSelected ? status.color : 'text-gray-900'\n                            }`}>\n                              {status.label}\n                              {isCurrent && <span className=\"ml-2 text-xs\">(Current)</span>}\n                            </div>\n                            <div className=\"text-gray-500\">{status.description}</div>\n                          </div>\n                        </div>\n                      </div>\n                      {isSelected && !isCurrent && (\n                        <div className={`flex-shrink-0 ${status.color}`}>\n                          <CheckCircle className=\"h-5 w-5\" />\n                        </div>\n                      )}\n                    </label>\n                  )\n                })}\n              </div>\n            </div>\n          )}\n\n          {/* Status Update Notes */}\n          <div>\n            <label className=\"form-label\">Status Update Notes</label>\n            <textarea\n              rows={3}\n              className=\"form-input\"\n              placeholder=\"Optional: Add custom notes (leave empty to auto-generate detailed message)...\"\n              {...register('notes')}\n            />\n          </div>\n\n          {/* Work Notes (for technicians) */}\n          {(user?.role === 'technician' || user?.role === 'admin') && (\n            <div>\n              <label className=\"form-label\">Work Notes</label>\n              <textarea\n                rows={3}\n                className=\"form-input\"\n                placeholder=\"Technical details about work performed...\"\n                {...register('work_notes')}\n              />\n            </div>\n          )}\n\n          {/* Technician Selection (when status is 'assigned') */}\n          {selectedStatus === 'assigned' && (\n            <div>\n              <label className=\"form-label\">\n                {ticket.status === 'open' ? 'Assign to Technician *' : 'Re-assign to Technician (optional)'}\n              </label>\n              <select\n                className={`form-input ${ticket.status === 'open' && !selectedTechnician ? 'border-red-500' : ''}`}\n                value={selectedTechnician}\n                onChange={(e) => setSelectedTechnician(e.target.value)}\n                disabled={techniciansLoading}\n              >\n                <option value=\"\">\n                  {ticket.assigned_technician_id ? 'Keep current technician' : 'Select a technician...'}\n                </option>\n                {techniciansData?.data?.technicians?.map((tech) => (\n                  <option key={tech.id} value={tech.id}>\n                    {tech.full_name || tech.user_full_name} ({tech.employee_id || tech.employee_code}) - {tech.skill_level}\n                  </option>\n                ))}\n              </select>\n              {ticket.status === 'open' && !selectedTechnician && (\n                <p className=\"form-error\">Technician selection is required for first assignment</p>\n              )}\n            </div>\n          )}\n\n          {/* Resolution Notes (for completed status) */}\n          {selectedStatus === 'completed' && (\n            <div>\n              <label className=\"form-label\">Resolution Notes</label>\n              <textarea\n                rows={3}\n                className=\"form-input\"\n                placeholder=\"Optional: Add custom resolution notes (leave empty to auto-generate summary)...\"\n                {...register('resolution_notes')}\n              />\n            </div>\n          )}\n\n          {/* Completion Fields - Conditional based on Service Type */}\n          {selectedStatus === 'completed' && (\n            <div className=\"space-y-4 border-t border-gray-200 pt-4\">\n              <h4 className=\"text-sm font-semibold text-gray-900\">Completion Details</h4>\n              \n              {/* Installation Fields */}\n              {ticket.type === 'installation' && (\n                <div className=\"space-y-4 bg-blue-50 p-4 rounded-lg\">\n                  <p className=\"text-sm font-medium text-blue-900\">Installation Completion Fields</p>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {/* 1. Lokasi ODP */}\n                    <div>\n                      <label className=\"form-label\">Lokasi ODP *</label>\n                      <select\n                        className={`form-input ${errors.odp_location ? 'border-red-500' : ''}`}\n                        {...register('odp_location', { required: 'Lokasi ODP is required' })}\n                        disabled={odpLoading}\n                      >\n                        <option value=\"\">\n                          {odpLoading ? 'Loading ODP data...' : odpError ? 'Error loading ODP' : !odpList || odpList.length === 0 ? 'No active ODP available' : 'Pilih ODP...'}\n                        </option>\n                        {odpList?.map((odp) => (\n                          <option key={odp.id} value={odp.name}>\n                            {odp.name} - {odp.location}\n                          </option>\n                        ))}\n                      </select>\n                      {odpLoading && <p className=\"text-xs text-blue-600 mt-1\">⏳ Loading ODP list...</p>}\n                      {odpError && <p className=\"text-xs text-red-600 mt-1\">⚠️ Error: {odpError.message || 'Failed to load ODP data'}</p>}\n                      {!odpLoading && !odpError && odpList?.length === 0 && (\n                        <p className=\"text-xs text-orange-600 mt-1\">⚠️ No active ODP found. Please add ODP in Master Data first.</p>\n                      )}\n                      {errors.odp_location && <p className=\"form-error\">{errors.odp_location.message}</p>}\n                    </div>\n\n                    {/* 2. Jarak ODP */}\n                    <div>\n                      <label className=\"form-label\">Jarak ODP (meter) *</label>\n                      <input\n                        type=\"number\"\n                        className={`form-input ${errors.odp_distance ? 'border-red-500' : ''}`}\n                        {...register('odp_distance', { required: 'Jarak ODP is required' })}\n                      />\n                      {errors.odp_distance && <p className=\"form-error\">{errors.odp_distance.message}</p>}\n                    </div>\n\n                    {/* 3. Redaman Terakhir */}\n                    <div>\n                      <label className=\"form-label\">Redaman Terakhir (dB) *</label>\n                      <input\n                        type=\"number\"\n                        step=\"0.01\"\n                        className={`form-input ${errors.final_attenuation ? 'border-red-500' : ''}`}\n                        {...register('final_attenuation', { required: 'Redaman Terakhir is required' })}\n                      />\n                      {errors.final_attenuation && <p className=\"form-error\">{errors.final_attenuation.message}</p>}\n                    </div>\n\n                    {/* 4. Nama WiFi */}\n                    <div>\n                      <label className=\"form-label\">Nama WiFi *</label>\n                      <input\n                        type=\"text\"\n                        className={`form-input ${errors.wifi_name ? 'border-red-500' : ''}`}\n                        {...register('wifi_name', { required: 'Nama WiFi is required' })}\n                      />\n                      {errors.wifi_name && <p className=\"form-error\">{errors.wifi_name.message}</p>}\n                    </div>\n\n                    {/* 5. Password WiFi */}\n                    <div>\n                      <label className=\"form-label\">Password WiFi *</label>\n                      <input\n                        type=\"text\"\n                        className={`form-input ${errors.wifi_password ? 'border-red-500' : ''}`}\n                        {...register('wifi_password', { required: 'Password WiFi is required' })}\n                      />\n                      {errors.wifi_password && <p className=\"form-error\">{errors.wifi_password.message}</p>}\n                    </div>\n\n                    {/* 6. Tanggal Aktif */}\n                    <div>\n                      <label className=\"form-label\">Tanggal Aktif *</label>\n                      <input\n                        type=\"datetime-local\"\n                        className={`form-input ${errors.activation_date ? 'border-red-500' : ''}`}\n                        {...register('activation_date', { required: 'Tanggal Aktif is required' })}\n                      />\n                      {errors.activation_date && <p className=\"form-error\">{errors.activation_date.message}</p>}\n                    </div>\n\n                    {/* 7. Foto OTDR */}\n                    <div className=\"md:col-span-2\">\n                      <label className=\"form-label\">Foto OTDR *</label>\n                      <input\n                        type=\"file\"\n                        id=\"otdr-photo-input\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        ref={register('otdr_photo').ref}\n                        name=\"otdr_photo\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          console.log('📁 OTDR Photo selected:', file?.name);\n                          if (file) {\n                            // Store file object for display\n                            setOtdrFile(file);\n                            // Generate preview directly\n                            const reader = new FileReader();\n                            reader.onloadend = () => {\n                              console.log('✅ OTDR Preview generated');\n                              setOtdrPreview(reader.result);\n                            };\n                            reader.readAsDataURL(file);\n                            // Set value for form submission\n                            setValue('otdr_photo', e.target.files);\n                          }\n                        }}\n                      />\n                      \n                      {/* Upload Button or Preview */}\n                      {!otdrPreview ? (\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            console.log('🎯 Triggering OTDR file picker...');\n                            document.getElementById('otdr-photo-input').click();\n                          }}\n                          className={`w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg transition-all ${\n                            errors.otdr_photo\n                              ? 'border-red-500 bg-red-50 hover:bg-red-100'\n                              : 'border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-blue-500'\n                          }`}\n                        >\n                          <Upload className=\"h-5 w-5 text-gray-400\" />\n                          <span className=\"text-sm font-medium text-gray-600\">\n                            Klik untuk pilih Foto OTDR\n                          </span>\n                        </button>\n                      ) : (\n                        <div className=\"border-2 border-green-500 bg-green-50 rounded-lg overflow-hidden\">\n                          <div className=\"relative\">\n                            <img \n                              src={otdrPreview} \n                              alt=\"OTDR Preview\" \n                              className=\"w-full h-48 object-cover\"\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => window.open(otdrPreview, '_blank')}\n                              className=\"absolute top-2 right-2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors\"\n                              title=\"Preview full size\"\n                            >\n                              <svg className=\"h-5 w-5 text-gray-700\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                              </svg>\n                            </button>\n                          </div>\n                          <div className=\"p-3 bg-white border-t-2 border-green-500\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                                <svg className=\"h-5 w-5 text-green-600 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                                </svg>\n                                <p className=\"text-sm font-semibold text-green-700 truncate\" title={otdrFile?.name}>\n                                  {otdrFile?.name}\n                                </p>\n                              </div>\n                              <button\n                                type=\"button\"\n                                onClick={() => {\n                                  setValue('otdr_photo', null);\n                                  setOtdrPreview(null);\n                                  setOtdrFile(null);\n                                }}\n                                className=\"ml-2 text-red-600 hover:text-red-700 flex-shrink-0\"\n                                title=\"Remove file\"\n                              >\n                                <svg className=\"h-5 w-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                                </svg>\n                              </button>\n                            </div>\n                            <p className=\"text-xs text-gray-600\">\n                              Size: {(otdrFile?.size / 1024).toFixed(1)} KB\n                            </p>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    {/* 8. Foto Redaman Terakhir */}\n                    <div className=\"md:col-span-2\">\n                      <label className=\"form-label\">Foto Redaman Terakhir *</label>\n                      <input\n                        type=\"file\"\n                        id=\"attenuation-photo-input\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        ref={register('attenuation_photo').ref}\n                        name=\"attenuation_photo\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          console.log('📁 Attenuation Photo selected:', file?.name);\n                          if (file) {\n                            setAttenuationFile(file);\n                            const reader = new FileReader();\n                            reader.onloadend = () => {\n                              console.log('✅ Attenuation Preview generated');\n                              setAttenuationPreview(reader.result);\n                            };\n                            reader.readAsDataURL(file);\n                            setValue('attenuation_photo', e.target.files);\n                          }\n                        }}\n                      />\n                      \n                      {/* Upload Button or Preview */}\n                      {!attenuationPreview ? (\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            console.log('🎯 Triggering Attenuation file picker...');\n                            document.getElementById('attenuation-photo-input').click();\n                          }}\n                          className={`w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg transition-all ${\n                            errors.attenuation_photo\n                              ? 'border-red-500 bg-red-50 hover:bg-red-100'\n                              : 'border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-blue-500'\n                          }`}\n                        >\n                          <Upload className=\"h-5 w-5 text-gray-400\" />\n                          <span className=\"text-sm font-medium text-gray-600\">\n                            Klik untuk pilih Foto Redaman\n                          </span>\n                        </button>\n                      ) : (\n                        <div className=\"border-2 border-green-500 bg-green-50 rounded-lg overflow-hidden\">\n                          <div className=\"relative\">\n                            <img \n                              src={attenuationPreview} \n                              alt=\"Attenuation Preview\" \n                              className=\"w-full h-48 object-cover\"\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => window.open(attenuationPreview, '_blank')}\n                              className=\"absolute top-2 right-2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors\"\n                              title=\"Preview full size\"\n                            >\n                              <svg className=\"h-5 w-5 text-gray-700\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                              </svg>\n                            </button>\n                          </div>\n                          <div className=\"p-3 bg-white border-t-2 border-green-500\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                                <svg className=\"h-5 w-5 text-green-600 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                                </svg>\n                                <p className=\"text-sm font-semibold text-green-700 truncate\" title={attenuationFile?.name}>\n                                  {attenuationFile?.name}\n                                </p>\n                              </div>\n                              <button\n                                type=\"button\"\n                                onClick={() => {\n                                  setValue('attenuation_photo', null);\n                                  setAttenuationPreview(null);\n                                  setAttenuationFile(null);\n                                }}\n                                className=\"ml-2 text-red-600 hover:text-red-700 flex-shrink-0\"\n                                title=\"Remove file\"\n                              >\n                                <svg className=\"h-5 w-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                                </svg>\n                              </button>\n                            </div>\n                            <p className=\"text-xs text-gray-600\">\n                              Size: {(attenuationFile?.size / 1024).toFixed(1)} KB\n                            </p>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    {/* 9. Foto SN Modem */}\n                    <div className=\"md:col-span-2\">\n                      <label className=\"form-label\">Foto SN Modem *</label>\n                      <input\n                        type=\"file\"\n                        id=\"modem-sn-photo-input\"\n                        accept=\"image/*\"\n                        className=\"hidden\"\n                        ref={register('modem_sn_photo').ref}\n                        name=\"modem_sn_photo\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          console.log('📁 Modem SN Photo selected:', file?.name);\n                          if (file) {\n                            setModemSnFile(file);\n                            const reader = new FileReader();\n                            reader.onloadend = () => {\n                              console.log('✅ Modem SN Preview generated');\n                              setModemSnPreview(reader.result);\n                            };\n                            reader.readAsDataURL(file);\n                            setValue('modem_sn_photo', e.target.files);\n                          }\n                        }}\n                      />\n                      \n                      {/* Upload Button or Preview */}\n                      {!modemSnPreview ? (\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            console.log('🎯 Triggering Modem SN file picker...');\n                            document.getElementById('modem-sn-photo-input').click();\n                          }}\n                          className={`w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg transition-all ${\n                            errors.modem_sn_photo\n                              ? 'border-red-500 bg-red-50 hover:bg-red-100'\n                              : 'border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-blue-500'\n                          }`}\n                        >\n                          <Upload className=\"h-5 w-5 text-gray-400\" />\n                          <span className=\"text-sm font-medium text-gray-600\">\n                            Klik untuk pilih Foto SN Modem\n                          </span>\n                        </button>\n                      ) : (\n                        <div className=\"border-2 border-green-500 bg-green-50 rounded-lg overflow-hidden\">\n                          <div className=\"relative\">\n                            <img \n                              src={modemSnPreview} \n                              alt=\"Modem SN Preview\" \n                              className=\"w-full h-48 object-cover\"\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => window.open(modemSnPreview, '_blank')}\n                              className=\"absolute top-2 right-2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors\"\n                              title=\"Preview full size\"\n                            >\n                              <svg className=\"h-5 w-5 text-gray-700\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                              </svg>\n                            </button>\n                          </div>\n                          <div className=\"p-3 bg-white border-t-2 border-green-500\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                                <svg className=\"h-5 w-5 text-green-600 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                                </svg>\n                                <p className=\"text-sm font-semibold text-green-700 truncate\" title={modemSnFile?.name}>\n                                  {modemSnFile?.name}\n                                </p>\n                              </div>\n                              <button\n                                type=\"button\"\n                                onClick={() => {\n                                  setValue('modem_sn_photo', null);\n                                  setModemSnPreview(null);\n                                  setModemSnFile(null);\n                                }}\n                                className=\"ml-2 text-red-600 hover:text-red-700 flex-shrink-0\"\n                                title=\"Remove file\"\n                              >\n                                <svg className=\"h-5 w-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                                </svg>\n                              </button>\n                            </div>\n                            <p className=\"text-xs text-gray-600\">\n                              Size: {(modemSnFile?.size / 1024).toFixed(1)} KB\n                            </p>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Repair & Maintenance Fields */}\n              {(ticket.type === 'repair' || ticket.type === 'maintenance') && (\n                <div className=\"space-y-4 bg-orange-50 p-4 rounded-lg\">\n                  <p className=\"text-sm font-medium text-orange-900\">\n                    {ticket.type === 'repair' ? 'Repair' : 'Maintenance'} Completion Fields\n                  </p>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"form-label\">Lokasi ODP *</label>\n                      <select\n                        className={`form-input ${errors.odp_location ? 'border-red-500' : ''}`}\n                        {...register('odp_location', { required: 'Lokasi ODP is required' })}\n                        disabled={odpLoading}\n                      >\n                        <option value=\"\">\n                          {odpLoading ? 'Loading ODP data...' : odpError ? 'Error loading ODP' : !odpList || odpList.length === 0 ? 'No active ODP available' : 'Pilih ODP...'}\n                        </option>\n                        {odpList?.map((odp) => (\n                          <option key={odp.id} value={odp.name}>\n                            {odp.name} - {odp.location}\n                          </option>\n                        ))}\n                      </select>\n                      {odpLoading && <p className=\"text-xs text-blue-600 mt-1\">⏳ Loading ODP list...</p>}\n                      {odpError && <p className=\"text-xs text-red-600 mt-1\">⚠️ Error: {odpError.message || 'Failed to load ODP data'}</p>}\n                      {!odpLoading && !odpError && odpList?.length === 0 && (\n                        <p className=\"text-xs text-orange-600 mt-1\">⚠️ No active ODP found. Please add ODP in Master Data first.</p>\n                      )}\n                      {errors.odp_location && <p className=\"form-error\">{errors.odp_location.message}</p>}\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Redaman Terakhir (dB) *</label>\n                      <input\n                        type=\"number\"\n                        step=\"0.01\"\n                        className={`form-input ${errors.final_attenuation ? 'border-red-500' : ''}`}\n                        {...register('final_attenuation', { required: 'Redaman Terakhir is required' })}\n                      />\n                      {errors.final_attenuation && <p className=\"form-error\">{errors.final_attenuation.message}</p>}\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Foto Redaman Terakhir (Optional)</label>\n                        <input\n                          type=\"file\"\n                        id=\"maintenance-attenuation-photo-input\"\n                          accept=\"image/*\"\n                        className=\"hidden\"\n                        ref={register('attenuation_photo').ref}\n                        name=\"attenuation_photo\"\n                        onChange={(e) => {\n                          const file = e.target.files?.[0];\n                          console.log('📁 Maintenance Attenuation Photo selected:', file?.name);\n                          if (file) {\n                            setAttenuationFile(file);\n                            const reader = new FileReader();\n                            reader.onloadend = () => {\n                              console.log('✅ Maintenance Attenuation Preview generated');\n                              setAttenuationPreview(reader.result);\n                            };\n                            reader.readAsDataURL(file);\n                            setValue('attenuation_photo', e.target.files);\n                          }\n                        }}\n                      />\n                      \n                      {/* Upload Button or Preview */}\n                      {!attenuationPreview ? (\n                        <button\n                          type=\"button\"\n                          onClick={() => {\n                            console.log('🎯 Triggering Maintenance Attenuation file picker...');\n                            document.getElementById('maintenance-attenuation-photo-input').click();\n                          }}\n                          className=\"w-full flex items-center justify-center gap-2 px-4 py-3 border-2 border-dashed rounded-lg transition-all border-gray-300 bg-gray-50 hover:bg-gray-100 hover:border-orange-500\"\n                        >\n                          <Upload className=\"h-5 w-5 text-gray-400\" />\n                          <span className=\"text-sm font-medium text-gray-600\">\n                            Klik untuk pilih Foto Redaman (Optional)\n                          </span>\n                        </button>\n                      ) : (\n                        <div className=\"border-2 border-green-500 bg-green-50 rounded-lg overflow-hidden\">\n                          <div className=\"relative\">\n                            <img \n                              src={attenuationPreview} \n                              alt=\"Attenuation Preview\" \n                              className=\"w-full h-48 object-cover\"\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => window.open(attenuationPreview, '_blank')}\n                              className=\"absolute top-2 right-2 bg-white rounded-full p-2 shadow-lg hover:bg-gray-100 transition-colors\"\n                              title=\"Preview full size\"\n                            >\n                              <svg className=\"h-5 w-5 text-gray-700\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                              </svg>\n                            </button>\n                          </div>\n                          <div className=\"p-3 bg-white border-t-2 border-green-500\">\n                            <div className=\"flex items-center justify-between mb-2\">\n                              <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n                                <svg className=\"h-5 w-5 text-green-600 flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clipRule=\"evenodd\" />\n                                </svg>\n                                <p className=\"text-sm font-semibold text-green-700 truncate\" title={attenuationFile?.name}>\n                                  {attenuationFile?.name}\n                                </p>\n                      </div>\n                              <button\n                                type=\"button\"\n                                onClick={() => {\n                                  setValue('attenuation_photo', null);\n                                  setAttenuationPreview(null);\n                                  setAttenuationFile(null);\n                                }}\n                                className=\"ml-2 text-red-600 hover:text-red-700 flex-shrink-0\"\n                                title=\"Remove file\"\n                              >\n                                <svg className=\"h-5 w-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                                </svg>\n                              </button>\n                            </div>\n                            <p className=\"text-xs text-gray-600\">\n                              Size: {(attenuationFile?.size / 1024).toFixed(1)} KB\n                            </p>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Nama WiFi</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-input\"\n                        {...register('wifi_name')}\n                      />\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Password WiFi</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-input\"\n                        {...register('wifi_password')}\n                      />\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Tanggal Perbaikan *</label>\n                      <input\n                        type=\"datetime-local\"\n                        className={`form-input ${errors.repair_date ? 'border-red-500' : ''}`}\n                        {...register('repair_date', { required: 'Tanggal Perbaikan is required' })}\n                      />\n                      {errors.repair_date && <p className=\"form-error\">{errors.repair_date.message}</p>}\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* Upgrade Fields */}\n              {ticket.type === 'upgrade' && (\n                <div className=\"space-y-4 bg-green-50 p-4 rounded-lg\">\n                  <p className=\"text-sm font-medium text-green-900\">Upgrade Completion Fields</p>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"form-label\">Paket Baru *</label>\n                      <select\n                        className={`form-input ${errors.new_package ? 'border-red-500' : ''}`}\n                        {...register('new_package', { required: 'Paket baru is required' })}\n                        disabled={packagesLoading}\n                      >\n                        <option value=\"\">\n                          {packagesLoading ? 'Loading packages...' : 'Pilih Paket Baru...'}\n                        </option>\n                        {packagesList?.map((pkg) => (\n                          <option key={pkg.id} value={pkg.name || pkg.package_name}>\n                            {pkg.name || pkg.package_name} - {pkg.speed_mbps || pkg.speed} Mbps - Rp {(pkg.price || pkg.monthly_price)?.toLocaleString('id-ID')}\n                          </option>\n                        ))}\n                      </select>\n                      {packagesError && <p className=\"form-error\">Error loading packages: {packagesError.message}</p>}\n                      {!packagesLoading && packagesList && packagesList.length === 0 && (\n                        <p className=\"text-xs text-amber-600\">No active packages available</p>\n                      )}\n                      {errors.new_package && <p className=\"form-error\">{errors.new_package.message}</p>}\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Catatan Upgrade</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-input\"\n                        placeholder=\"e.g., Dari 100 Mbps ke 200 Mbps\"\n                        {...register('upgrade_notes')}\n                      />\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              {/* Downgrade Fields */}\n              {ticket.type === 'downgrade' && (\n                <div className=\"space-y-4 bg-amber-50 p-4 rounded-lg\">\n                  <p className=\"text-sm font-medium text-amber-900\">Downgrade Completion Fields</p>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"form-label\">Paket Baru *</label>\n                      <select\n                        className={`form-input ${errors.new_package ? 'border-red-500' : ''}`}\n                        {...register('new_package', { required: 'Paket baru is required' })}\n                        disabled={packagesLoading}\n                      >\n                        <option value=\"\">\n                          {packagesLoading ? 'Loading packages...' : 'Pilih Paket Baru...'}\n                        </option>\n                        {packagesList?.map((pkg) => (\n                          <option key={pkg.id} value={pkg.name || pkg.package_name}>\n                            {pkg.name || pkg.package_name} - {pkg.speed_mbps || pkg.speed} Mbps - Rp {(pkg.price || pkg.monthly_price)?.toLocaleString('id-ID')}\n                          </option>\n                        ))}\n                      </select>\n                      {packagesError && <p className=\"form-error\">Error loading packages: {packagesError.message}</p>}\n                      {!packagesLoading && packagesList && packagesList.length === 0 && (\n                        <p className=\"text-xs text-amber-600\">No active packages available</p>\n                      )}\n                      {errors.new_package && <p className=\"form-error\">{errors.new_package.message}</p>}\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Catatan Downgrade</label>\n                      <input\n                        type=\"text\"\n                        className=\"form-input\"\n                        placeholder=\"e.g., Dari 200 Mbps ke 100 Mbps\"\n                        {...register('downgrade_notes')}\n                      />\n                    </div>\n                  </div>\n                </div>\n              )}\n\n              {/* WiFi Setup Fields */}\n              {ticket.type === 'wifi_setup' && (\n                <div className=\"space-y-4 bg-purple-50 p-4 rounded-lg\">\n                  <p className=\"text-sm font-medium text-purple-900\">WiFi Setup Completion Fields</p>\n                  \n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <label className=\"form-label\">Nama WiFi *</label>\n                      <input\n                        type=\"text\"\n                        className={`form-input ${errors.wifi_name ? 'border-red-500' : ''}`}\n                        {...register('wifi_name', { required: 'Nama WiFi is required' })}\n                      />\n                      {errors.wifi_name && <p className=\"form-error\">{errors.wifi_name.message}</p>}\n                    </div>\n\n                    <div>\n                      <label className=\"form-label\">Password WiFi *</label>\n                      <input\n                        type=\"text\"\n                        className={`form-input ${errors.wifi_password ? 'border-red-500' : ''}`}\n                        {...register('wifi_password', { required: 'Password WiFi is required' })}\n                      />\n                      {errors.wifi_password && <p className=\"form-error\">{errors.wifi_password.message}</p>}\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Customer Feedback (for completed status) */}\n          {selectedStatus === 'completed' && user?.role !== 'technician' && (\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"form-label\">Customer Rating</label>\n                <select className=\"form-input\" {...register('customer_rating')}>\n                  <option value=\"\">No rating</option>\n                  <option value=\"5\">⭐⭐⭐⭐⭐ Excellent</option>\n                  <option value=\"4\">⭐⭐⭐⭐ Good</option>\n                  <option value=\"3\">⭐⭐⭐ Average</option>\n                  <option value=\"2\">⭐⭐ Poor</option>\n                  <option value=\"1\">⭐ Very Poor</option>\n                </select>\n              </div>\n              \n              <div>\n                <label className=\"form-label\">Customer Feedback</label>\n                <textarea\n                  rows={2}\n                  className=\"form-input\"\n                  placeholder=\"Customer comments about the service...\"\n                  {...register('customer_feedback')}\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Submit Button */}\n          <div className=\"flex justify-end space-x-3 pt-4 border-t border-gray-200\">\n            <button\n              type=\"submit\"\n              disabled={isLoading || (!canUpdateStatus && selectedStatus === ticket.status)}\n              className=\"btn-primary\"\n            >\n              {isLoading ? (\n                <>\n                  <LoadingSpinner size=\"sm\" className=\"mr-2\" />\n                  Updating...\n                </>\n              ) : (\n                'Update Status'\n              )}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n\nexport default StatusUpdateForm\n","import React from 'react';\nimport { User, Star, MessageCircle, Phone, Mail } from 'lucide-react';\n\nconst TechnicianTeamDisplay = ({ team = [], leadId }) => {\n  if (!team || team.length === 0) {\n    return (\n      <div className=\"bg-gray-50 rounded-lg p-4 text-center\">\n        <User className=\"h-8 w-8 text-gray-300 mx-auto mb-2\" />\n        <p className=\"text-sm text-gray-500\">Belum ada teknisi assigned</p>\n      </div>\n    );\n  }\n\n  // Sort: lead first, then member, then support\n  const sortedTeam = [...team].sort((a, b) => {\n    const roleOrder = { lead: 1, member: 2, support: 3 };\n    return (roleOrder[a.role] || 99) - (roleOrder[b.role] || 99);\n  });\n\n  const getRoleBadge = (role) => {\n    const badges = {\n      lead: { bg: 'bg-yellow-100', text: 'text-yellow-800', icon: Star, label: 'LEAD' },\n      member: { bg: 'bg-blue-100', text: 'text-blue-800', icon: User, label: 'MEMBER' },\n      support: { bg: 'bg-purple-100', text: 'text-purple-800', icon: User, label: 'SUPPORT' }\n    };\n    return badges[role] || badges.member;\n  };\n\n  return (\n    <div className=\"space-y-3\">\n      {sortedTeam.map((member, index) => {\n        const badge = getRoleBadge(member.role);\n        const Icon = badge.icon;\n        const isLead = member.role === 'lead';\n\n        return (\n          <div\n            key={member.id || index}\n            className={`border rounded-lg p-4 ${\n              isLead \n                ? 'border-yellow-300 bg-yellow-50' \n                : 'border-gray-200 bg-white'\n            }`}\n          >\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex items-start space-x-3 flex-1\">\n                {/* Avatar */}\n                <div className={`w-12 h-12 rounded-full flex items-center justify-center ${\n                  isLead ? 'bg-yellow-200' : 'bg-blue-100'\n                }`}>\n                  <Icon className={`h-6 w-6 ${\n                    isLead ? 'text-yellow-700' : 'text-blue-600'\n                  }`} />\n                </div>\n\n                {/* Info */}\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-2 mb-1\">\n                    <h4 className=\"font-semibold text-gray-900\">{member.full_name}</h4>\n                    <span className={`inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ${badge.bg} ${badge.text}`}>\n                      {isLead && <Star className=\"h-3 w-3 mr-1 fill-current\" />}\n                      {badge.label}\n                    </span>\n                  </div>\n\n                  {member.specialization && (\n                    <p className=\"text-sm text-gray-600 mb-2 flex items-center\">\n                      <Briefcase className=\"h-3 w-3 mr-1\" />\n                      {member.specialization}\n                    </p>\n                  )}\n\n                  {/* Contact Info */}\n                  <div className=\"flex flex-wrap gap-3 text-sm\">\n                    {member.phone && (\n                      <a\n                        href={`https://wa.me/${member.phone.replace(/^0/, '62')}`}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"flex items-center text-green-600 hover:text-green-700\"\n                      >\n                        <MessageCircle className=\"h-3 w-3 mr-1\" />\n                        {member.phone}\n                      </a>\n                    )}\n                    {member.email && (\n                      <a\n                        href={`mailto:${member.email}`}\n                        className=\"flex items-center text-blue-600 hover:text-blue-700\"\n                      >\n                        <Mail className=\"h-3 w-3 mr-1\" />\n                        {member.email}\n                      </a>\n                    )}\n                  </div>\n\n                  {/* Assignment Info */}\n                  {member.assigned_at && (\n                    <p className=\"text-xs text-gray-500 mt-2\">\n                      Assigned: {new Date(member.assigned_at).toLocaleDateString('id-ID', {\n                        day: 'numeric',\n                        month: 'short',\n                        year: 'numeric',\n                        hour: '2-digit',\n                        minute: '2-digit'\n                      })}\n                    </p>\n                  )}\n\n                  {/* Notes */}\n                  {member.notes && (\n                    <p className=\"text-sm text-gray-600 mt-2 italic\">\n                      📝 {member.notes}\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n        );\n      })}\n\n      {/* Team Summary */}\n      {team.length > 1 && (\n        <div className=\"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-4\">\n          <p className=\"text-sm text-blue-900\">\n            <strong>👥 Tim:</strong> {team.length} teknisi •{' '}\n            <strong>Lead:</strong> {team.find(t => t.role === 'lead')?.full_name || 'TBA'}\n          </p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default MultiTechnicianSelector;\n\n","import React, { useState } from 'react'\nimport { useParams, Link } from 'react-router-dom'\nimport { useQuery, useMutation, useQueryClient } from 'react-query'\nimport { \n  Calendar, \n  Clock, \n  User, \n  MapPin, \n  Phone, \n  Mail,\n  FileText,\n  AlertCircle,\n  CheckCircle,\n  XCircle,\n  Upload,\n  Download,\n  Package,\n  PlayCircle,\n  Ticket\n} from 'lucide-react'\nimport { ticketService } from '../../services/ticketService'\nimport { useAuth } from '../../contexts/AuthContext'\nimport StatusUpdateForm from '../../components/StatusUpdateForm'\nimport BackButton from '../../components/common/BackButton'\nimport LoadingSpinner from '../../components/LoadingSpinner'\nimport TechnicianTeamDisplay from '../../components/TechnicianTeamDisplay'\nimport toast from 'react-hot-toast'\n\nconst TicketDetailPage = () => {\n  const { id } = useParams()\n  const { user } = useAuth()\n  const queryClient = useQueryClient()\n  const [activeTab, setActiveTab] = useState('details')\n  const [preSelectedStatus, setPreSelectedStatus] = useState(null)\n\n  // Fetch ticket details\n  const { data: ticketData, isLoading, error } = useQuery(\n    ['ticket', id],\n    () => ticketService.getTicket(id),\n    { enabled: !!id }\n  )\n\n  // Fetch current user's technician profile if they're a technician\n  const { data: myTechnicianData } = useQuery(\n    ['my-technician-profile', user?.id],\n    async () => {\n      if (user?.role !== 'technician') return null\n      const response = await fetch(`/api/technicians?user_id=${user.id}`, {\n        headers: {\n          'Authorization': `Bearer ${localStorage.getItem('token')}`\n        }\n      })\n      const data = await response.json()\n      return data?.data?.technicians?.[0] || null\n    },\n    { \n      enabled: !!user && user.role === 'technician',\n      staleTime: 300000 // 5 minutes\n    }\n  )\n\n  // Update ticket status mutation\n  const updateStatusMutation = useMutation(\n    (updateData) => ticketService.updateTicketStatus(id, updateData),\n    {\n      onSuccess: () => {\n        queryClient.invalidateQueries(['ticket', id])\n        queryClient.invalidateQueries(['tickets'])\n        toast.success('Ticket status updated successfully!')\n      },\n      onError: (error) => {\n        toast.error(error.response?.data?.message || 'Failed to update ticket status')\n      }\n    }\n  )\n\n  const ticket = ticketData?.data?.ticket\n\n  const getStatusBadge = (status) => {\n    const statusConfig = {\n      open: { class: 'badge-info', label: 'Open', icon: Clock },\n      assigned: { class: 'badge-warning', label: 'Assigned', icon: User },\n      in_progress: { class: 'badge-warning', label: 'In Progress', icon: Clock },\n      completed: { class: 'badge-success', label: 'Completed', icon: CheckCircle },\n      cancelled: { class: 'badge-gray', label: 'Cancelled', icon: AlertCircle },\n      on_hold: { class: 'badge-gray', label: 'On Hold', icon: Clock }\n    }\n    const config = statusConfig[status] || statusConfig.open\n    const Icon = config.icon\n    return (\n      <span className={`badge ${config.class} inline-flex items-center`}>\n        <Icon className=\"h-3 w-3 mr-1\" />\n        {config.label}\n      </span>\n    )\n  }\n\n  const getPriorityBadge = (priority) => {\n    const priorityConfig = {\n      low: { class: 'badge-gray', label: 'Low' },\n      normal: { class: 'badge-info', label: 'Normal' },\n      high: { class: 'badge-warning', label: 'High' },\n      critical: { class: 'badge-danger', label: 'Critical' }\n    }\n    const config = priorityConfig[priority] || priorityConfig.normal\n    return <span className={`badge ${config.class}`}>{config.label}</span>\n  }\n\n  const formatDateTime = (dateString) => {\n    if (!dateString) return 'Not set'\n    const date = new Date(dateString)\n    return date.toLocaleString()\n  }\n\n  const calculateDuration = (startDate, endDate) => {\n    if (!startDate || !endDate) return null\n    const start = new Date(startDate)\n    const end = new Date(endDate)\n    const diffMs = end - start\n    const diffHours = Math.floor(diffMs / (1000 * 60 * 60))\n    const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60))\n    return `${diffHours}h ${diffMinutes}m`\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <LoadingSpinner size=\"lg\" />\n      </div>\n    )\n  }\n\n  if (error || !ticket) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center space-x-4\">\n          <BackButton to=\"/tickets\" label=\"Back to Tickets\" />\n        </div>\n        <div className=\"card\">\n          <div className=\"card-body text-center py-12\">\n            <AlertCircle className=\"h-12 w-12 text-red-400 mx-auto mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-900 mb-2\">Ticket Not Found</h3>\n            <p className=\"text-gray-500\">\n              The ticket you're looking for doesn't exist or you don't have permission to view it.\n            </p>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  const tabs = [\n    { id: 'details', label: 'Details', icon: FileText },\n    { id: 'status', label: 'Update Status', icon: Clock },\n    { id: 'history', label: 'History', icon: Calendar }\n  ]\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <BackButton to=\"/tickets\" label=\"Back to Tickets\" />\n          <div>\n            <div className=\"flex items-center gap-2 mb-1\">\n              <Ticket className=\"h-5 w-5 text-blue-600\" />\n              <span className=\"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-lg font-mono font-semibold border border-blue-200\">\n                {ticket.ticket_number}\n              </span>\n            </div>\n            <p className=\"text-gray-600\">{ticket.title}</p>\n          </div>\n        </div>\n        <div className=\"flex items-center space-x-3\">\n          {getStatusBadge(ticket.status)}\n          {getPriorityBadge(ticket.priority)}\n        </div>\n      </div>\n\n      {/* Quick Info Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        {/* Customer Card - Clickable */}\n        {ticket.customer_numeric_id && (\n          <Link to={`/customers/${ticket.customer_numeric_id}`} className=\"card hover:shadow-lg transition-shadow cursor-pointer\">\n            <div className=\"card-body\">\n              <div className=\"flex items-center\">\n                <User className=\"h-8 w-8 text-blue-600 bg-blue-100 rounded-lg p-2 mr-3\" />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Customer</p>\n                  <p className=\"text-lg font-semibold text-gray-900\">{ticket.customer_name}</p>\n                  {ticket.customer_code && (\n                    <p className=\"text-xs text-gray-500 font-mono\">{ticket.customer_code}</p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </Link>\n        )}\n\n        <div className=\"card\">\n          <div className=\"card-body\">\n            <div className=\"flex items-center\">\n              <Clock className=\"h-8 w-8 text-green-600 bg-green-100 rounded-lg p-2 mr-3\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">Created</p>\n                <p className=\"text-lg font-semibold text-gray-900\">\n                  {new Date(ticket.created_at).toLocaleDateString()}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"card\">\n          <div className=\"card-body\">\n            <div className=\"flex items-center\">\n              <Calendar className=\"h-8 w-8 text-orange-600 bg-orange-100 rounded-lg p-2 mr-3\" />\n              <div>\n                <p className=\"text-sm font-medium text-gray-600\">SLA Due</p>\n                <p className=\"text-lg font-semibold text-gray-900\">\n                  {ticket.sla_due_date ? new Date(ticket.sla_due_date).toLocaleDateString() : 'Not set'}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Technician Team Card */}\n        {(ticket.team && ticket.team.length > 0) || ticket.assigned_technician_id ? (\n          <div className=\"card\">\n            <div className=\"card-body\">\n              <div className=\"flex items-center justify-between mb-4\">\n                <div className=\"flex items-center\">\n                  <User className=\"h-8 w-8 text-purple-600 bg-purple-100 rounded-lg p-2 mr-3\" />\n                  <div>\n                    <p className=\"text-sm font-medium text-gray-600\">\n                      {ticket.team && ticket.team.length > 1 ? 'Technician Team' : 'Technician'}\n                    </p>\n                    {ticket.team && ticket.team.length > 1 && (\n                      <p className=\"text-xs text-gray-500\">{ticket.team.length} teknisi assigned</p>\n                    )}\n                  </div>\n                </div>\n              </div>\n              \n              {/* Import and use TechnicianTeamDisplay component */}\n              {ticket.team && ticket.team.length > 0 ? (\n                <TechnicianTeamDisplay \n                  team={ticket.team} \n                  leadId={ticket.assigned_technician_id} \n                />\n              ) : (\n                <Link to={`/technicians/${ticket.assigned_technician_id}`} className=\"hover:bg-gray-50 p-2 rounded block\">\n                  <p className=\"text-lg font-semibold text-gray-900\">{ticket.technician_name}</p>\n                  <p className=\"text-xs text-gray-500\">{ticket.employee_id}</p>\n                </Link>\n              )}\n            </div>\n          </div>\n        ) : (\n          <div className=\"card\">\n            <div className=\"card-body\">\n              <div className=\"flex items-center\">\n                <User className=\"h-8 w-8 text-purple-600 bg-purple-100 rounded-lg p-2 mr-3\" />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-600\">Technician</p>\n                  <p className=\"text-lg font-semibold text-gray-900\">Unassigned</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Quick Actions */}\n      {!['completed', 'cancelled'].includes(ticket.status) && (\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200 p-4\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <CheckCircle className=\"h-5 w-5 text-gray-400\" />\n              <span className=\"text-sm font-medium text-gray-700\">Quick Actions:</span>\n            </div>\n            <div className=\"flex items-center gap-3\">\n              {/* Status: OPEN - Can self-assign (technicians only) */}\n              {ticket.status === 'open' && user?.role === 'technician' && myTechnicianData && (\n                <button\n                  onClick={async () => {\n                    try {\n                      // Use the /assign endpoint with technician_id\n                      await ticketService.assignTicket(id, myTechnicianData.id)\n                      toast.success('Ticket assigned to you successfully!')\n                      queryClient.invalidateQueries(['ticket', id])\n                      queryClient.invalidateQueries(['tickets'])\n                    } catch (error) {\n                      toast.error(error.response?.data?.message || 'Failed to assign ticket')\n                    }\n                  }}\n                  disabled={updateStatusMutation.isLoading}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 text-sm font-medium inline-flex items-center gap-2 transition-colors\"\n                >\n                  <User className=\"h-4 w-4\" />\n                  Assign to Me\n                </button>\n              )}\n              \n              {/* Status: ASSIGNED - Must start progress first */}\n              {ticket.status === 'assigned' && (\n                <button\n                  onClick={() => {\n                    updateStatusMutation.mutate({\n                      status: 'in_progress',\n                      notes: 'Started working on ticket'\n                    })\n                  }}\n                  disabled={updateStatusMutation.isLoading}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 text-sm font-medium inline-flex items-center gap-2 transition-colors\"\n                >\n                  <PlayCircle className=\"h-4 w-4\" />\n                  Start Progress\n                </button>\n              )}\n              \n              {/* Status: IN_PROGRESS - Can complete with proper form */}\n              {ticket.status === 'in_progress' && (\n                <button\n                  onClick={() => {\n                    // Pre-select \"completed\" status\n                    setPreSelectedStatus('completed')\n                    // Switch to Update Status tab to fill completion form\n                    setActiveTab('status')\n                    // Scroll to top smoothly\n                    window.scrollTo({ top: 0, behavior: 'smooth' })\n                  }}\n                  disabled={updateStatusMutation.isLoading}\n                  className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 text-sm font-medium inline-flex items-center gap-2 transition-colors\"\n                >\n                  <CheckCircle className=\"h-4 w-4\" />\n                  Complete Ticket\n                </button>\n              )}\n\n              {/* Put On Hold - Available for open, assigned, in_progress */}\n              {['open', 'assigned', 'in_progress'].includes(ticket.status) && (\n                <button\n                  onClick={() => {\n                    updateStatusMutation.mutate({\n                      status: 'on_hold',\n                      notes: 'Put on hold via quick action'\n                    })\n                  }}\n                  disabled={updateStatusMutation.isLoading}\n                  className=\"px-4 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 disabled:bg-gray-400 text-sm font-medium inline-flex items-center gap-2 transition-colors\"\n                >\n                  <Clock className=\"h-4 w-4\" />\n                  Put On Hold\n                </button>\n              )}\n\n              {/* Cancel - Available for all except already cancelled */}\n              {ticket.status !== 'cancelled' && (\n                <button\n                  onClick={() => {\n                    if (window.confirm('Are you sure you want to cancel this ticket?')) {\n                      updateStatusMutation.mutate({\n                        status: 'cancelled',\n                        notes: 'Cancelled via quick action'\n                      })\n                    }\n                  }}\n                  disabled={updateStatusMutation.isLoading}\n                  className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 text-sm font-medium inline-flex items-center gap-2 transition-colors\"\n                >\n                  <XCircle className=\"h-4 w-4\" />\n                  Cancel\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Tabs */}\n      <div className=\"border-b border-gray-200\">\n        <nav className=\"-mb-px flex space-x-8\">\n          {tabs.map((tab) => {\n            const Icon = tab.icon\n            return (\n              <button\n                key={tab.id}\n                onClick={() => setActiveTab(tab.id)}\n                className={`\n                  flex items-center py-2 px-1 border-b-2 font-medium text-sm\n                  ${activeTab === tab.id\n                    ? 'border-blue-500 text-blue-600'\n                    : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n                  }\n                `}\n              >\n                <Icon className=\"h-4 w-4 mr-2\" />\n                {tab.label}\n              </button>\n            )\n          })}\n        </nav>\n      </div>\n\n      {/* Tab Content */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {/* Main Content */}\n        <div className=\"lg:col-span-2\">\n          {activeTab === 'details' && (\n            <div className=\"space-y-6\">\n              {/* Ticket Information */}\n              <div className=\"card\">\n                <div className=\"card-header\">\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Ticket Information</h3>\n                </div>\n                <div className=\"card-body\">\n                  <dl className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div>\n                      <dt className=\"text-sm font-medium text-gray-600\">Type</dt>\n                      <dd className=\"text-sm text-gray-900\">{ticket.service_type_name || ticket.type}</dd>\n                    </div>\n                    {(ticket.category_name || ticket.category) && ticket.category !== 'Not specified' && (\n                      <div>\n                        <dt className=\"text-sm font-medium text-gray-600\">Category</dt>\n                        <dd className=\"text-sm text-gray-900\">{ticket.category_name || ticket.category}</dd>\n                      </div>\n                    )}\n                    {ticket.scheduled_date && (\n                      <div>\n                        <dt className=\"text-sm font-medium text-gray-600\">Scheduled Date</dt>\n                        <dd className=\"text-sm text-gray-900\">{formatDateTime(ticket.scheduled_date)}</dd>\n                      </div>\n                    )}\n                    {ticket.estimated_duration && (\n                      <div>\n                        <dt className=\"text-sm font-medium text-gray-600\">Estimated Duration</dt>\n                        <dd className=\"text-sm text-gray-900\">{ticket.estimated_duration} minutes</dd>\n                      </div>\n                    )}\n                    {ticket.started_at && (\n                      <div>\n                        <dt className=\"text-sm font-medium text-gray-600\">Started At</dt>\n                        <dd className=\"text-sm text-gray-900\">{formatDateTime(ticket.started_at)}</dd>\n                      </div>\n                    )}\n                    {ticket.completed_at && (\n                      <div>\n                        <dt className=\"text-sm font-medium text-gray-600\">Completed At</dt>\n                        <dd className=\"text-sm text-gray-900\">{formatDateTime(ticket.completed_at)}</dd>\n                      </div>\n                    )}\n                    {ticket.started_at && ticket.completed_at && (\n                      <div>\n                        <dt className=\"text-sm font-medium text-gray-600\">Actual Duration</dt>\n                        <dd className=\"text-sm text-gray-900\">\n                          {calculateDuration(ticket.started_at, ticket.completed_at)}\n                        </dd>\n                      </div>\n                    )}\n                  </dl>\n                </div>\n              </div>\n\n              {/* Description */}\n              <div className=\"card\">\n                <div className=\"card-header\">\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Description</h3>\n                </div>\n                <div className=\"card-body\">\n                  <p className=\"text-gray-700 whitespace-pre-wrap leading-relaxed\">{ticket.description}</p>\n                </div>\n              </div>\n\n              {/* Work Notes */}\n              {ticket.work_notes && (\n                <div className=\"card\">\n                  <div className=\"card-header\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Work Notes</h3>\n                  </div>\n                  <div className=\"card-body\">\n                    <p className=\"text-gray-700 whitespace-pre-wrap\">{ticket.work_notes}</p>\n                  </div>\n                </div>\n              )}\n\n              {/* Resolution */}\n              {ticket.resolution_notes && (\n                <div className=\"card\">\n                  <div className=\"card-header\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Resolution</h3>\n                  </div>\n                  <div className=\"card-body\">\n                    <p className=\"text-gray-700 whitespace-pre-wrap\">{ticket.resolution_notes}</p>\n                    {ticket.customer_rating && (\n                      <div className=\"mt-4 pt-4 border-t border-gray-200\">\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"text-sm font-medium text-gray-600\">Customer Rating:</span>\n                          <div className=\"flex items-center\">\n                            {'⭐'.repeat(ticket.customer_rating)}\n                            <span className=\"ml-2 text-sm text-gray-500\">\n                              ({ticket.customer_rating}/5)\n                            </span>\n                          </div>\n                        </div>\n                        {ticket.customer_feedback && (\n                          <div className=\"mt-2\">\n                            <p className=\"text-sm text-gray-600\">Feedback:</p>\n                            <p className=\"text-sm text-gray-900 italic\">\"{ticket.customer_feedback}\"</p>\n                          </div>\n                        )}\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* Completion Data */}\n              {ticket.completion_data && ticket.status === 'completed' && (\n                <div className=\"card\">\n                  <div className=\"card-header\">\n                    <h3 className=\"text-lg font-semibold text-gray-900\">Completion Details</h3>\n                  </div>\n                  <div className=\"card-body\">\n                    <dl className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {/* 1. Lokasi ODP */}\n                      {ticket.completion_data.odp_location && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Lokasi ODP</dt>\n                          <dd className=\"text-sm text-gray-900\">{ticket.completion_data.odp_location}</dd>\n                        </div>\n                      )}\n                      \n                      {/* 2. Jarak ODP */}\n                      {ticket.completion_data.odp_distance && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Jarak ODP</dt>\n                          <dd className=\"text-sm text-gray-900\">{ticket.completion_data.odp_distance} meter</dd>\n                        </div>\n                      )}\n                      \n                      {/* 3. Redaman Terakhir */}\n                      {ticket.completion_data.final_attenuation && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Redaman Terakhir</dt>\n                          <dd className=\"text-sm text-gray-900\">{ticket.completion_data.final_attenuation} dB</dd>\n                        </div>\n                      )}\n                      \n                      {/* 4. Nama WiFi */}\n                      {ticket.completion_data.wifi_name && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Nama WiFi</dt>\n                          <dd className=\"text-sm text-gray-900\">{ticket.completion_data.wifi_name}</dd>\n                        </div>\n                      )}\n                      \n                      {/* 5. Password WiFi */}\n                      {ticket.completion_data.wifi_password && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Password WiFi</dt>\n                          <dd className=\"text-sm text-gray-900 font-mono\">{ticket.completion_data.wifi_password}</dd>\n                        </div>\n                      )}\n                      \n                      {/* 6. Tanggal Aktif (Installation) - Moved here before photos */}\n                      {ticket.completion_data.activation_date && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Tanggal Aktif</dt>\n                          <dd className=\"text-sm text-gray-900\">{formatDateTime(ticket.completion_data.activation_date)}</dd>\n                        </div>\n                      )}\n                      \n                      {/* Repair Date (for maintenance/repair) */}\n                      {ticket.completion_data.repair_date && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">Tanggal Perbaikan</dt>\n                          <dd className=\"text-sm text-gray-900\">{formatDateTime(ticket.completion_data.repair_date)}</dd>\n                        </div>\n                      )}\n                      \n                      {/* New Category (for upgrades) */}\n                      {ticket.completion_data.new_category && (\n                        <div>\n                          <dt className=\"text-sm font-medium text-gray-600\">New Category</dt>\n                          <dd className=\"text-sm text-gray-900\">{ticket.completion_data.new_category}</dd>\n                        </div>\n                      )}\n                    </dl>\n                    \n                    {/* Photos - Side by side in 3 columns */}\n                    {(ticket.completion_data.otdr_photo || ticket.completion_data.attenuation_photo || ticket.completion_data.modem_sn_photo) && (\n                      <div className=\"mt-6 pt-6 border-t border-gray-200\">\n                        <h4 className=\"text-sm font-medium text-gray-900 mb-4\">Foto Dokumentasi</h4>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                          {ticket.completion_data.otdr_photo && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-600 mb-2\">Foto OTDR</p>\n                              <a \n                                href={`${(import.meta.env.VITE_API_URL || 'http://localhost:3001/api').replace('/api', '')}${ticket.completion_data.otdr_photo.url}`}\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                className=\"block border border-gray-300 rounded-lg overflow-hidden hover:border-blue-500 transition-colors\"\n                              >\n                                <img \n                                  src={`${(import.meta.env.VITE_API_URL || 'http://localhost:3001/api').replace('/api', '')}${ticket.completion_data.otdr_photo.url}`}\n                                  alt=\"OTDR Photo\"\n                                  className=\"w-full h-32 object-cover\"\n                                  onError={(e) => console.error('Failed to load OTDR photo:', ticket.completion_data.otdr_photo.url)}\n                                />\n                                <div className=\"p-2 bg-gray-50\">\n                                  <p className=\"text-xs text-gray-600 truncate\">{ticket.completion_data.otdr_photo.filename}</p>\n                                </div>\n                              </a>\n                            </div>\n                          )}\n                          \n                          {ticket.completion_data.attenuation_photo && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-600 mb-2\">Foto Redaman</p>\n                              <a \n                                href={`${(import.meta.env.VITE_API_URL || 'http://localhost:3001/api').replace('/api', '')}${ticket.completion_data.attenuation_photo.url}`}\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                className=\"block border border-gray-300 rounded-lg overflow-hidden hover:border-blue-500 transition-colors\"\n                              >\n                                <img \n                                  src={`${(import.meta.env.VITE_API_URL || 'http://localhost:3001/api').replace('/api', '')}${ticket.completion_data.attenuation_photo.url}`}\n                                  alt=\"Attenuation Photo\"\n                                  className=\"w-full h-32 object-cover\"\n                                  onError={(e) => console.error('Failed to load Attenuation photo:', ticket.completion_data.attenuation_photo.url)}\n                                />\n                                <div className=\"p-2 bg-gray-50\">\n                                  <p className=\"text-xs text-gray-600 truncate\">{ticket.completion_data.attenuation_photo.filename}</p>\n                                </div>\n                              </a>\n                            </div>\n                          )}\n                          \n                          {ticket.completion_data.modem_sn_photo && (\n                            <div>\n                              <p className=\"text-xs font-medium text-gray-600 mb-2\">Foto SN Modem</p>\n                              <a \n                                href={`${(import.meta.env.VITE_API_URL || 'http://localhost:3001/api').replace('/api', '')}${ticket.completion_data.modem_sn_photo.url}`}\n                                target=\"_blank\"\n                                rel=\"noopener noreferrer\"\n                                className=\"block border border-gray-300 rounded-lg overflow-hidden hover:border-blue-500 transition-colors\"\n                              >\n                                <img \n                                  src={`${(import.meta.env.VITE_API_URL || 'http://localhost:3001/api').replace('/api', '')}${ticket.completion_data.modem_sn_photo.url}`}\n                                  alt=\"Modem SN Photo\"\n                                  className=\"w-full h-32 object-cover\"\n                                  onError={(e) => console.error('Failed to load Modem SN photo:', ticket.completion_data.modem_sn_photo.url)}\n                                />\n                                <div className=\"p-2 bg-gray-50\">\n                                  <p className=\"text-xs text-gray-600 truncate\">{ticket.completion_data.modem_sn_photo.filename}</p>\n                                </div>\n                              </a>\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'status' && (\n            <StatusUpdateForm\n              ticket={ticket}\n              onUpdate={updateStatusMutation.mutate}\n              isLoading={updateStatusMutation.isLoading}\n              preSelectedStatus={preSelectedStatus}\n              onStatusPreSelected={() => setPreSelectedStatus(null)}\n            />\n          )}\n\n          {activeTab === 'history' && (\n            <div className=\"card\">\n              <div className=\"card-header\">\n                <div className=\"flex items-center justify-between\">\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Status History</h3>\n                  <span className=\"text-sm text-gray-500\">\n                    {ticket.status_history?.length || 0} changes\n                  </span>\n                </div>\n              </div>\n              <div className=\"card-body\">\n                {ticket.status_history && ticket.status_history.length > 0 ? (\n                  <div className=\"relative\">\n                    {/* Timeline line */}\n                    <div className=\"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-200\"></div>\n                    \n                    <div className=\"space-y-6\">\n                      {ticket.status_history.map((history, index) => {\n                        const statusIcons = {\n                          'open': { icon: FileText, color: 'blue', bg: 'bg-blue-100', border: 'border-blue-200' },\n                          'assigned': { icon: User, color: 'indigo', bg: 'bg-indigo-100', border: 'border-indigo-200' },\n                          'in_progress': { icon: PlayCircle, color: 'yellow', bg: 'bg-yellow-100', border: 'border-yellow-200' },\n                          'on_hold': { icon: Clock, color: 'purple', bg: 'bg-purple-100', border: 'border-purple-200' },\n                          'completed': { icon: CheckCircle, color: 'green', bg: 'bg-green-100', border: 'border-green-200' },\n                          'cancelled': { icon: XCircle, color: 'red', bg: 'bg-red-100', border: 'border-red-200' }\n                        }\n                        const statusConfig = statusIcons[history.new_status] || statusIcons['open']\n                        const StatusIcon = statusConfig.icon\n                        \n                        // Calculate time since this change\n                        const nextHistory = ticket.status_history[index + 1]\n                        const timeSince = nextHistory \n                          ? calculateDuration(history.created_at, nextHistory.created_at)\n                          : null\n                        \n                        return (\n                          <div key={history.id} className=\"relative flex items-start space-x-4\">\n                            {/* Timeline dot */}\n                            <div className=\"relative flex-shrink-0 z-10\">\n                              <div className={`h-10 w-10 ${statusConfig.bg} rounded-full flex items-center justify-center border-2 ${statusConfig.border} shadow-sm`}>\n                                <StatusIcon className={`h-5 w-5 text-${statusConfig.color}-600`} />\n                              </div>\n                            </div>\n                            \n                            {/* Content */}\n                            <div className=\"flex-1 min-w-0 bg-white border border-gray-200 rounded-lg p-4 shadow-sm\">\n                              {/* Header */}\n                              <div className=\"flex items-start justify-between mb-2\">\n                                <div className=\"flex items-center gap-2 flex-wrap\">\n                                  {history.old_status && (\n                                    <>\n                                      <span className=\"text-xs text-gray-500 capitalize\">{history.old_status.replace('_', ' ')}</span>\n                                      <span className=\"text-gray-400\">→</span>\n                                    </>\n                                  )}\n                                  {getStatusBadge(history.new_status)}\n                                  {timeSince && (\n                                    <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded\">\n                                      Duration: {timeSince}\n                                    </span>\n                                  )}\n                                </div>\n                                <span className=\"text-xs text-gray-400\">\n                                  #{index + 1}\n                                </span>\n                              </div>\n                              \n                              {/* Metadata */}\n                              <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-2\">\n                                <div className=\"flex items-center gap-1\">\n                                  <User className=\"h-3.5 w-3.5\" />\n                                  <span className=\"font-medium\">{history.changed_by_name}</span>\n                                </div>\n                                <div className=\"flex items-center gap-1\">\n                                  <Calendar className=\"h-3.5 w-3.5\" />\n                                  <span>{formatDateTime(history.created_at)}</span>\n                                </div>\n                              </div>\n                              \n                              {/* Technician Assignment */}\n                              {history.technician_name && (\n                                <div className=\"flex items-center gap-2 mb-2 p-2 bg-blue-50 rounded border-l-2 border-blue-400\">\n                                  <User className=\"h-4 w-4 text-blue-600\" />\n                                  <span className=\"text-sm text-blue-900\">\n                                    <span className=\"font-medium\">Assigned to:</span> {history.technician_name}\n                                    <span className=\"text-xs text-blue-600 ml-1\">({history.technician_employee_id})</span>\n                                  </span>\n                                </div>\n                              )}\n                              \n                              {/* Notes */}\n                              {history.notes && (\n                                <div className=\"mt-2 p-3 bg-gray-50 rounded border-l-2 border-gray-300\">\n                                  <div className=\"flex items-start gap-2\">\n                                    <FileText className=\"h-4 w-4 text-gray-400 mt-0.5 flex-shrink-0\" />\n                                    <p className=\"text-sm text-gray-700 whitespace-pre-wrap leading-relaxed\">\n                                      {history.notes}\n                                    </p>\n                                  </div>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        )\n                      })}\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <Clock className=\"h-12 w-12 text-gray-300 mx-auto mb-3\" />\n                    <p className=\"text-gray-500\">No status history available</p>\n                    <p className=\"text-sm text-gray-400 mt-1\">Status changes will appear here</p>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Sidebar */}\n        <div className=\"space-y-6\">\n          {/* Package Information */}\n          {ticket.package_name && (\n            <div className=\"card\">\n              <div className=\"card-header\">\n                <h3 className=\"text-lg font-semibold text-gray-900\">Package Information</h3>\n              </div>\n              <div className=\"card-body space-y-3\">\n                <div className=\"flex items-center space-x-3\">\n                  <Package className=\"h-5 w-5 text-gray-400\" />\n                  <div>\n                    <p className=\"text-sm font-medium text-gray-900\">{ticket.package_name}</p>\n                    <p className=\"text-sm text-gray-500\">{ticket.service_type}</p>\n                  </div>\n                </div>\n                \n                {ticket.bandwidth_down && (\n                  <div className=\"flex justify-between items-center py-2 border-t border-gray-100\">\n                    <span className=\"text-sm text-gray-500\">Bandwidth</span>\n                    <span className=\"text-sm font-medium\">\n                      <span className=\"text-blue-600\">↑ {ticket.bandwidth_up || ticket.bandwidth_down}</span>\n                      <span className=\"text-gray-400 mx-1\">/</span>\n                      <span className=\"text-green-600\">↓ {ticket.bandwidth_down}</span>\n                      <span className=\"text-gray-900 ml-1\">Mbps</span>\n                    </span>\n                  </div>\n                )}\n                \n                {ticket.monthly_price && (\n                  <div className=\"flex justify-between items-center py-2 border-t border-gray-100\">\n                    <span className=\"text-sm text-gray-500\">Monthly Price</span>\n                    <span className=\"text-sm font-medium text-gray-900\">\n                      Rp {parseInt(ticket.monthly_price).toLocaleString('id-ID')}\n                    </span>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {/* Equipment Needed */}\n          {ticket.equipment_needed && (\n            <div className=\"card\">\n              <div className=\"card-header\">\n                <h3 className=\"text-lg font-semibold text-gray-900\">Equipment Needed</h3>\n              </div>\n              <div className=\"card-body\">\n                <p className=\"text-sm text-gray-700 whitespace-pre-wrap\">{ticket.equipment_needed}</p>\n              </div>\n            </div>\n          )}\n\n          {/* Attachments */}\n          <div className=\"card\">\n            <div className=\"card-header\">\n              <h3 className=\"text-lg font-semibold text-gray-900\">Attachments</h3>\n            </div>\n            <div className=\"card-body\">\n              {ticket.attachments && ticket.attachments.length > 0 ? (\n                <div className=\"space-y-2\">\n                  {ticket.attachments.map((attachment) => (\n                    <div key={attachment.id} className=\"flex items-center justify-between p-2 bg-gray-50 rounded\">\n                      <div className=\"flex items-center space-x-2\">\n                        <FileText className=\"h-4 w-4 text-gray-400\" />\n                        <span className=\"text-sm text-gray-900\">{attachment.original_filename}</span>\n                      </div>\n                      <button className=\"text-blue-600 hover:text-blue-800\">\n                        <Download className=\"h-4 w-4\" />\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              ) : (\n                <div className=\"text-center py-4\">\n                  <Upload className=\"h-8 w-8 text-gray-400 mx-auto mb-2\" />\n                  <p className=\"text-sm text-gray-500\">No attachments</p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default TicketDetailPage\n"],"names":["technicianService","_0","__async","params","queryString","api","id","technicianData","availabilityData","skillData","period","locationData","startDate","endDate","scheduleData","SmartAssignmentModal","isOpen","onClose","ticket","assignmentMode","setAssignmentMode","useState","selectedTechnician","setSelectedTechnician","assignmentOptions","setAssignmentOptions","queryClient","useQueryClient","recommendationsData","loadingRecommendations","useQuery","ticketService","autoAssignMutation","useMutation","options","data","toast","error","_b","_a","manualAssignMutation","technicianId","handleAutoAssign","handleManualAssign","getAvailabilityBadge","status","badges","CheckCircle","AlertCircle","badge","Icon","jsx","getCapacityBadge","getDistanceBadge","Navigation","getSkillLevelBadge","level","Award","recommendations","ticketData","jsxs","Target","X","Zap","Users","e","prev","__spreadProps","__spreadValues","values","option","LoadingSpinner","tech","User","Star","Clock","TrendingUp","MapPin","spec","index","Wrench","Fragment","Loader","MultiTechnicianSelector","availableTechnicians","selectedTechnicians","leadTechnicianId","onChange","onLeadChange","searchQuery","setSearchQuery","filteredTechnicians","handleToggleTechnician","t","newSelection","newTech","handleSetLead","techId","updated","handleSetRole","newRole","getTechnicianWorkload","isSelected","getSelectedRole","Search","selected","role","isLead","workload","Briefcase","Activity","TeamAssignmentModal","setSelectedTechnicians","setLeadTechnicianId","techniciansData","isLoading","assignTeamMutation","technicians","handleSubmit","TicketsPage","navigate","useNavigate","currentUser","isAdmin","isSupervisor","isTechnician","isCustomerService","useAuth","showCreateForm","setShowCreateForm","showAssignmentModal","setShowAssignmentModal","showTeamAssignmentModal","setShowTeamAssignmentModal","selectedTicketForAssignment","setSelectedTicketForAssignment","currentPage","setCurrentPage","limit","setLimit","sortBy","setSortBy","sortOrder","setSortOrder","isExporting","setIsExporting","technicianView","setTechnicianView","filters","setFilters","selectedTickets","setSelectedTickets","selectAll","setSelectAll","copiedField","setCopiedField","formatTypeName","type","ticketsData","refetch","statsData","useEffect","handleTicketUpdate","handleCreateSuccess","handleSort","column","getSortIcon","ArrowUpDown","ArrowUp","ArrowDown","handleExport","allTickets","exportData","formatDate","result","exportToExcel","closeAssignmentModal","getStatusBadge","statusConfig","config","getPriorityBadge","priority","priorityConfig","handleSelectAll","handleSelectTicket","ticketId","newSelected","handleBulkClose","successCount","errorCount","handleBulkDelete","handleCopyToClipboard","text","fieldName","err","handleQuickAssign","handleQuickTeamAssign","handleQuickComplete","handleQuickCall","phone","hasAccess","canCreate","canDelete","canAssign","stats","Loader2","Download","Plus","UserPlus","Trash2","KPICard","Ticket","FileCheck","PlayCircle","XCircle","Check","Copy","PhoneCall","techData","myTechProfile","_d","_c","_e","ChevronLeft","_","i","totalPages","page","ChevronRight","TicketCreateForm","ShieldAlert","odpService","queryParams","StatusUpdateForm","onUpdate","preSelectedStatus","onStatusPreSelected","user","selectedStatus","setSelectedStatus","register","errors","reset","watch","setValue","useForm","odpList","odpLoading","odpError","response","odpArray","activeOdps","odp","packagesList","packagesLoading","packagesError","packageService","otdrPreview","setOtdrPreview","attenuationPreview","setAttenuationPreview","modemSnPreview","setModemSnPreview","otdrFile","setOtdrFile","attenuationFile","setAttenuationFile","modemSnFile","setModemSnFile","now","year","month","day","hours","minutes","datetimeLocal","techniciansLoading","statusOptions","Play","Pause","availableStatuses","currentStatus","userRole","allowedStatuses","s","fileToBase64","file","resolve","reject","reader","onSubmit","autoGenerateNotes","customerName","customerId","ticketType","ticketTypeName","oldStatus","newStatus","customerAddress","packageName","bandwidth","technicianName","formatDateTime","date","d","calculateTargetCompletion","estimatedMinutes","target","getEquipmentList","getEstimatedDuration","formatSLA","sla","diffHours","diffDays","ticketTypeKey","notes","currentTime","estimatedDuration","targetTime","equipment","completionTime","autoGenerateResolutionNotes","updateData","otdr_photo_base64","attenuation_photo_base64","modem_sn_photo_base64","selectedOdpData","canUpdateStatus","isCurrent","Upload","pkg","TechnicianTeamDisplay","TicketDetailPage","useParams","activeTab","setActiveTab","setPreSelectedStatus","myTechnicianData","updateStatusMutation","dateString","calculateDuration","start","diffMs","diffMinutes","BackButton","tabs","FileText","Calendar","Link","tab","history","statusIcons","StatusIcon","nextHistory","timeSince","Package","attachment"],"mappings":"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"}