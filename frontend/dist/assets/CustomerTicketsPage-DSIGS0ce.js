var A=Object.defineProperty,P=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var D=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var v=(r,t,a)=>t in r?A(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,u=(r,t)=>{for(var a in t||(t={}))D.call(t,a)&&v(r,a,t[a]);if(N)for(var a of N(t))L.call(t,a)&&v(r,a,t[a]);return r},x=(r,t)=>P(r,_(t));var g=(r,t,a)=>new Promise((m,p)=>{var l=n=>{try{c(a.next(n))}catch(d){p(d)}},o=n=>{try{c(a.throw(n))}catch(d){p(d)}},c=n=>n.done?m(n.value):Promise.resolve(n.value).then(l,o);c((a=a.apply(r,t)).next())});import{j as e,a as w}from"./notifications-Dggueh-l.js";import{r as b}from"./react-vendor-BQ7pSkNi.js";import{a as M,b as $,u as I}from"./react-query-B7OIdD7u.js";import{af as j,P as z,g as q,U as k,X as U,C as E,a as F,N as J,z as C}from"./ui-vendor-CO1ReX4_.js";import{C as Q}from"./CustomerPortalLayout-0dW5kJg3.js";import"./charts-CREYXqqm.js";const V=()=>{var f;const r=M(),[t,a]=b.useState(!1),[m,p]=b.useState("all"),[l,o]=b.useState({type:"repair",title:"",description:"",priority:"normal"}),{data:c,isLoading:n}=$(["customer-tickets",m],()=>g(void 0,null,function*(){const s=localStorage.getItem("customerToken"),i=m!=="all"?`?status=${m}`:"";return(yield w.get(`/customer-portal/tickets${i}`,{headers:{Authorization:`Bearer ${s}`}})).data})),d=I(s=>g(void 0,null,function*(){const i=localStorage.getItem("customerToken");return w.post("/customer-portal/tickets",s,{headers:{Authorization:`Bearer ${i}`}})}),{onSuccess:()=>{C.success("Tiket berhasil dibuat! Tim kami akan segera memproses."),a(!1),o({type:"repair",title:"",description:"",priority:"normal"}),r.invalidateQueries("customer-tickets")},onError:s=>{var i,h;C.error(((h=(i=s.response)==null?void 0:i.data)==null?void 0:h.message)||"Gagal membuat tiket")}}),y=((f=c==null?void 0:c.data)==null?void 0:f.tickets)||[],T=s=>({open:"bg-blue-100 text-blue-700",assigned:"bg-purple-100 text-purple-700",in_progress:"bg-yellow-100 text-yellow-700",completed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",on_hold:"bg-gray-100 text-gray-700"})[s]||"bg-gray-100 text-gray-700",S=s=>({open:e.jsx(J,{className:"h-4 w-4"}),assigned:e.jsx(k,{className:"h-4 w-4"}),in_progress:e.jsx(F,{className:"h-4 w-4"}),completed:e.jsx(E,{className:"h-4 w-4"})})[s]||e.jsx(j,{className:"h-4 w-4"}),B=s=>{s.preventDefault(),d.mutate(l)};return e.jsx(Q,{children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[e.jsx(j,{className:"h-7 w-7 mr-2 text-blue-600"}),"Tiket Saya"]}),e.jsx("p",{className:"text-gray-600",children:"Kelola tiket support Anda"})]}),e.jsxs("button",{onClick:()=>a(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"Buat Tiket Baru"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","open","in_progress","completed"].map(s=>e.jsx("button",{onClick:()=>p(s),className:`px-4 py-2 rounded-lg transition-colors ${m===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s==="all"?"Semua":s==="in_progress"?"In Progress":s.charAt(0).toUpperCase()+s.slice(1)},s))})}),n?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"})}):y.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(j,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Belum ada tiket"}),e.jsx("button",{onClick:()=>a(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Buat tiket pertama Anda â†’"})]}):e.jsx("div",{className:"space-y-4",children:y.map(s=>e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-900",children:["#",s.ticket_number]}),e.jsxs("span",{className:`px-3 py-1 text-sm rounded-full flex items-center space-x-1 ${T(s.status)}`,children:[S(s.status),e.jsx("span",{children:s.status})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.priority==="high"?"bg-red-100 text-red-700":s.priority==="normal"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.priority})]}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),new Date(s.created_at).toLocaleDateString("id-ID")]}),s.technician_name&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Teknisi: ",s.technician_name]})]})]})})},s.id))}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Buat Tiket Baru"}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(U,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Tiket"}),e.jsxs("select",{value:l.type,onChange:s=>o(x(u({},l),{type:s.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"repair",children:"Perbaikan (Repair)"}),e.jsx("option",{value:"upgrade",children:"Upgrade Paket"}),e.jsx("option",{value:"dismantle",children:"Pemutusan Layanan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul Masalah"}),e.jsx("input",{type:"text",value:l.title,onChange:s=>o(x(u({},l),{title:s.target.value})),placeholder:"Contoh: Internet lambat atau putus-putus",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Detail"}),e.jsx("textarea",{value:l.description,onChange:s=>o(x(u({},l),{description:s.target.value})),placeholder:"Jelaskan masalah Anda secara detail...",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioritas"}),e.jsxs("select",{value:l.priority,onChange:s=>o(x(u({},l),{priority:s.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"low",children:"Low (Tidak mendesak)"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High (Mendesak)"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Catatan:"})," Tiket Anda akan segera diproses oleh tim kami. Anda akan menerima notifikasi WhatsApp untuk setiap update."]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:d.isLoading,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d.isLoading?"Membuat...":"Buat Tiket"})]})]})]})})})]})})};export{V as default};
//# sourceMappingURL=CustomerTicketsPage-DSIGS0ce.js.map
