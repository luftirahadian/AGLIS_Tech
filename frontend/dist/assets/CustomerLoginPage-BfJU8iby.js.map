{"version":3,"file":"CustomerLoginPage-BfJU8iby.js","sources":["../../src/pages/customer-portal/CustomerLoginPage.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { MessageCircle, Lock, Phone, LogIn } from 'lucide-react';\nimport toast from 'react-hot-toast';\nimport api from '../../services/api';\n\nconst CustomerLoginPage = () => {\n  const navigate = useNavigate();\n  const [step, setStep] = useState('phone'); // 'phone' or 'otp'\n  const [phone, setPhone] = useState('');\n  const [otp, setOtp] = useState('');\n  const [loading, setLoading] = useState(false);\n\n  const handleRequestOTP = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    console.log('üîµ handleRequestOTP called, phone:', phone);\n\n    try {\n      console.log('üîµ Sending request to /customer-portal/request-otp');\n      const response = await api.post('/customer-portal/request-otp', { phone });\n      console.log('üîµ Full response:', response);\n      console.log('üîµ response.success:', response.success);\n      console.log('üîµ response.data:', response.data);\n      \n      if (response.success) {\n        console.log('üîµ Success! Showing toast and changing step to OTP');\n        toast.success('Kode OTP telah dikirim ke WhatsApp Anda!');\n        setStep('otp');\n        console.log('üîµ Step changed to: otp');\n      } else {\n        console.log('‚ùå response.success is false or undefined');\n      }\n    } catch (error) {\n      console.error('‚ùå Error:', error);\n      toast.error(error.response?.data?.message || 'Gagal mengirim OTP');\n    } finally {\n      setLoading(false);\n      console.log('üîµ Loading set to false');\n    }\n  };\n\n  const handleVerifyOTP = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n    console.log('üü¢ handleVerifyOTP called, phone:', phone, 'otp:', otp);\n\n    try {\n      console.log('üü¢ Sending verify request');\n      const response = await api.post('/customer-portal/verify-otp', { phone, otp });\n      console.log('üü¢ Verify response:', response);\n      \n      if (response.success) {\n        console.log('üü¢ Login SUCCESS! Token:', response.data?.token?.substring(0, 20) + '...');\n        // Store token\n        localStorage.setItem('customerToken', response.data.token);\n        localStorage.setItem('customerData', JSON.stringify(response.data.customer));\n        \n        toast.success('Login berhasil!');\n        console.log('üü¢ Navigating to /customer/dashboard');\n        navigate('/customer/dashboard');\n      } else {\n        console.log('‚ùå response.success is false');\n      }\n    } catch (error) {\n      console.error('‚ùå Verify error:', error);\n      toast.error(error.response?.data?.message || 'Kode OTP salah atau expired');\n      setOtp('');\n    } finally {\n      setLoading(false);\n      console.log('üü¢ Loading set to false');\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full\">\n        {/* Logo & Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-blue-600 to-green-600 rounded-2xl mb-4\">\n            <MessageCircle className=\"h-10 w-10 text-white\" />\n          </div>\n          <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">AGLIS Customer Portal</h1>\n          <p className=\"text-gray-600\">Login dengan nomor WhatsApp Anda</p>\n        </div>\n\n        {/* Login Form */}\n        <div className=\"bg-white rounded-2xl shadow-xl p-8\">\n          {step === 'phone' ? (\n            <form onSubmit={handleRequestOTP} className=\"space-y-6\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Nomor WhatsApp\n                </label>\n                <div className=\"relative\">\n                  <Phone className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type=\"tel\"\n                    value={phone}\n                    onChange={(e) => setPhone(e.target.value)}\n                    placeholder=\"08123456789\"\n                    className=\"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                    required\n                  />\n                </div>\n                <p className=\"mt-2 text-sm text-gray-500\">\n                  Gunakan nomor WhatsApp yang terdaftar sebagai customer\n                </p>\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={loading || !phone}\n                className=\"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n              >\n                {loading ? (\n                  <>\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent\"></div>\n                    <span>Mengirim OTP...</span>\n                  </>\n                ) : (\n                  <>\n                    <MessageCircle className=\"h-5 w-5\" />\n                    <span>Kirim Kode OTP</span>\n                  </>\n                )}\n              </button>\n            </form>\n          ) : (\n            <form onSubmit={handleVerifyOTP} className=\"space-y-6\">\n              <div className=\"text-center mb-4\">\n                <div className=\"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-3\">\n                  <Lock className=\"h-8 w-8 text-green-600\" />\n                </div>\n                <h3 className=\"text-lg font-semibold text-gray-900\">Masukkan Kode OTP</h3>\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  Kode telah dikirim ke WhatsApp {phone.replace(/(\\d{4})\\d+(\\d{3})/, '$1****$2')}\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Kode OTP (6 digit)\n                </label>\n                <input\n                  type=\"text\"\n                  value={otp}\n                  onChange={(e) => setOtp(e.target.value.replace(/\\D/g, '').slice(0, 6))}\n                  placeholder=\"000000\"\n                  className=\"w-full px-4 py-3 text-center text-2xl tracking-widest border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  maxLength={6}\n                  autoFocus\n                  required\n                />\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={loading || otp.length !== 6}\n                className=\"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-blue-600 to-green-600 text-white rounded-lg hover:from-blue-700 hover:to-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n              >\n                {loading ? (\n                  <>\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent\"></div>\n                    <span>Memverifikasi...</span>\n                  </>\n                ) : (\n                  <>\n                    <LogIn className=\"h-5 w-5\" />\n                    <span>Login</span>\n                  </>\n                )}\n              </button>\n\n              <button\n                type=\"button\"\n                onClick={() => { setStep('phone'); setOtp(''); }}\n                className=\"w-full text-sm text-gray-600 hover:text-gray-900\"\n              >\n                ‚Üê Kembali ke input nomor\n              </button>\n            </form>\n          )}\n\n          {/* Help Section */}\n          <div className=\"mt-6 pt-6 border-t border-gray-200\">\n            <p className=\"text-sm text-gray-600 text-center\">\n              Butuh bantuan?{' '}\n              <a href=\"https://wa.me/6281316003245\" className=\"text-blue-600 hover:text-blue-700 font-medium\">\n                Hubungi Customer Service\n              </a>\n            </p>\n          </div>\n        </div>\n\n        {/* Footer */}\n        <div className=\"mt-6 text-center text-sm text-gray-600\">\n          <p>¬© 2025 AGLIS Net. All rights reserved.</p>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CustomerLoginPage;\n\n"],"names":["CustomerLoginPage","navigate","useNavigate","step","setStep","useState","phone","setPhone","otp","setOtp","loading","setLoading","handleRequestOTP","e","__async","response","api","toast","error","_b","_a","handleVerifyOTP","_d","_c","jsxs","jsx","MessageCircle","Phone","Fragment","Lock","LogIn"],"mappings":"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"}