var J=Object.defineProperty,X=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var B=(a,r,t)=>r in a?J(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,M=(a,r)=>{for(var t in r||(r={}))se.call(r,t)&&B(a,t,r[t]);if(L)for(var t of L(r))ae.call(r,t)&&B(a,t,r[t]);return a},$=(a,r)=>X(a,ee(r));var o=(a,r,t)=>new Promise((h,d)=>{var S=n=>{try{b(t.next(n))}catch(y){d(y)}},p=n=>{try{b(t.throw(n))}catch(y){d(y)}},b=n=>n.done?h(n.value):Promise.resolve(n.value).then(S,p);b((t=t.apply(a,r)).next())});import{a as x,j as e}from"./notifications-BhPKxeX5.js";import{r as m}from"./react-vendor-BQ7pSkNi.js";import{b as te}from"./react-query-B7OIdD7u.js";import{L as re,K as _}from"./customers-BVnHcLLW.js";import{aH as G,$ as ie,aI as le,a2 as ne,S as ce,V as de,W as oe,Y as me,Z as xe,_ as he}from"./ui-vendor-ng1X_mIA.js";import"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";import"./forms-Dmkgx8TD.js";const pe={getAll:(...r)=>o(void 0,[...r],function*(a={}){try{const t=new URLSearchParams;a.service_type&&t.append("service_type",a.service_type),a.package_type&&t.append("package_type",a.package_type),a.is_free&&t.append("is_free",a.is_free),a.is_active&&t.append("is_active",a.is_active),a.search&&t.append("search",a.search),a.page&&t.append("page",a.page),a.limit&&t.append("limit",a.limit),a.sort_by&&t.append("sort_by",a.sort_by),a.sort_order&&t.append("sort_order",a.sort_order);const h=t.toString();return yield x.get(`/pricelist${h?"?"+h:""}`)}catch(t){return console.error("❌ PricelistService error:",t),{data:[],pagination:{},summary:[]}}}),getById:a=>o(void 0,null,function*(){return yield x.get(`/pricelist/${a}`)}),getByServiceType:(t,...h)=>o(void 0,[t,...h],function*(a,r={}){return yield x.get(`/pricelist/by-service/${a}`,{params:r})}),create:a=>o(void 0,null,function*(){return yield x.post("/pricelist",a)}),update:(a,r)=>o(void 0,null,function*(){return yield x.put(`/pricelist/${a}`,r)}),delete:a=>o(void 0,null,function*(){return yield x.delete(`/pricelist/${a}`)}),getSummary:()=>o(void 0,null,function*(){return yield x.get("/pricelist/reports/summary")})},_e=()=>{const[a,r]=m.useState(""),[t,h]=m.useState("all"),[d,S]=m.useState("all"),[p,b]=m.useState("all"),[n,y]=m.useState("base_price"),[f,C]=m.useState("desc"),[H,F]=m.useState({}),[N,O]=m.useState(10),R=[{code:"installation",name:"Installation"},{code:"repair",name:"Repair"},{code:"maintenance",name:"Maintenance"},{code:"upgrade",name:"Upgrade"},{code:"downgrade",name:"Downgrade"},{code:"wifi_setup",name:"WiFi Setup"},{code:"dismantle",name:"Dismantle"}],{data:g,isLoading:W}=te(["pricelist-all",t,d,p,a,n,f],()=>pe.getAll({is_active:"true",service_type:t!=="all"?t:void 0,package_type:d!=="all"?d:void 0,is_free:p!=="all"?p:void 0,search:a||void 0,page:1,limit:1e3,sort_by:n,sort_order:f}),{refetchOnWindowFocus:!1}),j=(g==null?void 0:g.data)||[];g!=null&&g.summary;const z=j.length,U=j.filter(s=>s.is_free).length,K=j.filter(s=>!s.is_free).length,q=[...new Set(j.map(s=>s.service_type_code))].length,D=j.reduce((s,l)=>(s[l.service_type_code]||(s[l.service_type_code]={type_name:l.type_name,items:[]}),s[l.service_type_code].items.push(l),s),{}),E=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(s),k=s=>{n===s?C(f==="asc"?"desc":"asc"):(y(s),C("asc"))},P=s=>n!==s?e.jsx(me,{className:"h-4 w-4 text-gray-400"}):f==="asc"?e.jsx(xe,{className:"h-4 w-4"}):e.jsx(he,{className:"h-4 w-4"}),Q=s=>{r(s.target.value)},I=(s,l)=>{s==="serviceType"?h(l):s==="package"?S(l):s==="isFree"&&b(l)},V=s=>H[s]||1,v=(s,l)=>{F(c=>$(M({},c),{[s]:l}))};return W?e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(re,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Price List"}),e.jsx("p",{className:"text-gray-600",children:"Daftar harga service dan biaya tambahan"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(_,{title:"Total Items",value:z,icon:G,color:"blue"}),e.jsx(_,{title:"Service Types",value:q,icon:ie,color:"purple"}),e.jsx(_,{title:"Gratis",value:U,icon:le,color:"green"}),e.jsx(_,{title:"Berbayar",value:K,icon:ne,color:"yellow"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari harga service...",value:a,onChange:Q})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Service Type"}),e.jsxs("select",{className:"form-input",value:t,onChange:s=>I("serviceType",s.target.value),children:[e.jsx("option",{value:"all",children:"Semua Service Type"}),R.map(s=>e.jsx("option",{value:s.code,children:s.name},s.code))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Package"}),e.jsxs("select",{className:"form-input",value:d,onChange:s=>I("package",s.target.value),children:[e.jsx("option",{value:"all",children:"Semua Paket"}),e.jsx("option",{value:"bronze",children:"Bronze"}),e.jsx("option",{value:"silver",children:"Silver"}),e.jsx("option",{value:"gold",children:"Gold"}),e.jsx("option",{value:"platinum",children:"Platinum"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Harga"}),e.jsxs("select",{className:"form-input",value:p,onChange:s=>I("isFree",s.target.value),children:[e.jsx("option",{value:"all",children:"Semua Harga"}),e.jsx("option",{value:"true",children:"Gratis"}),e.jsx("option",{value:"false",children:"Berbayar"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rows Per Table"}),e.jsxs("select",{className:"form-input",value:N,onChange:s=>{O(parseInt(s.target.value)),F({})},children:[e.jsx("option",{value:"5",children:"5 rows"}),e.jsx("option",{value:"10",children:"10 rows"}),e.jsx("option",{value:"25",children:"25 rows"}),e.jsx("option",{value:"50",children:"50 rows"})]})]})]})}),Object.keys(D).length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(G,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada price list"}),e.jsx("p",{className:"text-gray-500",children:"Data price list tidak ditemukan"})]}):e.jsx("div",{className:"space-y-6",children:Object.entries(D).map(([s,l])=>{const c=V(s),w=l.items.length,u=Math.ceil(w/N),T=(c-1)*N,A=T+N,Y=l.items.slice(T,A);return e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[l.type_name,e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",w," items)"]})]})}),e.jsxs("div",{className:"card-body p-0",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>k("price_name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Nama Service"}),P("price_name")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>k("category_name"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Kategori"}),P("category_name")]})}),e.jsx("th",{className:"table-header-cell",children:"Deskripsi"}),e.jsx("th",{className:"table-header-cell",children:"Paket"}),e.jsx("th",{className:"table-header-cell text-right cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>k("base_price"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Harga"}),P("base_price")]})}),e.jsx("th",{className:"table-header-cell",children:"Notes"})]})}),e.jsx("tbody",{className:"table-body",children:Y.map(i=>e.jsxs("tr",{children:[e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.price_name})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:i.category_name||"-"})}),e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-sm text-gray-900 truncate",style:{maxWidth:"200px"},title:i.description,children:i.description||"-"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:i.applies_to_package&&i.applies_to_package!=="all"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800 uppercase",children:i.applies_to_package}):e.jsx("span",{className:"text-xs text-gray-500",children:"All"})}),e.jsx("td",{className:"table-cell whitespace-nowrap text-right",children:i.is_free?e.jsx("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"🆓 GRATIS"}):e.jsx("div",{className:"text-sm font-bold text-gray-900",children:E(i.base_price)})}),e.jsx("td",{className:"table-cell",children:e.jsx("div",{className:"text-xs text-gray-600 italic truncate",style:{maxWidth:"150px"},title:i.notes,children:i.notes||"-"})})]},i.id))})]})}),u>1&&e.jsxs("div",{className:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>v(s,Math.max(1,c-1)),disabled:c===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>v(s,Math.min(u,c+1)),disabled:c===u,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:T+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(A,w)})," of"," ",e.jsx("span",{className:"font-medium",children:w})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>v(s,Math.max(1,c-1)),disabled:c===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(de,{className:"h-5 w-5"})}),Array.from({length:u},(i,Z)=>Z+1).map(i=>e.jsx("button",{onClick:()=>v(s,i),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${c===i?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:i},i)),e.jsx("button",{onClick:()=>v(s,Math.min(u,c+1)),disabled:c===u,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(oe,{className:"h-5 w-5"})})]})})]})]})]})]},s)})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-2xl",children:"💡"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Informasi Price List"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Price list ini dapat dilihat oleh public untuk transparansi harga"}),e.jsx("li",{children:"• Harga dapat berbeda tergantung paket yang dilanggan customer"}),e.jsx("li",{children:"• Service yang ditandai GRATIS tidak dikenakan biaya tambahan"}),e.jsx("li",{children:"• Biaya kabel tambahan dan spare part dikenakan terpisah jika diperlukan"})]})]})]})})]})};export{_e as default};
//# sourceMappingURL=PriceListPage-CoCUOXQG.js.map
