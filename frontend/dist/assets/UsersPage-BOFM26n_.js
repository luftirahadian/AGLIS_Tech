var Ss=Object.defineProperty,_s=Object.defineProperties;var Ps=Object.getOwnPropertyDescriptors;var $e=Object.getOwnPropertySymbols;var As=Object.prototype.hasOwnProperty,Us=Object.prototype.propertyIsEnumerable;var Ee=(s,l,a)=>l in s?Ss(s,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[l]=a,E=(s,l)=>{for(var a in l||(l={}))As.call(l,a)&&Ee(s,a,l[a]);if($e)for(var a of $e(l))Us.call(l,a)&&Ee(s,a,l[a]);return s},se=(s,l)=>_s(s,Ps(l));var P=(s,l,a)=>new Promise((r,f)=>{var g=i=>{try{b(a.next(i))}catch(n){f(n)}},x=i=>{try{b(a.throw(i))}catch(n){f(n)}},b=i=>i.done?r(i.value):Promise.resolve(i.value).then(g,x);b((a=a.apply(s,l)).next())});import{a as F,j as e}from"./notifications-DWMisRkI.js";import{r as m}from"./react-vendor-BQ7pSkNi.js";import{b as ge,u as Se,a as Ds}from"./react-query-B7OIdD7u.js";import{d as B,w as qe,r as Ls,L as Qe,u as Rs,K as ue}from"./customers-B56UMpVp.js";import{u as Is}from"./forms-Dmkgx8TD.js";import{p as $s}from"./index-Bd6U60S2.js";import{aE as Te,N as Me,X as le,U as _e,m as pe,a6 as Ne,I as Fe,C as ae,aF as Ve,z as o,aG as Pe,u as be,d as ye,A as Oe,T as Ae,b as ve,aH as We,o as Es,g as Ts,K as Ge,ai as we,D as ke,v as Ce,a as Ms,w as fe,aI as Fs,a5 as He,x as Vs,P as Be,an as te,S as ze,aJ as Os,Q as Bs,V as zs,W as qs,Y as Qs,Z as Ws}from"./ui-vendor-r_Nxhu34.js";import"./charts-CREYXqqm.js";import"./socket-BFcXWKeu.js";const I={getAll:(...l)=>P(void 0,[...l],function*(s={}){try{const a=new URLSearchParams;s.role&&a.append("role",s.role),s.status&&a.append("status",s.status),s.search&&a.append("search",s.search),s.page&&a.append("page",s.page),s.limit&&a.append("limit",s.limit),s.sort_by&&a.append("sort_by",s.sort_by),s.sort_order&&a.append("sort_order",s.sort_order);const r=a.toString();return yield F.get(`/users${r?"?"+r:""}`)}catch(a){return console.error("❌ UserService error:",a),{data:[],pagination:{}}}}),getById:s=>P(void 0,null,function*(){return yield F.get(`/users/${s}`)}),create:s=>P(void 0,null,function*(){return yield F.post("/users",s)}),update:(s,l)=>P(void 0,null,function*(){return yield F.put(`/users/${s}`,l)}),delete:s=>P(void 0,null,function*(){return yield F.delete(`/users/${s}`)}),updatePassword:(s,l)=>P(void 0,null,function*(){return yield F.put(`/users/${s}/password`,l)}),resetPassword:(s,l)=>P(void 0,null,function*(){return yield F.post(`/users/${s}/reset-password`,{new_password:l})}),getActivityLogs:(...l)=>P(void 0,[...l],function*(s={}){try{const a=new URLSearchParams;s.user_id&&a.append("user_id",s.user_id),s.target_user_id&&a.append("target_user_id",s.target_user_id),s.action&&a.append("action",s.action),s.limit&&a.append("limit",s.limit),s.page&&a.append("page",s.page);const r=a.toString();return yield F.get(`/users/activity-logs/list${r?"?"+r:""}`)}catch(a){return console.error("❌ Get activity logs error:",a),{data:[]}}}),unlockAccount:s=>P(void 0,null,function*(){return yield F.post(`/users/${s}/unlock`)}),getLockStatus:s=>P(void 0,null,function*(){return yield F.get(`/users/${s}/lock-status`)})},Gs=({user:s,onClose:l,onSuccess:a})=>{var w;const r=!!s,[f,g]=m.useState(!1),{register:x,handleSubmit:b,formState:{errors:i,isSubmitting:n},reset:C,watch:v}=Is({defaultValues:s||{username:"",email:"",full_name:"",phone:"",role:"customer_service",password:"",confirm_password:"",is_active:!0}}),N=v("role"),{data:c}=ge(["rolePermissions",N],()=>$s.getRolePermissions(N),{enabled:!!N&&N!=="admin"&&!r,staleTime:5*60*1e3});m.useEffect(()=>{s&&C(s)},[s,C]);const j=Se(p=>r?I.update(s.id,p):I.create(p),{onSuccess:()=>{o.success(r?"User berhasil diupdate":"User berhasil ditambahkan"),a()},onError:p=>{var y,L;o.error(((L=(y=p.response)==null?void 0:y.data)==null?void 0:L.message)||"Terjadi kesalahan")}}),h=p=>{if(!r&&p.password!==p.confirm_password){o.error("Password tidak cocok");return}const y=se(E({},p),{is_active:p.is_active==="true"||p.is_active===!0});delete y.confirm_password,r&&!y.password&&delete y.password,j.mutate(y)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-12 h-12 rounded-full ${r?"bg-gradient-to-br from-green-500 to-emerald-600":"bg-gradient-to-br from-blue-500 to-indigo-600"} flex items-center justify-center text-white shadow-lg`,children:r?e.jsx(Te,{className:"h-6 w-6"}):e.jsx(Me,{className:"h-6 w-6"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:r?"Edit User":"Tambah User Baru"}),e.jsx("p",{className:"text-sm text-gray-600",children:r?"Perbarui informasi user":"Lengkapi form untuk membuat user baru"})]})]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-white rounded-lg",children:e.jsx(le,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:b(h),className:"p-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-5 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(_e,{className:"h-5 w-5 mr-2 text-blue-600"}),"Informasi Dasar"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",E({type:"text",className:"input-field",placeholder:"username",disabled:r},x("username",{required:"Username wajib diisi",minLength:{value:3,message:"Username minimal 3 karakter"},pattern:{value:/^[a-zA-Z0-9_]+$/,message:"Username hanya boleh huruf, angka, dan underscore"}}))),i.username&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.username.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Nama Lengkap ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",E({type:"text",className:"input-field",placeholder:"Nama lengkap"},x("full_name",{required:"Nama lengkap wajib diisi"}))),i.full_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.full_name.message})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-5 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(pe,{className:"h-5 w-5 mr-2 text-blue-600"}),"Informasi Kontak"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",E({type:"email",className:"input-field",placeholder:"email@example.com"},x("email",{required:"Email wajib diisi",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Format email tidak valid"}}))),i.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),e.jsx("input",E({type:"text",className:"input-field",placeholder:"08123456789"},x("phone")))]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-5 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ne,{className:"h-5 w-5 mr-2 text-blue-600"}),"Role & Akses"]}),e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Role ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",se(E({className:"input-field"},x("role",{required:"Role wajib dipilih"})),{children:[e.jsx("option",{value:"",children:"Pilih Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"supervisor",children:"Supervisor"}),e.jsx("option",{value:"technician",children:"Technician"}),e.jsx("option",{value:"customer_service",children:"Customer Service"})]})),i.role&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.role.message}),!r&&N&&e.jsx("div",{className:"mt-4",children:N==="admin"?e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ne,{className:"h-5 w-5 text-purple-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-purple-900 mb-1",children:"Admin Access"}),e.jsxs("p",{className:"text-sm text-purple-800",children:["Admin memiliki ",e.jsx("strong",{children:"akses penuh"})," ke semua fitur sistem (100% permissions)."]})]})]})}):(w=c==null?void 0:c.data)!=null&&w.permissions?e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start flex-1",children:[e.jsx(Fe,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:[N==="supervisor"?"Supervisor":N==="technician"?"Technician":"Customer Service"," Permissions"]}),e.jsxs("p",{className:"text-sm text-blue-800 mb-2",children:["User akan mendapat ",e.jsxs("strong",{children:[c.data.permissions.length," permissions"]})]}),!f&&e.jsx("button",{type:"button",onClick:()=>g(!0),className:"text-xs text-blue-600 hover:text-blue-800 font-medium underline",children:"Lihat detail permissions →"})]})]})}),f&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[e.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-48 overflow-y-auto",children:c.data.permissions.map((p,y)=>e.jsxs("div",{className:"flex items-center text-sm text-blue-800",children:[e.jsx(ae,{className:"h-3 w-3 text-green-600 mr-2 flex-shrink-0"}),e.jsx("span",{children:p.description||p.name})]},y))}),e.jsx("button",{type:"button",onClick:()=>g(!1),className:"text-xs text-blue-600 hover:text-blue-800 font-medium underline mt-2",children:"← Sembunyikan detail"})]})]}):N&&e.jsx("div",{className:"bg-gray-100 border border-gray-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fe,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading permissions..."})]})})}),!r&&e.jsx("div",{className:"mt-3",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["💡 Untuk mengatur permissions lebih detail, kunjungi"," ",e.jsx("a",{href:"/permissions",target:"_blank",className:"text-blue-600 hover:text-blue-800 font-medium underline",children:"Permission Management"})]})})]}),!r&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-5 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ve,{className:"h-5 w-5 mr-2 text-blue-600"}),"Password"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",E({type:"password",className:"input-field",placeholder:"Password"},x("password",{required:r?!1:"Password wajib diisi",minLength:{value:6,message:"Password minimal 6 karakter"}}))),i.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.password.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Confirm Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",E({type:"password",className:"input-field",placeholder:"Confirm password"},x("confirm_password",{required:r?!1:"Konfirmasi password wajib diisi"}))),i.confirm_password&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:i.confirm_password.message})]})]})]}),r&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ve,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-1",children:"Catatan Password"}),e.jsx("p",{className:"text-sm text-blue-800",children:'Untuk mengubah password, gunakan fitur "Reset Password" di tabel user atau menu "Change Password" di halaman profil.'})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-5 border border-gray-200",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:["Status Akun ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("label",{className:"flex items-center cursor-pointer p-3 bg-white border-2 border-gray-300 rounded-lg hover:border-green-400 transition-all",children:[e.jsx("input",se(E({type:"radio",value:"true"},x("is_active")),{className:"mr-3 w-4 h-4 text-green-600"})),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Active"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer p-3 bg-white border-2 border-gray-300 rounded-lg hover:border-red-400 transition-all",children:[e.jsx("input",se(E({type:"radio",value:"false"},x("is_active")),{className:"mr-3 w-4 h-4 text-red-600"})),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-8 pt-6 border-t-2 border-gray-200 bg-gray-50 -mx-6 -mb-6 px-6 py-4 rounded-b-lg",children:[e.jsx("button",{type:"button",onClick:l,className:"btn-secondary",disabled:n,children:"Batal"}),e.jsx("button",{type:"submit",className:`btn-primary ${r?"bg-green-600 hover:bg-green-700":""}`,disabled:n,children:n?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Menyimpan..."]}):e.jsxs("span",{className:"flex items-center",children:[r?e.jsx(Te,{className:"h-4 w-4 mr-2"}):e.jsx(Me,{className:"h-4 w-4 mr-2"}),r?"Update User":"Tambah User"]})})]})]})]})})},Hs=({user:s,onClose:l,onSuccess:a})=>{const[r,f]=m.useState(""),[g,x]=m.useState(""),[b,i]=m.useState(!1),[n,C]=m.useState(!1),v=Se(()=>I.resetPassword(s.id,r),{onSuccess:h=>{x(h.data.temporary_password),o.success("Password berhasil direset!"),a()},onError:h=>{var w,p;o.error(((p=(w=h.response)==null?void 0:w.data)==null?void 0:p.message)||"Gagal reset password")}}),N=()=>{const w="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";let p="";for(let y=0;y<12;y++)p+=w.charAt(Math.floor(Math.random()*w.length));f(p),i(!0)},c=h=>{if(h.preventDefault(),!r||r.length<6){o.error("Password minimal 6 karakter");return}v.mutate()},j=()=>{navigator.clipboard.writeText(g),C(!0),o.success("Password copied to clipboard!"),setTimeout(()=>C(!1),2e3)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Pe,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Reset Password"})]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(le,{className:"h-6 w-6"})})]}),g?e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:e.jsx(be,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Password Berhasil Direset!"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Berikut adalah password sementara untuk user ",e.jsx("strong",{children:s.username})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"text",className:"form-input font-mono",value:g,readOnly:!0}),e.jsx("button",{onClick:j,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Copy to clipboard",children:n?e.jsx(be,{className:"h-5 w-5 text-green-600"}):e.jsx(ye,{className:"h-5 w-5"})})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["📝 ",e.jsx("strong",{children:"Important:"})," Pastikan Anda menyalin dan menyimpan password ini. Kirimkan ke user melalui channel yang aman (email, WhatsApp, dll)."]})}),e.jsx("button",{onClick:l,className:"w-full btn-primary",children:"Selesai"})]}):e.jsxs("form",{onSubmit:c,className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"User:"})," ",s.full_name," (",s.username,")"]}),e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Email:"})," ",s.email]})]}),e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["New Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:b?"text":"password",className:"form-input",placeholder:"Enter new password",value:r,onChange:h=>f(h.target.value),minLength:6,required:!0}),e.jsx("button",{type:"button",onClick:N,className:"w-full px-4 py-2 text-sm font-medium text-blue-600 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors",children:"Generate Random Password"}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:b,onChange:h=>i(h.target.checked),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Show password"})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["⚠️ ",e.jsx("strong",{children:"Warning:"})," User akan menggunakan password ini untuk login. Pastikan Anda menyimpan dan mengirimkan password ini ke user dengan aman."]})}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:l,className:"btn-secondary",disabled:v.isLoading,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:v.isLoading,children:v.isLoading?"Resetting...":"Reset Password"})]})]})]})})},Ks=({user:s,onClose:l,onSuccess:a})=>{var C;const[r,f]=m.useState(""),[g,x]=m.useState(!1),b=r===s.username,i=Se(()=>I.delete(s.id),{onSuccess:()=>{o.success(`User "${s.full_name}" berhasil dihapus`),a(),l()},onError:v=>{var N,c;o.error(((c=(N=v.response)==null?void 0:N.data)==null?void 0:c.message)||"Gagal menghapus user")}}),n=()=>{if(!b){o.error("Konfirmasi username tidak sesuai");return}i.mutate()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(Oe,{className:"h-6 w-6 text-red-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Confirm Deletion"}),e.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone"})]})]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:i.isLoading,children:e.jsx(le,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-medium text-blue-600",children:(C=s.full_name)==null?void 0:C.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.full_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["@",s.username]})]})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",s.email]}),e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Role:"})," ",s.role]}),s.phone&&e.jsxs("p",{className:"text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",s.phone]})]})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx(Oe,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Warning"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"User akan di-soft delete (data masih bisa di-restore)"}),e.jsx("li",{children:"User tidak bisa login setelah dihapus"}),e.jsx("li",{children:"Data terkait seperti tickets & logs akan tetap ada"})]})})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Type ",e.jsx("span",{className:"font-mono font-bold text-red-600",children:s.username})," to confirm:"]}),e.jsx("input",{type:"text",className:`form-input ${b?"border-green-500 focus:ring-green-500":"border-red-300 focus:ring-red-500"}`,placeholder:s.username,value:r,onChange:v=>f(v.target.value),autoFocus:!0,disabled:i.isLoading}),b&&e.jsxs("div",{className:"mt-2 flex items-center text-sm text-green-600",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Username confirmed"]})]}),e.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:v=>x(v.target.checked),className:"mr-2",disabled:i.isLoading}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Permanent Delete (Hard Delete)"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Data akan dihapus permanent dan tidak bisa di-restore. Hanya untuk kasus khusus!"})]})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 p-6 bg-gray-50 rounded-b-lg border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:l,className:"btn-secondary",disabled:i.isLoading,children:"Cancel"}),e.jsx("button",{onClick:n,className:`btn-danger ${b?"":"opacity-50 cursor-not-allowed"}`,disabled:!b||i.isLoading,children:i.isLoading?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),g?"Permanent Delete":"Delete User"]})})]})]})})},Js=({user:s,onClose:l})=>{var f;if(!s)return null;const a=g=>g?new Date(g).toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never",r=g=>{const x={admin:"bg-purple-100 text-purple-800 border-purple-200",supervisor:"bg-blue-100 text-blue-800 border-blue-200",technician:"bg-green-100 text-green-800 border-green-200",customer_service:"bg-yellow-100 text-yellow-800 border-yellow-200"},b={admin:"Admin",supervisor:"Supervisor",technician:"Technician",customer_service:"Customer Service"};return e.jsx("span",{className:`px-3 py-1 inline-flex text-sm font-semibold rounded-full border ${x[g]||"bg-gray-100 text-gray-800 border-gray-200"}`,children:b[g]||g})};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-start p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white text-2xl font-bold shadow-lg",children:(f=s.full_name)==null?void 0:f.charAt(0).toUpperCase()}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s.full_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["@",s.username]})]})]}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors p-2 hover:bg-white rounded-lg",children:e.jsx(le,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[r(s.role),s.is_active?e.jsxs("span",{className:"px-3 py-1 inline-flex items-center text-sm font-semibold rounded-full bg-green-100 text-green-800 border border-green-200",children:[e.jsx(ae,{className:"h-4 w-4 mr-1"}),"Active"]}):e.jsxs("span",{className:"px-3 py-1 inline-flex items-center text-sm font-semibold rounded-full bg-gray-100 text-gray-800 border border-gray-200",children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),"Inactive"]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(_e,{className:"h-5 w-5 mr-2 text-blue-600"}),"Contact Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg hover:border-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(pe,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Email"}),s.email_verified?e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800 border border-green-200",children:[e.jsx(We,{className:"h-3 w-3 mr-1"}),"Verified"]}):e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-yellow-100 text-yellow-800 border border-yellow-200",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"Not Verified"]})]}),e.jsx("p",{className:"text-sm text-gray-900 font-medium break-all mt-1",children:s.email}),s.email_verified_at&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Verified: ",a(s.email_verified_at)]})]})]})}),e.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg hover:border-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Es,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Phone"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.phone||"Not provided"})]})]})})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(Ne,{className:"h-5 w-5 mr-2 text-blue-600"}),"Account Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg hover:border-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ts,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Created At"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:a(s.created_at)})]})]})}),e.jsx("div",{className:"p-4 bg-white border border-gray-200 rounded-lg hover:border-blue-300 transition-colors",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ge,{className:"h-5 w-5 text-gray-400 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Last Login"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:a(s.last_login)})]})]})})]})]}),s.role==="technician"&&s.employee_id&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Technician Details"}),e.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Employee ID"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium",children:s.employee_id})]}),s.availability_status&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Availability"}),e.jsx("p",{className:"text-sm text-gray-900 font-medium capitalize",children:s.availability_status})]})]})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["User ID: ",e.jsx("span",{className:"font-mono font-medium text-gray-700",children:s.id})]})})]}),e.jsx("div",{className:"flex justify-end p-6 bg-gray-50 border-t border-gray-200",children:e.jsx("button",{onClick:l,className:"btn-secondary",children:"Close"})})]})})},Zs=({onClose:s,onSuccess:l})=>{const[a,r]=m.useState(null),[f,g]=m.useState([]),[x,b]=m.useState([]),[i,n]=m.useState(!1),C=c=>{const j=c.target.files[0];if(!j)return;const h=j.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(h)){o.error("Format file harus CSV atau Excel");return}r(j);const w=new FileReader;w.onload=p=>{try{const y=new Uint8Array(p.target.result),L=Ls(y,{type:"array"}),Q=L.SheetNames[0],re=L.Sheets[Q],W=B.sheet_to_json(re);if(W.length===0){o.error("File kosong atau format tidak valid");return}const k=W.map((u,ne)=>{var ce,G,H,K,de,J,z;const M=[];return(!u.Username||u.Username.length<3)&&M.push("Username invalid (min 3 chars)"),(!u.Email||!u.Email.includes("@"))&&M.push("Email invalid"),u["Full Name"]||M.push("Full Name required"),(!u.Role||!["admin","supervisor","technician","customer_service"].includes(u.Role.toLowerCase()))&&M.push("Role invalid"),(!u.Password||u.Password.length<6)&&M.push("Password invalid (min 6 chars)"),{rowNumber:ne+2,data:{username:(ce=u.Username)==null?void 0:ce.trim(),email:(G=u.Email)==null?void 0:G.trim(),full_name:(H=u["Full Name"])==null?void 0:H.trim(),phone:((K=u.Phone)==null?void 0:K.trim())||"",role:(de=u.Role)==null?void 0:de.toLowerCase().trim(),password:(J=u.Password)==null?void 0:J.trim(),is_active:((z=u.Status)==null?void 0:z.toLowerCase())!=="inactive"},errors:M,isValid:M.length===0}});g(k),b(k);const T=k.filter(u=>u.isValid).length,ie=k.filter(u=>!u.isValid).length;ie>0?o.warning(`${T} valid, ${ie} invalid rows`):o.success(`${T} users ready to import`)}catch(y){o.error("Gagal membaca file: "+y.message)}},w.readAsArrayBuffer(j)},v=()=>{const c=[{Username:"johndoe","Full Name":"John Doe",Email:"john.doe@example.com",Phone:"081234567890",Role:"technician",Password:"password123",Status:"active"},{Username:"janedoe","Full Name":"Jane Doe",Email:"jane.doe@example.com",Phone:"081234567891",Role:"customer_service",Password:"password456",Status:"active"}],j=B.json_to_sheet(c),h=B.book_new();B.book_append_sheet(h,j,"Users Template"),j["!cols"]=[{wch:15},{wch:20},{wch:25},{wch:15},{wch:20},{wch:15},{wch:10}],qe(h,"import-users-template.xlsx"),o.success("Template downloaded!")},N=()=>P(void 0,null,function*(){var p,y;const c=f.filter(L=>L.isValid);if(c.length===0){o.error("Tidak ada user valid untuk diimport");return}if(!window.confirm(`Import ${c.length} users?`))return;n(!0);let j=0,h=0;const w=[];for(const L of c)try{yield I.create(L.data),j++}catch(Q){h++,w.push(`Row ${L.rowNumber}: ${((y=(p=Q.response)==null?void 0:p.data)==null?void 0:y.message)||"Failed"}`)}n(!1),j>0&&(o.success(`${j} users berhasil diimport!`),l(),h===0&&s()),h>0&&(o.error(`${h} users gagal diimport`),console.error("Import errors:",w))});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(we,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Import Users"})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:i,children:e.jsx(le,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"📋 Instructions:"}),e.jsxs("ol",{className:"list-decimal list-inside text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"Download template Excel/CSV"}),e.jsx("li",{children:"Fill in user data (Username, Full Name, Email, Phone, Role, Password, Status)"}),e.jsx("li",{children:"Upload file (Excel or CSV format)"}),e.jsx("li",{children:"Review validation results"}),e.jsx("li",{children:'Click "Import" to create users'})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:"Download Template"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Get the Excel template with example data"})]}),e.jsxs("button",{onClick:v,className:"btn-outline flex items-center",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Download Template"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload File (CSV or Excel)"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-blue-400 transition-colors",children:e.jsxs("div",{className:"space-y-1 text-center",children:[e.jsx(Ce,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"flex text-sm text-gray-600",children:[e.jsxs("label",{className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{type:"file",className:"sr-only",accept:".csv,.xlsx,.xls",onChange:C,disabled:i})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"CSV or XLSX up to 10MB"}),a&&e.jsxs("p",{className:"text-sm text-green-600 font-medium mt-2",children:["✓ ",a.name]})]})})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Validation Results:"}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Row"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Username"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Email"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Role"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map((c,j)=>e.jsxs("tr",{className:c.isValid?"bg-green-50":"bg-red-50",children:[e.jsx("td",{className:"px-4 py-2 text-sm",children:c.rowNumber}),e.jsx("td",{className:"px-4 py-2 text-sm",children:c.data.username}),e.jsx("td",{className:"px-4 py-2 text-sm",children:c.data.email}),e.jsx("td",{className:"px-4 py-2 text-sm",children:c.data.role}),e.jsx("td",{className:"px-4 py-2 text-sm",children:c.isValid?e.jsxs("span",{className:"inline-flex items-center text-xs text-green-700",children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Valid"]}):e.jsxs("span",{className:"inline-flex items-center text-xs text-red-700",title:c.errors.join(", "),children:[e.jsx(ve,{className:"h-3 w-3 mr-1"}),c.errors[0]]})})]},j))})]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-5 w-5 text-green-600 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Valid Rows"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:x.filter(c=>c.isValid).length})]})]})}),e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-600 font-medium",children:"Invalid Rows"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:x.filter(c=>!c.isValid).length})]})]})})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ms,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-2"}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("p",{className:"font-semibold mb-2",children:"Required Columns:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Username"})," - Minimal 3 karakter, unique"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Full Name"})," - Nama lengkap user"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email"})," - Format email valid, unique"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Phone"})," - Nomor telepon (optional)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Role"})," - admin, supervisor, technician, atau customer_service"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Password"})," - Minimal 6 karakter"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Status"})," - active atau inactive (default: active)"]})]})]})]})})]}),e.jsxs("div",{className:"flex justify-between p-6 bg-gray-50 border-t border-gray-200",children:[e.jsxs("button",{onClick:v,className:"btn-outline flex items-center",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Download Template"]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:i,children:"Cancel"}),e.jsx("button",{onClick:N,className:"btn-primary",disabled:i||x.filter(c=>c.isValid).length===0,children:i?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Importing..."]}):e.jsxs("span",{className:"flex items-center",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Import ",x.filter(c=>c.isValid).length," Users"]})})]})]})]})})},Xs=({targetUserId:s=null,limit:l=20})=>{const{data:a,isLoading:r}=ge(["activity-logs",s],()=>I.getActivityLogs({target_user_id:s,limit:l}),{refetchInterval:3e4,refetchOnWindowFocus:!1}),f=Array.isArray(a==null?void 0:a.data)?a.data:[],g=n=>{switch(n){case"created":return e.jsx(_e,{className:"h-4 w-4 text-green-600"});case"updated":return e.jsx(He,{className:"h-4 w-4 text-blue-600"});case"deleted":case"deleted_permanent":return e.jsx(Ae,{className:"h-4 w-4 text-red-600"});case"restored":return e.jsx(Fs,{className:"h-4 w-4 text-green-600"});case"password_reset":return e.jsx(Pe,{className:"h-4 w-4 text-orange-600"});default:return e.jsx(fe,{className:"h-4 w-4 text-gray-600"})}},x=n=>{switch(n){case"created":case"restored":return"bg-green-50 border-green-200 text-green-800";case"updated":return"bg-blue-50 border-blue-200 text-blue-800";case"deleted":case"deleted_permanent":return"bg-red-50 border-red-200 text-red-800";case"password_reset":return"bg-orange-50 border-orange-200 text-orange-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},b=n=>({created:"Created User",updated:"Updated User",deleted:"Deleted User",deleted_permanent:"Permanently Deleted",restored:"Restored User",password_reset:"Reset Password"})[n]||n,i=n=>{const C=new Date(n),N=new Date-C,c=Math.floor(N/1e3),j=Math.floor(c/60),h=Math.floor(j/60),w=Math.floor(h/24);return c<60?"Just now":j<60?`${j}m ago`:h<24?`${h}h ago`:w<7?`${w}d ago`:C.toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})};return r?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(Qe,{size:"sm"})}):e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[e.jsx(fe,{className:"h-5 w-5 mr-2 text-blue-600"}),"Recent Activity"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[f.length," activities"]})]})}),e.jsx("div",{className:"divide-y divide-gray-200 max-h-96 overflow-y-auto",children:f.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(fe,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No activity logs yet"})]}):f.map(n=>e.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:g(n.action)}),e.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:b(n.action)}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded border ${x(n.action)}`,children:n.action})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:n.performer_name||"System"})," → ",e.jsxs("span",{className:"font-medium",children:["@",n.target_username]})]}),n.details&&Object.keys(n.details).length>0&&e.jsx("div",{className:"mt-2 text-xs text-gray-500 bg-gray-50 rounded p-2",children:Object.entries(n.details).map(([C,v])=>e.jsxs("span",{className:"mr-3",children:[e.jsxs("strong",{children:[C,":"]})," ",JSON.stringify(v)]},C))}),e.jsxs("div",{className:"flex items-center mt-2 text-xs text-gray-500",children:[e.jsx(Ge,{className:"h-3 w-3 mr-1"}),i(n.created_at)]})]})]})},n.id))})]})},dt=()=>{const{user:s,isAdmin:l,isSupervisor:a}=Rs(),[r,f]=m.useState(""),[g,x]=m.useState("all"),[b,i]=m.useState("all"),[n,C]=m.useState("all"),[v,N]=m.useState(!1),[c,j]=m.useState(null),[h,w]=m.useState(!1),[p,y]=m.useState(null),[L,Q]=m.useState(!1),[re,W]=m.useState(null),[k,T]=m.useState([]),[ie,u]=m.useState(!1),[ne,M]=m.useState(null),[ce,G]=m.useState(!1),[H,K]=m.useState(null),[de,J]=m.useState(!1),[z,Ke]=m.useState("created_at"),[oe,Ue]=m.useState("desc"),[S,V]=m.useState(1),[Z,Je]=m.useState(10),A=Ds(),{data:q,isLoading:Ze}=ge(["users-list",g,b,n,r,z,oe,S,Z],()=>I.getAll({role:g!=="all"?g:void 0,status:b!=="all"?b:void 0,search:r||void 0,page:S,limit:Z,sort_by:z,sort_order:oe}),{refetchOnWindowFocus:!1,keepPreviousData:!0}),De=Array.isArray(q==null?void 0:q.data)?q.data:[],$=(q==null?void 0:q.pagination)||{},X=De.filter(t=>{if(n==="all")return!0;const d=t.last_login?new Date(t.last_login):null,U=d?Math.floor((new Date-d)/(1e3*60*60*24)):null;switch(n){case"today":return U===0;case"week":return U!==null&&U<=7;case"month":return U!==null&&U<=30;case"never":return d===null;default:return!0}}),{data:me}=ge("all-users-stats",()=>I.getAll({page:1,limit:1e3}),{refetchOnWindowFocus:!1}),xe=Array.isArray(me==null?void 0:me.data)?me.data:[],Xe=xe.length,Ye=xe.filter(t=>t.is_active).length,es=xe.filter(t=>t.role==="admin").length,ss=xe.filter(t=>t.role==="technician").length,Le=()=>{j(null),N(!0)},ts=t=>{j(t),N(!0)},as=t=>{y(t),w(!0)},ls=()=>{w(!1),y(null)},rs=()=>{A.invalidateQueries(["users-list"])},is=t=>{W(t),Q(!0)},ns=()=>{Q(!1),W(null)},cs=()=>{A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats")},ds=t=>P(void 0,null,function*(){var d,_;if(window.confirm(`Unlock account for ${t.full_name}? This will reset all failed login attempts.`))try{yield I.unlockAccount(t.id),o.success(`Account unlocked for ${t.full_name}`),A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats")}catch(U){o.error(((_=(d=U.response)==null?void 0:d.data)==null?void 0:_.message)||"Failed to unlock account")}}),os=t=>{if(t.target.checked){const d=X.filter(_=>_.id!==(s==null?void 0:s.id)).map(_=>_.id);T(d),u(!0)}else T([]),u(!1)},ms=t=>{T(d=>{if(d.includes(t)){const _=d.filter(U=>U!==t);return u(!1),_}else return[...d,t]})},xs=()=>P(void 0,null,function*(){if(k.length===0){o.error("Pilih minimal 1 user untuk dihapus");return}if(window.confirm(`Hapus ${k.length} users yang dipilih?`))try{yield Promise.all(k.map(t=>I.delete(t))),o.success(`${k.length} users berhasil dihapus`),T([]),u(!1),A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats")}catch(t){o.error("Gagal menghapus beberapa users")}}),hs=()=>P(void 0,null,function*(){if(k.length===0){o.error("Pilih minimal 1 user untuk dinonaktifkan");return}if(window.confirm(`Nonaktifkan ${k.length} users yang dipilih?`))try{yield Promise.all(k.map(t=>I.update(t,{is_active:!1}))),o.success(`${k.length} users berhasil dinonaktifkan`),T([]),u(!1),A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats")}catch(t){o.error("Gagal menonaktifkan beberapa users")}}),us=()=>P(void 0,null,function*(){if(k.length===0){o.error("Pilih minimal 1 user untuk diaktifkan");return}try{yield Promise.all(k.map(t=>I.update(t,{is_active:!0}))),o.success(`${k.length} users berhasil diaktifkan`),T([]),u(!1),A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats")}catch(t){o.error("Gagal mengaktifkan beberapa users")}}),Re=(t,d)=>{navigator.clipboard.writeText(t),M(d),o.success("Copied to clipboard!"),setTimeout(()=>M(null),2e3)},gs=t=>{K(t),G(!0)},ps=()=>{G(!1),K(null)},bs=()=>{J(!0)},js=()=>{J(!1)},fs=()=>{A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats")},Ns=()=>{const t=X.map(D=>({Username:D.username,"Full Name":D.full_name,Email:D.email,Phone:D.phone||"-",Role:D.role,Status:D.is_active?"Active":"Inactive","Last Login":D.last_login?new Date(D.last_login).toLocaleString("id-ID"):"Never","Created At":new Date(D.created_at).toLocaleString("id-ID")})),d=B.json_to_sheet(t),_=B.book_new();B.book_append_sheet(_,d,"Users");const U=t.reduce((D,he)=>{var R;return Math.max(D,((R=he["Full Name"])==null?void 0:R.length)||0)},10);d["!cols"]=[{wch:15},{wch:U},{wch:25},{wch:15},{wch:15},{wch:10},{wch:20},{wch:20}];const O=`users-export-${new Date().toISOString().split("T")[0]}.xlsx`;qe(_,O),o.success(`Exported ${t.length} users to ${O}`)},ys=()=>{const t=X.map(R=>({Username:R.username,"Full Name":R.full_name,Email:R.email,Phone:R.phone||"-",Role:R.role,Status:R.is_active?"Active":"Inactive","Last Login":R.last_login?new Date(R.last_login).toLocaleString("id-ID"):"Never","Created At":new Date(R.created_at).toLocaleString("id-ID")})),d=B.json_to_sheet(t),_=B.sheet_to_csv(d),U=new Blob([_],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a"),D=URL.createObjectURL(U),he=`users-export-${new Date().toISOString().split("T")[0]}.csv`;O.setAttribute("href",D),O.setAttribute("download",he),O.style.visibility="hidden",document.body.appendChild(O),O.click(),document.body.removeChild(O),o.success(`Exported ${t.length} users to ${he}`)},Ie=()=>{N(!1),j(null)},vs=()=>{A.invalidateQueries(["users-list"]),A.invalidateQueries("all-users-stats"),Ie()},Y=t=>{z===t?Ue(oe==="asc"?"desc":"asc"):(Ke(t),Ue("asc")),V(1)},ee=t=>z!==t?e.jsx(qs,{className:"h-4 w-4 text-gray-400"}):oe==="asc"?e.jsx(Qs,{className:"h-4 w-4"}):e.jsx(Ws,{className:"h-4 w-4"}),ws=t=>{f(t.target.value),V(1)},je=(t,d)=>{t==="role"?x(d):t==="status"?i(d):t==="lastLogin"&&C(d),V(1)},ks=t=>{Je(parseInt(t)),V(1)},Cs=t=>{const d={admin:"bg-purple-100 text-purple-800",supervisor:"bg-blue-100 text-blue-800",technician:"bg-green-100 text-green-800",customer_service:"bg-yellow-100 text-yellow-800"},_={admin:"Admin",supervisor:"Supervisor",technician:"Technician",customer_service:"Customer Service"};return e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${d[t]||"bg-gray-100 text-gray-800"}`,children:_[t]||t})};return!l&&!a?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-96",children:[e.jsx(Vs,{className:"h-24 w-24 text-red-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access User Management."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Required role: Admin or Supervisor"})]}):Ze&&S===1?e.jsx("div",{className:"flex justify-center items-center min-h-96",children:e.jsx(Qe,{})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),e.jsx("p",{className:"text-gray-600",children:"Kelola pengguna sistem dan akses"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[l&&e.jsxs("button",{onClick:bs,className:"btn-outline flex items-center",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Import"]}),e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"btn-outline flex items-center",children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:[e.jsxs("button",{onClick:Ns,className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center transition-colors rounded-t-lg",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2 text-green-600"}),"Export to Excel"]}),e.jsxs("button",{onClick:ys,className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center transition-colors rounded-b-lg",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2 text-blue-600"}),"Export to CSV"]})]})]}),k.length>0&&l&&e.jsxs("div",{className:"flex items-center space-x-2 mr-4 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[k.length," selected"]}),e.jsx("button",{onClick:us,className:"text-xs px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors",title:"Activate selected users",children:"Activate"}),e.jsx("button",{onClick:hs,className:"text-xs px-3 py-1 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors",title:"Deactivate selected users",children:"Deactivate"}),e.jsx("button",{onClick:xs,className:"text-xs px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",title:"Delete selected users",children:"Delete"}),e.jsx("button",{onClick:()=>{T([]),u(!1)},className:"text-xs px-2 py-1 text-gray-600 hover:text-gray-800",title:"Clear selection",children:"✕"})]}),e.jsxs("button",{onClick:Le,className:"btn-primary",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Tambah User"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(ue,{icon:te,title:"Total Users",value:Xe,color:"blue"}),e.jsx(ue,{icon:te,title:"Active Users",value:Ye,color:"green"}),e.jsx(ue,{icon:te,title:"Admins",value:es,color:"purple"}),e.jsx(ue,{icon:te,title:"Technicians",value:ss,color:"orange"})]}),e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"h-4 w-4 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",className:"form-input pl-10",placeholder:"Cari user...",value:r,onChange:ws})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsxs("select",{className:"form-input",value:g,onChange:t=>je("role",t.target.value),children:[e.jsx("option",{value:"all",children:"Semua Role"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"supervisor",children:"Supervisor"}),e.jsx("option",{value:"technician",children:"Technician"}),e.jsx("option",{value:"customer_service",children:"Customer Service"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{className:"form-input",value:b,onChange:t=>je("status",t.target.value),children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Login"}),e.jsxs("select",{className:"form-input",value:n,onChange:t=>je("lastLogin",t.target.value),children:[e.jsx("option",{value:"all",children:"Semua Waktu"}),e.jsx("option",{value:"today",children:"Hari Ini"}),e.jsx("option",{value:"week",children:"7 Hari Terakhir"}),e.jsx("option",{value:"month",children:"30 Hari Terakhir"}),e.jsx("option",{value:"never",children:"Belum Pernah"})]})]})]})}),De.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(te,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada user"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Mulai dengan menambahkan user pertama"}),e.jsxs("button",{onClick:Le,className:"btn-primary",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Tambah User"]})]}):X.length===0?e.jsxs("div",{className:"bg-white shadow rounded-lg p-12 text-center",children:[e.jsx(ze,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Tidak ada hasil"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Coba ubah filter atau search keyword"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Users",e.jsxs("span",{className:"text-sm font-normal text-gray-500 ml-2",children:["(",$.total||0," total)"]})]})}),e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table w-full",style:{tableLayout:"fixed",minWidth:"950px"},children:[e.jsx("thead",{className:"table-header",children:e.jsxs("tr",{children:[l&&e.jsx("th",{className:"table-header-cell",style:{width:"50px"},children:e.jsx("input",{type:"checkbox",checked:ie,onChange:os,className:"cursor-pointer"})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Y("full_name"),style:{width:"200px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"User"}),ee("full_name")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Y("email"),style:{width:"180px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Email"}),ee("email")]})}),e.jsx("th",{className:"table-header-cell",style:{width:"120px"},children:"Phone"}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Y("role"),style:{width:"130px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Role"}),ee("role")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Y("last_login"),style:{width:"100px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Last Login"}),ee("last_login")]})}),e.jsx("th",{className:"table-header-cell cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Y("is_active"),style:{width:"90px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Status"}),ee("is_active")]})}),e.jsx("th",{className:"table-header-cell text-center",style:{width:"100px"},children:"Actions"})]})}),e.jsx("tbody",{className:"table-body",children:X.map(t=>{var d;return e.jsxs("tr",{className:k.includes(t.id)?"bg-blue-50":"",children:[l&&e.jsx("td",{className:"table-cell",children:t.id!==(s==null?void 0:s.id)?e.jsx("input",{type:"checkbox",checked:k.includes(t.id),onChange:()=>ms(t.id),className:"cursor-pointer"}):e.jsx("span",{className:"text-gray-300",children:"-"})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:(d=t.full_name)==null?void 0:d.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("button",{onClick:()=>gs(t),className:"text-sm font-medium text-blue-600 hover:text-blue-800 truncate cursor-pointer text-left",style:{maxWidth:"130px"},title:"Click to view details",children:t.full_name}),e.jsxs("div",{className:"text-xs text-gray-500 truncate",style:{maxWidth:"130px"},children:["@",t.username]})]})]})}),e.jsx("td",{className:"table-cell",children:e.jsxs("div",{className:"flex items-center group",children:[e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm text-gray-900 truncate",title:t.email,children:t.email}),t.email_verified?e.jsx(We,{className:"h-4 w-4 text-green-600 ml-1 flex-shrink-0",title:"Email verified"}):e.jsx(pe,{className:"h-4 w-4 text-gray-400 ml-1 flex-shrink-0",title:"Email not verified"})]}),e.jsx("button",{onClick:()=>Re(t.email,`email-${t.id}`),className:"ml-2 opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-all flex-shrink-0",title:"Copy email",children:ne===`email-${t.id}`?e.jsx(be,{className:"h-3 w-3 text-green-600"}):e.jsx(ye,{className:"h-3 w-3 text-gray-400"})})]})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:t.phone?e.jsxs("div",{className:"flex items-center group",children:[e.jsx("div",{className:"text-sm text-gray-900 flex-1",children:t.phone}),e.jsx("button",{onClick:()=>Re(t.phone,`phone-${t.id}`),className:"ml-2 opacity-0 group-hover:opacity-100 p-1 hover:bg-gray-100 rounded transition-all",title:"Copy phone",children:ne===`phone-${t.id}`?e.jsx(be,{className:"h-3 w-3 text-green-600"}):e.jsx(ye,{className:"h-3 w-3 text-gray-400"})})]}):e.jsx("div",{className:"text-sm text-gray-400",children:"-"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:Cs(t.role)}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500",children:t.last_login?new Date(t.last_login).toLocaleDateString("id-ID",{day:"2-digit",month:"short"}):"Never"})}),e.jsx("td",{className:"table-cell whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"table-cell text-center",children:e.jsxs("div",{className:"flex justify-center space-x-1",children:[(l||a)&&e.jsx("button",{onClick:()=>ts(t),className:"inline-flex items-center justify-center w-8 h-8 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-md transition-colors",title:"Edit User",children:e.jsx(He,{className:"h-4 w-4"})}),l&&t.id!==(s==null?void 0:s.id)&&e.jsx("button",{onClick:()=>as(t),className:"inline-flex items-center justify-center w-8 h-8 text-orange-600 hover:text-orange-800 hover:bg-orange-50 rounded-md transition-colors",title:"Reset Password",children:e.jsx(Pe,{className:"h-4 w-4"})}),l&&t.id!==(s==null?void 0:s.id)&&(t.failed_login_attempts>0||t.locked_until)&&e.jsx("button",{onClick:()=>ds(t),className:"inline-flex items-center justify-center w-8 h-8 text-green-600 hover:text-green-800 hover:bg-green-50 rounded-md transition-colors",title:`Unlock Account (${t.failed_login_attempts||0} failed attempts)`,children:e.jsx(Os,{className:"h-4 w-4"})}),l&&t.id!==(s==null?void 0:s.id)&&e.jsx("button",{onClick:()=>is(t),className:"inline-flex items-center justify-center w-8 h-8 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors",title:"Delete User",children:e.jsx(Ae,{className:"h-4 w-4"})}),t.id===(s==null?void 0:s.id)&&e.jsx("span",{className:"text-xs text-gray-400 px-2",title:"Cannot modify yourself",children:"-"})]})})]},t.id)})})]})})})]}),e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>V(Math.max(1,S-1)),disabled:S===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>V(Math.min($.pages||1,S+1)),disabled:S===($.pages||1),className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show"}),e.jsxs("select",{value:Z,onChange:t=>ks(t.target.value),className:"form-input py-1 px-2 text-sm border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"rows"})]}),e.jsx("div",{className:"border-l border-gray-300 h-6"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(S-1)*Z+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(S*Z,$.total||0)})," ","of ",e.jsx("span",{className:"font-medium",children:$.total||0})," results"]})]}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{onClick:()=>V(Math.max(1,S-1)),disabled:S===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Bs,{className:"h-5 w-5"})}),Array.from({length:Math.min($.pages||1,10)},(t,d)=>$.pages<=10||S<=5?d+1:S>=$.pages-4?$.pages-9+d:S-5+d).map(t=>e.jsx("button",{onClick:()=>V(t),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${S===t?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:t},t)),e.jsx("button",{onClick:()=>V(Math.min($.pages||1,S+1)),disabled:S===($.pages||1),className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(zs,{className:"h-5 w-5"})})]})})]})]})})]}),v&&e.jsx(Gs,{user:c,onClose:Ie,onSuccess:vs}),h&&p&&e.jsx(Hs,{user:p,onClose:ls,onSuccess:rs}),L&&re&&e.jsx(Ks,{user:re,onClose:ns,onSuccess:cs}),ce&&H&&e.jsx(Js,{user:H,onClose:ps}),de&&e.jsx(Zs,{onClose:js,onSuccess:fs}),(l||a)&&e.jsx(Xs,{limit:15})]})};export{dt as default};
//# sourceMappingURL=UsersPage-BOFM26n_.js.map
