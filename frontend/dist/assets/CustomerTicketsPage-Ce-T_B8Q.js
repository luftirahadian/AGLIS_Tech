var P=Object.defineProperty,_=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var w=(l,t,a)=>t in l?P(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,u=(l,t)=>{for(var a in t||(t={}))$.call(t,a)&&w(l,a,t[a]);if(v)for(var a of v(t))L.call(t,a)&&w(l,a,t[a]);return l},x=(l,t)=>_(l,D(t));var b=(l,t,a)=>new Promise((c,d)=>{var p=r=>{try{n(a.next(r))}catch(m){d(m)}},i=r=>{try{n(a.throw(r))}catch(m){d(m)}},n=r=>r.done?c(r.value):Promise.resolve(r.value).then(p,i);n((a=a.apply(l,t)).next())});import{j as e,a as k}from"./notifications-Dggueh-l.js";import{u as M,r as j}from"./react-vendor-BQ7pSkNi.js";import{a as I,b as z,u as q}from"./react-query-B7OIdD7u.js";import{af as y,P as U,g as E,U as C,X as F,C as J,a as Q,N as R,z as T}from"./ui-vendor-CO1ReX4_.js";import{C as G}from"./CustomerPortalLayout-0dW5kJg3.js";import"./charts-CREYXqqm.js";const Z=()=>{var N;const l=M(),t=I(),[a,c]=j.useState(!1),[d,p]=j.useState("all"),[i,n]=j.useState({type:"repair",title:"",description:"",priority:"normal"}),{data:r,isLoading:m}=z(["customer-tickets",d],()=>b(void 0,null,function*(){const s=localStorage.getItem("customerToken"),o=d!=="all"?`?status=${d}`:"";return(yield k.get(`/customer-portal/tickets${o}`,{headers:{Authorization:`Bearer ${s}`}})).data})),g=q(s=>b(void 0,null,function*(){const o=localStorage.getItem("customerToken");return k.post("/customer-portal/tickets",s,{headers:{Authorization:`Bearer ${o}`}})}),{onSuccess:()=>{T.success("Tiket berhasil dibuat! Tim kami akan segera memproses."),c(!1),n({type:"repair",title:"",description:"",priority:"normal"}),t.invalidateQueries("customer-tickets")},onError:s=>{var o,h;T.error(((h=(o=s.response)==null?void 0:o.data)==null?void 0:h.message)||"Gagal membuat tiket")}}),f=((N=r==null?void 0:r.data)==null?void 0:N.tickets)||(r==null?void 0:r.tickets)||[],S=s=>({open:"bg-blue-100 text-blue-700",assigned:"bg-purple-100 text-purple-700",in_progress:"bg-yellow-100 text-yellow-700",completed:"bg-green-100 text-green-700",cancelled:"bg-red-100 text-red-700",on_hold:"bg-gray-100 text-gray-700"})[s]||"bg-gray-100 text-gray-700",B=s=>({open:e.jsx(R,{className:"h-4 w-4"}),assigned:e.jsx(C,{className:"h-4 w-4"}),in_progress:e.jsx(Q,{className:"h-4 w-4"}),completed:e.jsx(J,{className:"h-4 w-4"})})[s]||e.jsx(y,{className:"h-4 w-4"}),A=s=>{s.preventDefault(),g.mutate(i)};return e.jsx(G,{children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center",children:[e.jsx(y,{className:"h-7 w-7 mr-2 text-blue-600"}),"Tiket Saya"]}),e.jsx("p",{className:"text-gray-600",children:"Kelola tiket support Anda"})]}),e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(U,{className:"h-5 w-5"}),e.jsx("span",{children:"Buat Tiket Baru"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","open","in_progress","completed"].map(s=>e.jsx("button",{onClick:()=>p(s),className:`px-4 py-2 rounded-lg transition-colors ${d===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:s==="all"?"Semua":s==="in_progress"?"In Progress":s.charAt(0).toUpperCase()+s.slice(1)},s))})}),m?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent"})}):f.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(y,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Belum ada tiket"}),e.jsx("button",{onClick:()=>c(!0),className:"text-blue-600 hover:text-blue-700 font-medium",children:"Buat tiket pertama Anda â†’"})]}):e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsx("div",{onClick:()=>l(`/customer/tickets/${s.id}`),className:"bg-white rounded-lg shadow-sm p-6 hover:shadow-md cursor-pointer transition-all",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsxs("span",{className:"font-semibold text-gray-900",children:["#",s.ticket_number]}),e.jsxs("span",{className:`px-3 py-1 text-sm rounded-full flex items-center space-x-1 ${S(s.status)}`,children:[B(s.status),e.jsx("span",{children:s.status})]}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.priority==="high"?"bg-red-100 text-red-700":s.priority==="normal"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.priority})]}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(E,{className:"h-4 w-4 mr-1"}),new Date(s.created_at).toLocaleDateString("id-ID")]}),s.technician_name&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(C,{className:"h-4 w-4 mr-1"}),"Teknisi: ",s.technician_name]})]})]})})},s.id))}),a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Buat Tiket Baru"}),e.jsx("button",{onClick:()=>c(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(F,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Jenis Tiket"}),e.jsxs("select",{value:i.type,onChange:s=>n(x(u({},i),{type:s.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"repair",children:"Perbaikan (Repair)"}),e.jsx("option",{value:"upgrade",children:"Upgrade Paket"}),e.jsx("option",{value:"dismantle",children:"Pemutusan Layanan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Judul Masalah"}),e.jsx("input",{type:"text",value:i.title,onChange:s=>n(x(u({},i),{title:s.target.value})),placeholder:"Contoh: Internet lambat atau putus-putus",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Deskripsi Detail"}),e.jsx("textarea",{value:i.description,onChange:s=>n(x(u({},i),{description:s.target.value})),placeholder:"Jelaskan masalah Anda secara detail...",rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prioritas"}),e.jsxs("select",{value:i.priority,onChange:s=>n(x(u({},i),{priority:s.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"low",children:"Low (Tidak mendesak)"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High (Mendesak)"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Catatan:"})," Tiket Anda akan segera diproses oleh tim kami. Anda akan menerima notifikasi WhatsApp untuk setiap update."]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Batal"}),e.jsx("button",{type:"submit",disabled:g.isLoading,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g.isLoading?"Membuat...":"Buat Tiket"})]})]})]})})})]})})};export{Z as default};
//# sourceMappingURL=CustomerTicketsPage-Ce-T_B8Q.js.map
